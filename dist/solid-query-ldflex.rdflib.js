var solid="object"==typeof solid?solid:{};solid.data=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=31)}([function(e,t,r){var n=r(15);e.exports=n},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(11)),n(r(7))},function(e){e.exports=JSON.parse('{"@context":{"acl":"http://www.w3.org/ns/auth/acl#","app":"http://www.w3.org/ns/solid/app#","as":"https://www.w3.org/ns/activitystreams#","cert":"http://www.w3.org/ns/auth/cert#","dc":"http://purl.org/dc/elements/1.1/","dct":"http://purl.org/dc/terms/","foaf":"http://xmlns.com/foaf/0.1/","ldp":"http://www.w3.org/ns/ldp#","owl":"http://www.w3.org/2002/07/owl#","pim":"http://www.w3.org/ns/pim/space#","rdf":"http://www.w3.org/1999/02/22-rdf-syntax-ns#","rdfs":"http://www.w3.org/2000/01/rdf-schema#","schema":"http://schema.org/","sioc":"http://rdfs.org/sioc/ns#","solid":"http://www.w3.org/ns/solid/terms#","stat":"http://www.w3.org/ns/posix/stat#","ui":"http://www.w3.org/ns/ui#","vcard":"http://www.w3.org/2006/vcard/ns#","xsd":"http://www.w3.org/2001/XMLSchema#","accessControl":"acl:accessControl","accessTo":"acl:accessTo","accessToClass":"acl:accessToClass","agent":"acl:agent","agents":"acl:agent","agentClass":"acl:agentClass","agentClasses":"acl:agentClass","agentGroup":"acl:agentGroup","agentGroups":"acl:agentGroup","defaultAcl":"acl:default","defaultAclForNew":"acl:defaultForNew","delegates":"acl:delegates","mode":"acl:mode","modes":"acl:mode","origin":"acl:origin","origins":"acl:origin","actor":"as:actor","attachment":"as:attachment","attributedTo":"as:attributedTo","author":"as:author","bcc":"as:bcc","bto":"as:bto","cc":"as:cc","inReplyTo":"as:inReplyTo","object":"as:object","publicationDate":"as:published","subject":"as:subject","summary":"as:summary","target":"as:target","to":"as:to","abstract":"dc:abstract","abstracts":"dc:abstract","created":"dc:created","license":"dc:license","modified":"dc:modified","title":"dc:title","titles":"dc:title","account":"foaf:account","accounts":"foaf:account","age":"foaf:age","basedNear":"foaf:based_near","birthday":"foaf:birthday","blog":"foaf:weblog","depiction":"foaf:depiction","depicts":"foaf:depicts","email":"foaf:mbox","familyName":"foaf:familyName","firstName":"foaf:givenName","friend":"foaf:knows","friends":"foaf:knows","gender":"foaf:gender","givenName":"foaf:givenName","homepage":"foaf:homepage","image":"foaf:img","images":"foaf:img","interest":"foaf:topic_interest","interests":"foaf:topic_interest","knows":"foaf:knows","lastName":"foaf:familyName","logo":"foaf:logo","made":"foaf:made","maker":"foaf:maker","member":"foaf:member","name":"foaf:name","nick":"foaf:nick","page":"foaf:page","pages":"foaf:page","primaryTopic":"foaf:primaryTopic","primaryTopicOf":"foaf:primaryTopicOf","publication":"foaf:publications","publications":"foaf:publications","thumbnail":"foaf:thumbnail","thumbnails":"foaf:thumbnail","topic":"foaf:topic","topics":"foaf:topic","inbox":"ldp:inbox","inboxes":"ldp:inbox","storage":"pim:storage","preferences":"pim:preferencesFile","workspace":"pim:workspace","type":"rdf:type","types":"rdf:type","comment":"rdfs:comment","comments":"rdfs:comment","label":"rdfs:label","labels":"rdfs:label","seeAlso":"rdfs:seeAlso","definedBy":"rdfs:isDefinedBy","oidcIssuer":"solid:oidcIssuer","publicTypeIndex":"solid:publicTypeIndex","publicTypeIndexes":"solid:publicTypeIndex","privateTypeIndex":"solid:privateTypeIndex","privateTypeIndexes":"solid:privateTypeIndex"}}')},,function(e,t){e.exports=$rdf},function(e,t){e.exports=solid.auth},function(e,t,r){r(12),e.exports=self.fetch.bind(self)},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function i(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(a,i)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),r(6);t.FetchDocumentLoader=class{load(e){return n(this,void 0,void 0,(function*(){const t=yield fetch(e,{headers:{accept:"application/ld+json"}});if(t.ok)return yield t.json();throw new Error(`No valid context was found at ${e}: ${t.statusText}`)}))}}},function(e,t){function r(){this.value=""}r.prototype.equals=function(e){return!!e&&e.termType===this.termType},r.prototype.termType="DefaultGraph",e.exports=r},function(e,t){function r(e){this.value=e}r.prototype.equals=function(e){return!!e&&e.termType===this.termType&&e.value===this.value},r.prototype.termType="NamedNode",e.exports=r},function(e,t,r){const n=r(20),o=r(28);e.exports=n(o,"Deep requiring like `const uuidv4 = require('uuid/v4');` is deprecated as of uuid@7.x. Please require the top-level module when using the Node.js CommonJS module or use ECMAScript Modules when bundling for the browser. See https://github.com/uuidjs/uuid#deep-requires-now-deprecated for more information.")},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function i(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(a,i)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),r(6);const o=r(13),s=r(7);class a{constructor(e){e=e||{},this.documentLoader=e.documentLoader||new s.FetchDocumentLoader,this.documentCache={},this.validate=!e.skipValidation,this.expandContentTypeToBase=e.expandContentTypeToBase}static isCompactIri(e){return e.indexOf(":")>=0&&!(e&&"#"===e[0])}static getPrefix(e,t){if(e&&"#"===e[0])return null;const r=e.indexOf(":");if(r>=0){if(e.length>r+1&&"/"===e.charAt(r+1)&&"/"===e.charAt(r+2))return null;const n=e.substr(0,r);if("_"===n)return null;if(t[n])return n}return null}static getContextValueId(e){if(null===e||"string"==typeof e)return e;const t=e["@id"];return t||null}static expandTerm(e,t,r){a.assertNormalized(t);const n=t[e];if(null===n||n&&null===n["@id"])return null;if(n&&r){const t=this.getContextValueId(n);if(t&&t!==e)return t}const s=a.getPrefix(e,t);if(s){const r=this.getContextValueId(t[s]);if(r)return r+e.substr(s.length+1)}else{if(r&&t["@vocab"]&&"@"!==e.charAt(0)&&!a.isCompactIri(e))return t["@vocab"]+e;if(!r&&t["@base"]&&"@"!==e.charAt(0)&&!a.isCompactIri(e))return o.resolve(e,t["@base"])}return e}static compactIri(e,t,r){if(a.assertNormalized(t),r&&t["@vocab"]&&e.startsWith(t["@vocab"]))return e.substr(t["@vocab"].length);if(!r&&t["@base"]&&e.startsWith(t["@base"]))return e.substr(t["@base"].length);const n={prefix:"",suffix:e};for(const o in t){const s=t[o];if(s&&!o.startsWith("@")){const t=this.getContextValueId(s);if(e.startsWith(t)){const s=e.substr(t.length);if(s)s.length<n.suffix.length&&(n.prefix=o,n.suffix=s);else if(r)return o}}}return n.prefix?n.prefix+":"+n.suffix:e}static assertNormalized(e){if("string"==typeof e||Array.isArray(e)||e["@context"])throw new Error("The given context is not normalized. Make sure to call ContextParser.parse() first.")}static isPrefixValue(e){return e&&("string"==typeof e||e["@id"]||e["@type"])}static isValidIri(e){return a.IRI_REGEX.test(e)}static idifyReverseTerms(e){for(const t of Object.keys(e)){const r=e[t];if(r&&"object"==typeof r&&r["@reverse"]&&!r["@id"]){if("string"!=typeof r["@reverse"])throw new Error(`Invalid @reverse value: '${r["@reverse"]}'`);r["@id"]=r["@reverse"],r["@reverse"]=!0}}return e}static expandPrefixedTerms(e,t){for(const r of Object.keys(e))if(a.EXPAND_KEYS_BLACKLIST.indexOf(r)<0){if("@"===r[0]&&a.ALIAS_KEYS_BLACKLIST.indexOf(r)>=0)throw new Error(`Keywords can not be aliased to something else.\nTried mapping ${r} to ${e[r]}`);for(;a.isPrefixValue(e[r]);){const n=e[r];let o=!1;if("string"==typeof n)e[r]=a.expandTerm(n,e,!0),o=o||n!==e[r];else{const s=n["@id"],i=n["@type"];s&&(e[r]["@id"]=a.expandTerm(s,e,!0),o=o||s!==e[r]["@id"]),i&&"@vocab"!==i&&(e[r]["@type"]=a.expandTerm(i,e,!0),t&&i===e[r]["@type"]&&(e[r]["@type"]=a.expandTerm(i,e,!1)),o=o||i!==e[r]["@type"])}if(!o)break}}return e}static normalize(e){for(const t of Object.keys(e))if("@language"===t&&"string"==typeof e[t])e[t]=e[t].toLowerCase();else{const r=e[t];r&&"object"==typeof r&&"string"==typeof r["@language"]&&(r["@language"]=r["@language"].toLowerCase())}return e}static validate(e){for(const t of Object.keys(e)){const r=e[t],n=typeof r;if("@"===t[0])switch(t.substr(1)){case"vocab":if(null!==r&&"string"!==n)throw new Error("Found an invalid @vocab IRI: "+r);break;case"base":if(null!==r&&"string"!==n)throw new Error("Found an invalid @base IRI: "+e[t]);break;case"language":if(null!==r&&"string"!==n)throw new Error("Found an invalid @language string: "+r)}if(null!==r)switch(n){case"string":break;case"object":if(!(a.isCompactIri(t)||"@id"in r||("@id"===r["@type"]?e["@base"]:e["@vocab"])))throw new Error(`Missing @id in context entry: '${t}': '${JSON.stringify(r)}'`);for(const e of Object.keys(r)){const n=r[e];if(n)switch(e){case"@id":if("@"===n[0]&&"@type"!==n&&"@id"!==n)throw new Error(`Illegal keyword alias in term value, found: '${t}': '${JSON.stringify(r)}'`);break;case"@type":if("@id"!==n&&"@vocab"!==n&&("_"===n[0]||!a.isValidIri(n)))throw new Error(`A context @type must be an absolute IRI, found: '${t}': '${n}'`);break;case"@reverse":if("string"==typeof n&&r["@id"]&&r["@id"]!==n)throw new Error(`Found non-matching @id and @reverse term values in '${t}':'${n}' and '${r["@id"]}'`);break;case"@container":if("@list"===n&&r["@reverse"])throw new Error(`Term value can not be @container: @list and @reverse at the same time on '${t}'`);if(a.CONTAINERS.indexOf(n)<0)throw new Error(`Invalid term @container for '${t}' ('${n}'), must be one of ${a.CONTAINERS.join(", ")}`);break;case"@language":if(null!==n&&"string"!=typeof n)throw new Error(`Found an invalid term @language string in: '${t}': '${JSON.stringify(r)}'`)}}break;default:throw new Error(`Found an invalid term value: '${t}': '${r}'`)}}}static normalizeContextIri(e,t){if(!a.isValidIri(e)&&(e=o.resolve(e,t),!a.isValidIri(e)))throw new Error("Invalid context IRI: "+e);return e}parse(e,{baseIri:t,parentContext:r,external:s}={}){return n(this,void 0,void 0,(function*(){if(null==e)return t?{"@base":t}:{};if("string"==typeof e)return this.parse(yield this.load(a.normalizeContextIri(e,t)),{baseIri:t,parentContext:r,external:!0});if(Array.isArray(e)){return(yield Promise.all(e.map(e=>"string"==typeof e?this.load(a.normalizeContextIri(e,t)):e))).reduce((e,r)=>e.then(e=>this.parse(r,{baseIri:e&&e["@base"]||t,external:s,parentContext:e})),Promise.resolve(r))}if("object"==typeof e){if(e["@context"])return yield this.parse(e["@context"],{baseIri:t,parentContext:r,external:s});e=JSON.parse(JSON.stringify(e));let n={};return s&&delete e["@base"],t&&("@base"in e?null===e["@base"]||a.isValidIri(e["@base"])||(e["@base"]=o.resolve(e["@base"],t)):e["@base"]=t),n=Object.assign({},n,r,e),a.idifyReverseTerms(n),a.expandPrefixedTerms(n,this.expandContentTypeToBase),a.normalize(n),this.validate&&a.validate(n),n}throw new Error("Tried parsing a context that is not a string, array or object, but got "+e)}))}load(e){return n(this,void 0,void 0,(function*(){const t=this.documentCache[e];return t?Array.isArray(t)?t.slice():Object.assign({},t):this.documentCache[e]=(yield this.documentLoader.load(e))["@context"]}))}}a.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^ "<>{}|\\\[\]`]*$/,a.EXPAND_KEYS_BLACKLIST=["@base","@vocab","@language"],a.ALIAS_KEYS_BLACKLIST=["@container","@graph","@id","@index","@list","@nest","@none","@prefix","@reverse","@set","@type","@value"],a.CONTAINERS=["@list","@set","@index","@language"],t.ContextParser=a},function(e,t,r){"use strict";r.r(t),r.d(t,"Headers",(function(){return d})),r.d(t,"Request",(function(){return v})),r.d(t,"Response",(function(){return j})),r.d(t,"DOMException",(function(){return E})),r.d(t,"fetch",(function(){return _}));var n="URLSearchParams"in self,o="Symbol"in self&&"iterator"in Symbol,s="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),a="FormData"in self,i="ArrayBuffer"in self;if(i)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(e){return e&&c.indexOf(Object.prototype.toString.call(e))>-1};function l(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function f(e){return"string"!=typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return o&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function h(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function y(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function w(e){var t=new FileReader,r=y(t);return t.readAsArrayBuffer(e),r}function b(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:s&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:a&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():i&&s&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=b(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):i&&(ArrayBuffer.prototype.isPrototypeOf(e)||u(e))?this._bodyArrayBuffer=b(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(w)}),this.text=function(){var e,t,r,n=h(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=y(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(x)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(e,t){e=l(e),t=f(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},d.prototype.delete=function(e){delete this.map[l(e)]},d.prototype.get=function(e){return e=l(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(l(e))},d.prototype.set=function(e,t){this.map[l(e)]=f(t)},d.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},d.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),p(e)},d.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},d.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),p(e)},o&&(d.prototype[Symbol.iterator]=d.prototype.entries);var g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(e,t){var r,n,o=(t=t||{}).body;if(e instanceof v){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new d(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),g.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function x(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}})),t}function j(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},m.call(v.prototype),m.call(j.prototype),j.prototype.clone=function(){return new j(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},j.error=function(){var e=new j(null,{status:0,statusText:""});return e.type="error",e};var T=[301,302,303,307,308];j.redirect=function(e,t){if(-1===T.indexOf(t))throw new RangeError("Invalid status code");return new j(null,{status:t,headers:{location:e}})};var E=self.DOMException;try{new E}catch(e){(E=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack}).prototype=Object.create(Error.prototype),E.prototype.constructor=E}function _(e,t){return new Promise((function(r,n){var o=new v(e,t);if(o.signal&&o.signal.aborted)return n(new E("Aborted","AbortError"));var a=new XMLHttpRequest;function i(){a.abort()}a.onload=function(){var e,t,n={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new d,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}})),t)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var o="response"in a?a.response:a.responseText;r(new j(o,n))},a.onerror=function(){n(new TypeError("Network request failed"))},a.ontimeout=function(){n(new TypeError("Network request failed"))},a.onabort=function(){n(new E("Aborted","AbortError"))},a.open(o.method,o.url,!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&s&&(a.responseType="blob"),o.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),o.signal&&(o.signal.addEventListener("abort",i),a.onreadystatechange=function(){4===a.readyState&&o.signal.removeEventListener("abort",i)}),a.send(void 0===o._bodyInit?null:o._bodyInit)}))}_.polyfill=!0,self.fetch||(self.fetch=_,self.Headers=d,self.Request=v,self.Response=j)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(14))},function(e,t,r){"use strict";function n(e){const t=[];let r=0;for(;r<e.length;)switch(e[r]){case"/":if("."===e[r+1])if("."===e[r+2]){if(!s(e[r+3])){t.push([]),r++;break}t.pop(),e[r+3]||t.push([]),r+=3}else{if(!s(e[r+2])){t.push([]),r++;break}e[r+2]||t.push([]),r+=2}else t.push([]),r++;break;case"#":case"?":t.length||t.push([]),t[t.length-1].push(e.substr(r)),r=e.length;break;default:t.length||t.push([]),t[t.length-1].push(e[r]),r++}return"/"+t.map(e=>e.join("")).join("/")}function o(e,t){let r=t+1;t>=0?"/"===e[t+1]&&"/"===e[t+2]&&(r=t+3):"/"===e[0]&&"/"===e[1]&&(r=2);const o=e.indexOf("/",r);return o<0?e:e.substr(0,o)+n(e.substr(o))}function s(e){return!e||"#"===e||"?"===e||"/"===e}Object.defineProperty(t,"__esModule",{value:!0}),t.resolve=function(e,t){const r=(t=t||"").indexOf("#");if(r>0&&(t=t.substr(0,r)),!e.length)return t;if(e.startsWith("?")){const r=t.indexOf("?");return r>0&&(t=t.substr(0,r)),t+e}if(e.startsWith("#"))return t+e;if(!t.length)return o(e,e.indexOf(":"));const s=e.indexOf(":");if(s>=0)return o(e,s);const a=t.indexOf(":");if(a<0)throw new Error(`Found invalid baseIRI '${t}' for value '${e}'`);const i=t.substr(0,a+1);if(0===e.indexOf("//"))return i+o(e,s);let c;if(t.indexOf("//",a)===a+1){if(c=t.indexOf("/",a+3),c<0)return t.length>a+3?t+"/"+o(e,s):i+o(e,s)}else if(c=t.indexOf("/",a+1),c<0)return i+o(e,s);if(0===e.indexOf("/"))return t.substr(0,c)+n(e);let u=t.substr(c);const l=u.lastIndexOf("/");return l>=0&&l<u.length-1&&(u=u.substr(0,l+1),"."===e[0]&&"."!==e[1]&&"/"!==e[1]&&e[2]&&(e=e.substr(1))),e=n(e=u+e),t.substr(0,c)+e},t.removeDotSegments=n,t.removeDotSegmentsOfPath=o},function(e,t,r){var n=r(16),o=r(8),s=r(17),a=r(9),i=r(18),c=r(19);function u(){}u.namedNode=function(e){return new a(e)},u.blankNode=function(e){return new n(e)},u.literal=function(e,t){return"string"==typeof t?-1===t.indexOf(":")?new s(e,t):new s(e,null,u.namedNode(t)):new s(e,null,t)},u.defaultGraph=function(){return u.defaultGraphInstance},u.variable=function(e){return new c(e)},u.triple=function(e,t,r){return u.quad(e,t,r)},u.quad=function(e,t,r,n){return new i(e,t,r,n||u.defaultGraphInstance)},u.defaultGraphInstance=new o,e.exports=u},function(e,t){function r(e){this.value=e||"b"+ ++r.nextId}r.prototype.equals=function(e){return!!e&&e.termType===this.termType&&e.value===this.value},r.prototype.termType="BlankNode",r.nextId=0,e.exports=r},function(e,t,r){var n=r(9);function o(e,t,r){this.value=e,this.datatype=o.stringDatatype,this.language="",t?(this.language=t,this.datatype=o.langStringDatatype):r&&(this.datatype=r)}o.prototype.equals=function(e){return!!e&&e.termType===this.termType&&e.value===this.value&&e.language===this.language&&e.datatype.equals(this.datatype)},o.prototype.termType="Literal",o.langStringDatatype=new n("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),o.stringDatatype=new n("http://www.w3.org/2001/XMLSchema#string"),e.exports=o},function(e,t,r){var n=r(8);function o(e,t,r,o){this.subject=e,this.predicate=t,this.object=r,this.graph=o||new n}o.prototype.equals=function(e){return!!e&&e.subject.equals(this.subject)&&e.predicate.equals(this.predicate)&&e.object.equals(this.object)&&e.graph.equals(this.graph)},e.exports=o},function(e,t){function r(e){this.value=e}r.prototype.equals=function(e){return!!e&&e.termType===this.termType&&e.value===this.value},r.prototype.termType="Variable",e.exports=r},function(e,t,r){let n;try{n=r(21).deprecate}catch(e){n=function(e,t){var r=!1;return function(){return r||(console.warn(t),r=!0),e.apply(this,arguments)}}}e.exports=n},function(e,t,r){(function(e){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},o=/%[sdj%]/g;t.format=function(e){if(!b(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(i(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,s=n.length,a=String(e).replace(o,(function(e){if("%%"===e)return"%";if(r>=s)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),c=n[r];r<s;c=n[++r])y(c)||!v(c)?a+=" "+c:a+=" "+i(c);return a},t.deprecate=function(r,n){if(void 0!==e&&!0===e.noDeprecation)return r;if(void 0===e)return function(){return t.deprecate(r,n).apply(this,arguments)};var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),o=!0}return r.apply(this,arguments)}};var s,a={};function i(e,r){var n={seen:[],stylize:u};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),h(r)?n.showHidden=r:r&&t._extend(n,r),m(n.showHidden)&&(n.showHidden=!1),m(n.depth)&&(n.depth=2),m(n.colors)&&(n.colors=!1),m(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),l(n,e,n.depth)}function c(e,t){var r=i.styles[t];return r?"["+i.colors[r][0]+"m"+e+"["+i.colors[r][1]+"m":e}function u(e,t){return e}function l(e,r,n){if(e.customInspect&&r&&T(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var o=r.inspect(n,e);return b(o)||(o=l(e,o,n)),o}var s=function(e,t){if(m(t))return e.stylize("undefined","undefined");if(b(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(w(t))return e.stylize(""+t,"number");if(h(t))return e.stylize(""+t,"boolean");if(y(t))return e.stylize("null","null")}(e,r);if(s)return s;var a=Object.keys(r),i=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(r)),j(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return f(r);if(0===a.length){if(T(r)){var c=r.name?": "+r.name:"";return e.stylize("[Function"+c+"]","special")}if(g(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(x(r))return e.stylize(Date.prototype.toString.call(r),"date");if(j(r))return f(r)}var u,v="",E=!1,_=["{","}"];(d(r)&&(E=!0,_=["[","]"]),T(r))&&(v=" [Function"+(r.name?": "+r.name:"")+"]");return g(r)&&(v=" "+RegExp.prototype.toString.call(r)),x(r)&&(v=" "+Date.prototype.toUTCString.call(r)),j(r)&&(v=" "+f(r)),0!==a.length||E&&0!=r.length?n<0?g(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),u=E?function(e,t,r,n,o){for(var s=[],a=0,i=t.length;a<i;++a)P(t,String(a))?s.push(p(e,t,r,n,String(a),!0)):s.push("");return o.forEach((function(o){o.match(/^\d+$/)||s.push(p(e,t,r,n,o,!0))})),s}(e,r,n,i,a):a.map((function(t){return p(e,r,n,i,t,E)})),e.seen.pop(),function(e,t,r){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(u,v,_)):_[0]+v+_[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,r,n,o,s){var a,i,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?i=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(i=e.stylize("[Setter]","special")),P(n,o)||(a="["+o+"]"),i||(e.seen.indexOf(c.value)<0?(i=y(r)?l(e,c.value,null):l(e,c.value,r-1)).indexOf("\n")>-1&&(i=s?i.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+i.split("\n").map((function(e){return"   "+e})).join("\n")):i=e.stylize("[Circular]","special")),m(a)){if(s&&o.match(/^\d+$/))return i;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+i}function d(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function y(e){return null===e}function w(e){return"number"==typeof e}function b(e){return"string"==typeof e}function m(e){return void 0===e}function g(e){return v(e)&&"[object RegExp]"===E(e)}function v(e){return"object"==typeof e&&null!==e}function x(e){return v(e)&&"[object Date]"===E(e)}function j(e){return v(e)&&("[object Error]"===E(e)||e instanceof Error)}function T(e){return"function"==typeof e}function E(e){return Object.prototype.toString.call(e)}function _(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(r){if(m(s)&&(s=e.env.NODE_DEBUG||""),r=r.toUpperCase(),!a[r])if(new RegExp("\\b"+r+"\\b","i").test(s)){var n=e.pid;a[r]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",r,n,e)}}else a[r]=function(){};return a[r]},t.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=h,t.isNull=y,t.isNullOrUndefined=function(e){return null==e},t.isNumber=w,t.isString=b,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=m,t.isRegExp=g,t.isObject=v,t.isDate=x,t.isError=j,t.isFunction=T,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(26);var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(){var e=new Date,t=[_(e.getHours()),_(e.getMinutes()),_(e.getSeconds())].join(":");return[e.getDate(),O[e.getMonth()],t].join(" ")}function P(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",S(),t.format.apply(t,arguments))},t.inherits=r(27),t._extend=function(e,t){if(!t||!v(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var A="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function I(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(A&&e[A]){var t;if("function"!=typeof(t=e[A]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,A,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),o=[],s=0;s<arguments.length;s++)o.push(arguments[s]);o.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,o)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),A&&Object.defineProperty(t,A,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=A,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var o=r.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var s=this,a=function(){return o.apply(s,arguments)};t.apply(this,r).then((function(t){e.nextTick(a,null,t)}),(function(t){e.nextTick(I,t,a)}))}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.defineProperties(r,n(t)),r}}).call(this,r(22))},function(e,t,r){(function(t){var r=e.exports={};function n(){}r.nextTick=t,r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=n,r.addListener=n,r.once=n,r.off=n,r.removeListener=n,r.removeAllListeners=n,r.emit=n,r.prependListener=n,r.prependOnceListener=n,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}}).call(this,r(23).setImmediate)},function(e,t,r){(function(e){var n=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function s(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new s(o.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new s(o.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(n,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r(25),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(24))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){const r=Promise.resolve(null);window.setImmediate=function(e,...t){r.then(0===t.length?e:()=>e(...t))}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r(29)),o=s(r(30));function s(e){return e&&e.__esModule?e:{default:e}}var a=function(e,t,r){var s=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||n.default)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var i=0;i<16;++i)t[s+i]=a[i];return t||(0,o.default)(a)};t.default=a,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!n)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)};var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),o=new Uint8Array(16);e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;for(var n=[],o=0;o<256;++o)n[o]=(o+256).toString(16).substr(1);var s=function(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")};t.default=s,e.exports=t.default},function(e,t,r){"use strict";r.r(t);const n={};function o(e){return e[Symbol.asyncIterator]().next().then(e=>e.value)}class s{constructor(e,...t){this._isAsync=e.async,this._isFunction=e.function,this._dataProperties=t}static sync(...e){return new s({async:!1},...e)}static syncFunction(...e){return new s({async:!1,function:!0},...e)}static async(...e){return new s({async:!0},...e)}static asyncFunction(...e){return new s({async:!0,function:!0},...e)}handle(e){return this._isFunction?()=>this._resolveDataPath(e):this._resolveDataPath(e)}_resolveDataPath(e){return this._isAsync?this._resolveAsyncDataPath(e):this._resolveSyncDataPath(e)}_resolveSyncDataPath(e){for(const t of this._dataProperties)e=e&&e[t];return e}async _resolveAsyncDataPath(e){for(const t of this._dataProperties)e=e&&await e[t];return e}}var a=r(0);function i(e){return{then:c(e)}}function c(e){return(t,r)=>e().then(t,r)}function u(e){return"function"==typeof e&&(e=function(e){const t=[];let r=e[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){let e=0;return{async next(){if(e<t.length)return t[e++];if(!r)return{done:!0};const n=t[e++]=r.next();return(await n).done&&(r=null),n}}}}}(e())),{[Symbol.asyncIterator]:()=>e[Symbol.asyncIterator](),get then(){return c(()=>o(this))},catch(e){return this.then(null,e)},finally(e){return this.then().finally(e)}}}class l{constructor(e,t){this._mutationType=e,this._allowZeroArgs=t}handle(e,t){return(...r)=>{if(!this._allowZeroArgs&&!r.length)throw new Error("Mutation on ".concat(e," can not be invoked without arguments"));const n=i(()=>this.createMutationExpressions(e,t,r));return e.extendPath({mutationExpressions:n})}}async createMutationExpressions(e,t,r){const n=await t.pathExpression;if(!Array.isArray(n))throw new Error("".concat(e," has no pathExpression property"));if(n.length<2)throw new Error("".concat(e," should at least contain a subject and a predicate"));const o=await this.extractObjects(e,t,r),s=this._mutationType;if(!o)return[{mutationType:s,conditions:n}];if(0===o.length)return[];const{predicate:a}=n.pop();if(!a)throw new Error("Expected predicate in ".concat(e));return[{mutationType:s,conditions:n,predicate:a,objects:o}]}async extractObjects(e,t,r){if(0===r.length)return null;const n=[];for(const o of r)if(o&&o[Symbol.asyncIterator])for await(const r of o)n.push(this.extractObject(e,t,r));else n.push(this.extractObject(e,t,await o));return n}extractObject(e,t,r){if("string"==typeof r)return Object(a.literal)(r);if(r&&r.termType)return r;throw new Error("Invalid object: ".concat(r))}}class f extends l{constructor(){super("DELETE",!0)}}const p=/(SELECT\s+)(\?\S+)/,d=/\}[^}]*$/;function h(e){const{termType:t,value:r}=e;switch(t){case"NamedNode":return r;case"Literal":const{language:n,datatype:o}=e;return"".concat(t,"|").concat(n,"|").concat(o.value,"|").concat(r);default:return"".concat(t,"|").concat(r)}}var y=r(1);class w{constructor(e="ASC"){this.order=e}handle(e,t){return(...r)=>{if(0===r.length)return t;const[n,...o]=r,{predicate:s}=t[n],a={property:n,predicate:s,sort:this.order},i=e.extendPath(a);return 0===o.length?i:i.sort(...o)}}}const b=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,m=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,g={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class v{async handle(e,t){const r=await t.mutationExpressions;if(Array.isArray(r)&&r.length)return r.map(e=>this.mutationExpressionToQuery(e)).join("\n;\n");const n=await t.pathExpression;if(!Array.isArray(n))throw new Error("".concat(e," has no pathExpression property"));return this.pathExpressionToQuery(e,t,n)}pathExpressionToQuery(e,t,r){if(r.length<2&&!e.finalClause)throw new Error("".concat(e," should at least contain a subject and a predicate"));let n="?subject",o=[],s=[];r.length>1&&(n=this.createVar(e.property),({queryVar:n,sorts:o,clauses:s}=this.expressionToTriplePatterns(r,n))),e.finalClause&&s.push(e.finalClause(n));const a=e.distinct?"DISTINCT ":"",i="SELECT ".concat(a).concat(e.select?e.select:n),c=" WHERE {\n  ".concat(s.join("\n  "),"\n}"),u=o.map(({order:e,variable:t})=>"".concat(e,"(").concat(t,")")),l=0===u.length?"":"\nORDER BY ".concat(u.join(" "));return"".concat(i).concat(c).concat(l)}mutationExpressionToQuery({mutationType:e,conditions:t,predicate:r,objects:n}){const o={};let s,a;if(1===t.length)s=this.termToString(t[0].subject),a=[];else{const e=t[t.length-1].predicate;s=this.createVar(e.value,o),({queryVar:s,clauses:a}=this.expressionToTriplePatterns(t,s,o))}const i=n&&n.map(e=>this.termToString(e)).join(", "),c=i?"".concat(s," ").concat(this.termToString(r)," ").concat(i,"."):a[a.length-1];return 0===a.length?"".concat(e," DATA {\n  ").concat(c,"\n}"):"".concat(e," {\n  ").concat(c,"\n} WHERE {\n  ").concat(a.join("\n  "),"\n}")}expressionToTriplePatterns([e,...t],r,n={}){const o=t.length-1;let s=this.termToString(function(e){if("BlankNode"!==e.termType)return e;e.skolemized||(e.skolemized=Object(a.namedNode)("urn:ldflex:sk".concat(j++)));return e.skolemized}(e.subject)),i=s;const c=[],u=t.map((e,t)=>{const a=s,{predicate:u}=e;s=t<o?this.createVar("v".concat(t),n):r;const l="".concat(a," ").concat(this.termToString(u)," ").concat(s,".");return e.sort?(c.push({variable:s,order:e.sort}),s=i):i=s,l});return{queryVar:i,sorts:c,clauses:u}}createVar(e="",t){let r=0,n="?".concat(e.match(/[a-z0-9]*$/i)[0]||"result");if(t){for(;t[n];)n="?".concat(e,"_").concat(r++);t[n]=!0}return n}termToString(e){let{value:t}=e;switch(b.test(t)&&(t=t.replace(m,x)),e.termType){case"NamedNode":return"<".concat(t,">");case"BlankNode":return"_:".concat(t);case"Literal":let r="";return e.language?r="@".concat(e.language):"http://www.w3.org/2001/XMLSchema#string"!==e.datatype.value&&(r="^^<".concat(e.datatype.value,">")),'"'.concat(t,'"').concat(r);default:throw new Error("Could not convert a term of type ".concat(e.termType))}}}function x(e){let t=g[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}let j=0;var T={__esModule:()=>{},then:new class{handle({subject:e},t){return e?e.then&&c(()=>t.subject):c(()=>o(t.results))}},[Symbol.asyncIterator]:new class{handle({subject:e},t){return e?()=>{return e=t.subject,{async next(){if(e!==n){const t=await e;return e=n,{value:t}}return{done:!0}}};var e}:()=>t.results[Symbol.asyncIterator]()}},subject:new class{handle(e){let{subject:t,parent:r}=e;for(;!t&&r;)({subject:t,parent:r}=r);return t?Promise.resolve(t).then(t=>e.extendPath({subject:t},null)):void 0}},predicate:new class{handle(e){const{predicate:t}=e;return t?Promise.resolve(t).then(t=>e.extendPath({subject:t},null)):void 0}},properties:new class{handle(e,t){return u(this._handle(e,t))}async*_handle(e,t){const r=await e.settings.parsedContext||{};for await(const e of t.predicates)yield y.ContextParser.compactIri("".concat(await e),r,!0)}},predicates:new class{handle(e){return e.extendPath({distinct:!0,select:"?predicate",finalClause:e=>"".concat(e," ?predicate ?object."),property:e.property})}},pathExpression:new class{async handle(e){const t=[];let r=e;for(;r.parent;)r.predicate&&t.unshift({predicate:await r.predicate,sort:r.sort}),r=r.parent;if(!r.subject)throw new Error("Expected root subject in ".concat(r));const n=await r.subject;return t.unshift({subject:n}),t}},sparql:new v,subjects:new class{handle(e){return e.extendPath({distinct:!0,select:"?subject",finalClause:()=>"?subject ?predicate ?object.",property:e.property})}},results:new class{async*handle(e,t){const r=await e.resultsCache;if(r){for(const e of r)yield e;return}const{queryEngine:n}=e.settings;if(!n)throw new Error("".concat(e," has no queryEngine setting"));const o=await t.sparql;if(!o)throw new Error("".concat(e," has no sparql property"));for await(const t of n.execute(o))yield this.extractTerm(t,e)}extractTerm(e,t){if(1!==e.size)throw new Error("Only single-variable queries are supported");const r=e.values().next().value;return t.extendPath({subject:r},null)}},sort:new w("ASC"),sortDesc:new w("DESC"),preload:new class{handle(e,t){return async(...r)=>{if(r.length>0){const n=await Promise.all(r.map(async e=>(await t[e].predicate).value));e.resultsCache=await this.createResultsCache(n,e,t)}return t}}async createResultsCache(e,t,r){const{query:n,vars:o,resultVar:s}=await this.createQuery(e,r),{settings:{queryEngine:a}}=t,i=a.execute(n),c={},u={};for await(const r of i){const n=r.get(s),a=h(n);if(!(a in c)){const r=u[a]={};for(const t of e)r[t]=[];const o={subject:n,propertyCache:r};c[a]=t.extendPath(o,null)}const i=u[a];for(let n=0;n<o.length;n++){const s=r.get(o[n]);if(s){const r=t.extendPath({subject:s},null);i[e[n]].push(r)}}}return Object.values(c)}async createQuery(e,t){const r=await t.sparql,n=p.exec(r);if(!n)throw new Error("Unexpected path query: ".concat(r));const o=n[2],s=e.map((e,t)=>"?preload_".concat(t)),a=e.map((e,t)=>"    { ".concat(o," <").concat(e,"> ").concat(s[t],". }")).join("\n    UNION\n");return{query:r.replace(p,"$1$2 ".concat(s.join(" "))).replace(d,"  OPTIONAL {\n".concat(a,"\n  }\n$&")),vars:s,resultVar:o}}},mutationExpressions:new class{async handle(e){const t=[];let r=e;for(;r;)r.mutationExpressions&&t.unshift(...await r.mutationExpressions),r=r.parent;return t}},add:new class extends l{constructor(){super("INSERT",!1)}},set:new class{handle(e,t){return(...e)=>t.delete().add(...e)}},replace:new class{handle(e,t){return function(e,...r){if(!e||!r.length)throw new Error("Replacing values requires at least two arguments, old value followed by all new values");return t.delete(e).add(...r)}}},delete:new f,termType:_("termType"),value:_("value"),datatype:_("datatype"),language:_("language"),equals:s.sync("subject","equals"),toString:s.syncFunction("subject","value"),toPrimitive:s.syncFunction("subject","value"),toArray:new class{handle(e,t){return async e=>{const r=[];if(t&&"function"==typeof t[Symbol.asyncIterator]){"function"!=typeof e&&(e=e=>e);let n=0;for await(const o of t)r.push(await e(o,n++))}return r}}},termTypes:E((e,t)=>t.toArray(e=>e.termType)),values:E((e,t)=>t.toArray(e=>e.value)),datatypes:E((e,t)=>t.toArray(e=>e.datatype)),languages:E((e,t)=>t.toArray(e=>e.language)),resolve:new class{handle(e,t){return(e="",r=t)=>{const n=e.replace(/^(https?:\/\/[^()[\]'"]+)$/,'["$1"]').replace(/^(?=[a-z$_])/i,".").replace(/\[([^'"`\](]*)\]/g,'["$1"]'),o='"use strict";return ldflex'.concat(n);let s;try{s=Function("ldflex",o)}catch({message:t}){throw new Error('Expression "'.concat(e,'" is invalid: ').concat(t))}return s(r)}}}};function E(e){return{handle:e}}function _(e){return E((t,r)=>{const{subject:n}=t,o=n&&n[e];return void 0!==o?o:r.then(t=>t&&t[e])})}const O=Object.create(null);class S{constructor({handlers:e=O,resolvers:t=[]}={}){this._handlers=e,this._resolvers=t}createPath(e={},t){void 0===t&&([t,e]=[e,{}]);const r={settings:e,...t},n=r.proxy=new Proxy(r,this);if(!r.extendPath){const t=this;r.extendPath=function r(n,o=this){return t.createPath(e,{parent:o,extendPath:r,...n})}}return n}get(e,t){const r=this._handlers[t];if(r&&"function"==typeof r.handle)return r.handle(e,e.proxy);for(const r of this._resolvers)if(r.supports(t))return r.resolve(t,e,e.proxy)}}class P{constructor(...e){this._context=Promise.resolve({}),this.extendContext(...e)}supports(e){return"string"==typeof e}resolve(e,t){const r=i(()=>this.expandProperty(e)),n=this.getResultsCache(t,r);return t.extendPath({property:e,predicate:r,resultsCache:n})}async expandProperty(e){e=e.replace(/^([a-z][a-z0-9]*)[_$]/i,"$1:");const t=await this._context,r=y.ContextParser.expandTerm(e,t,!0);if(!y.ContextParser.isValidIri(r))throw new Error("The JSON-LD context cannot expand the '".concat(e,"' property"));return Object(a.namedNode)(r)}async extendContext(...e){await(this._context=this._context.then(t=>(new y.ContextParser).parse([t,...e])))}getResultsCache(e,t){let{propertyCache:r}=e;return r&&i(async()=>(r=await r,r&&r[(await t).value]))}}class A{constructor(e,t){this._settings=e={...e},this._data=t={...t};const r=e.handlers||T;for(const e in r)r[e]=I(r[e]);for(const e of Object.getOwnPropertySymbols(r))r[e]=I(r[e]);const n=(e.resolvers||[]).map(C);e.context?(n.push(new P(e.context)),e.parsedContext=(new y.ContextParser).parse(e.context)):e.context=e.parsedContext={},this._pathProxy=new S({handlers:r,resolvers:n}),delete e.handlers,delete e.resolvers}create(e={},t){return t||([t,e]=[e,null]),this._pathProxy.createPath(Object.assign(Object.create(null),this._settings,e),Object.assign(Object.create(null),this._data,t))}}function I(e){return"function"==typeof e.handle?e:{handle:e}}function C(e){return"function"==typeof e.resolve?e:{supports:N,resolve:e}}function N(){return!0}A.defaultHandlers=T;var R=r(2);const{as:k}=R["@context"];class D{constructor({activitiesPath:e="/public/activities"}={}){this.requireUser=!0,this.activitiesPath=e}handle(e,t){const r=this,{root:n}=t,{settings:{queryEngine:o}}=e;return(e=k+"Like")=>u((async function*(){let s;try{s=await n.user}catch(e){if(r.requireUser)throw e;return}const i=await n.user.pim$storage,c=new URL(r.activitiesPath,i||s).href,u=[],l=Object(a.namedNode)(s);e=Object(a.namedNode)(e);for await(const n of t)if("NamedNode"===n.termType){const t={actor:l,type:e,object:n};for await(const e of r.createResults(t,c,o))u.push(e)}for(const e of await r.processResults(u,c,o))yield n[e.value]}))}async processResults(e){return e}}const{termToString:L}=v.prototype;function U(e,t){for(const r in t)e=e.replace(new RegExp("_:"+r,"g"),L(t[r]));return e}function q(...e){return{size:e.length,values:()=>({next:()=>({value:e.shift()})})}}var F=r(10),B=r.n(F);const{xsd:$}=R["@context"];const z=["?subject","?predicate","?object"];class M{constructor(e,t){this._paths=e,this._source=t}supports(e){return"string"==typeof e}resolve(e,{settings:t}){return this._createSubjectPath(Object(a.namedNode)(e),t)}_createSubjectPath(e,{createQueryEngine:t}){const r=t(this._source||Promise.resolve(e).catch(()=>null));return this._paths.create({queryEngine:r},{subject:e})}}class V{constructor(e){this._paths=e}handle({settings:e}){return t=>new A({handlers:{...T},resolvers:[new M(this._paths,t)]}).create(e,{})}}var H=r(5),G=r.n(H);class J extends M{handle({settings:e}){const t=this.getWebId().then(a.namedNode);return this._createSubjectPath(t,e)}async getWebId(){const e=await G.a.currentSession();if(!e)throw new Error("Cannot resolve user path: no user logged in");return e.webId}}const{as:Q}=R["@context"],W=new class extends P{constructor(e){super(e);const t=this._exposedContext=Object.create(e["@context"]);Object.defineProperty(t,"extend",{value:(...e)=>this.extendContext(...e)}),Object.defineProperty(t,"then",{value:(e,t)=>this._context.then(e,t)})}handle(){return this._exposedContext}}(R),K={...T,delete:new class extends f{async extractObjects(e,t,r){const n=await super.extractObjects(e,t,r),o=[];for await(const e of t)"BlankNode"!==e.termType&&o.push(e);return n?o.filter(e=>n.some(t=>t.equals(e))):o}},findActivity:new class extends D{constructor(...e){super(...e),this.requireUser=!1}async*createResults(e,t,r){const n=U("SELECT ?activity WHERE {\n  ?activity a _:type;\n      <https://www.w3.org/ns/activitystreams#actor> _:actor;\n      <https://www.w3.org/ns/activitystreams#object> _:object.\n}\n",e);for await(const e of r.execute(n,t))yield e.values().next().value}},likes:(e,t)=>t.findActivity(Q+"Like"),dislikes:(e,t)=>t.findActivity(Q+"Dislike"),follows:(e,t)=>t.findActivity(Q+"Follow"),createActivity:new class extends D{async*createResults(e,t){const r=Object(a.namedNode)(new URL("#"+B()(),t).href),n=U("_:id a _:type;\n    <https://www.w3.org/ns/activitystreams#actor> _:actor;\n    <https://www.w3.org/ns/activitystreams#object> _:object;\n    <https://www.w3.org/ns/activitystreams#published> _:published.\n",e={id:r,published:Object(a.literal)((new Date).toISOString(),$+"dateTime"),...e});yield{id:r,insert:n}}async processResults(e,t,r){const n=`INSERT {\n${e.map(e=>e.insert).join("")}}`;return await r.executeUpdate(n,t).next(),e.map(e=>e.id)}},like:(e,t)=>()=>t.createActivity(Q+"Like"),dislike:(e,t)=>()=>t.createActivity(Q+"Dislike"),follow:(e,t)=>()=>t.createActivity(Q+"Follow"),deleteActivity:new class extends D{async*createResults(e,t,r){const n=U("SELECT ?subject ?predicate ?object WHERE {\n  ?subject a _:type;\n      <https://www.w3.org/ns/activitystreams#actor> _:actor;\n      <https://www.w3.org/ns/activitystreams#object> _:object.\n  ?subject ?predicate ?object.\n}\n",e);for await(const e of r.execute(n,t)){const t=z.map(t=>L(e.get(t)));yield t.join(" ")+".\n"}}async processResults(e,t,r){const n=`DELETE {\n${e.join("")}}`;return await r.executeUpdate(n,t).next(),[]}},unlike:(e,t)=>()=>t.deleteActivity(Q+"Like"),undislike:(e,t)=>()=>t.deleteActivity(Q+"Dislike"),unfollow:(e,t)=>()=>t.deleteActivity(Q+"Follow")};class X{constructor(e,t){this._source=this.getUpdateSource(e),this._source.catch(()=>null),this._engine=t}async*execute(e,t){yield*/^\s*(?:INSERT|DELETE)/i.test(e)?this.executeUpdate(e,t):this._engine.execute(e,t)}executeUpdate(e,t){let r=!1;return{next:async()=>{if(r)return{done:r};r=!0;const n=await(t?this.getUpdateSource(t):this._source),{ok:o,status:s,statusText:a}=await G.a.fetch(n,{method:"PATCH",headers:{"Content-Type":"application/sparql-update"},body:e});if(!o)throw new Error(`Update query failed (${s}): ${a}`);return await this.clearCache(n),{value:q({ok:o})}},[Symbol.asyncIterator](){return this}}}async getUpdateSource(e){let t=await e;if(t instanceof URL?t=t.href:t&&"string"==typeof t.value&&(t=t.value),"string"==typeof t){if(!/^https?:\/\//.test(t))throw new Error("Can only update an HTTP(S) document.");return t.replace(/#.*/,"")}if(Array.isArray(t)){if(t=await Promise.all(t.map(e=>this.getUpdateSource(e))),t=[].concat(...t).filter(e=>!!e),1!==t.length)throw new Error("Can only update a single source.");return t[0]}throw new Error("Unsupported source: "+t)}clearCache(e){return this._engine.clearCache(e)}}var Z=r(4);var Y=class{constructor(e){this._defaultStore=this.readSources(e),this._defaultStore.catch(()=>null)}async*execute(e,t){/^\s*(?:INSERT|DELETE)/i.test(e)&&(yield*this.executeUpdate(e,t));const r=Object(Z.SPARQLToQuery)(e,!0,Object(Z.graph)()),n=await(t?this.readSources(t):this._defaultStore);n.fetcher=null;const o=[];await new Promise((e,t)=>{n.query(r,e=>o.push(e),null,r=>r?t(r):e(o))});const s=new Set(r.vars.map(e=>"?"+e.value));for(const e of o){const t=Object.entries(e).filter(([e])=>s.has(e));yield new Map(t)}}async*executeUpdate(e,t){throw new Error("SPARQL UPDATE queries are unsupported, received: "+e)}async readSources(e,t=Object(Z.graph)()){let r=await e;if(r)if(r instanceof URL?r=r.href:"NamedNode"===r.termType&&(r=r.value),"string"==typeof r){const e=r.replace(/#.*/,""),n=new Z.Fetcher(t);await n.load(e)}else if(Array.isArray(r))await Promise.all(r.map(e=>this.readSources(e,t)));else{if("function"!=typeof r.match)throw new Error("Unsupported source: "+r);{const e=r.match(null,null,null,null);await new Promise((r,n)=>{function o(e){try{t.add(e.subject,e.predicate,e.object,e.graph)}catch(e){s(e)}}function s(t){return e.removeListener("data",o),e.removeListener("end",s),e.removeListener("error",s),t?n(t):r(null)}e.on("data",o),e.on("end",s),e.on("error",s)})}}return t}async clearCache(e){}};t.default=new function(e){let t=null;const r=new A({handlers:{...K,root:()=>t},resolvers:[W]});return t=new A({handlers:{...T,from:new V(r),user:new J(r),clearCache:({settings:e})=>t=>e.createQueryEngine().clearCache(t),context:W},resolvers:[new M(r)],...e}).create(),t}({createQueryEngine:e=>new X(e,new Y(e))})}]).default;
//# sourceMappingURL=solid-query-ldflex.rdflib.js.map