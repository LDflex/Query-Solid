{"version":3,"sources":["webpack://solid.data/webpack/bootstrap","webpack://solid.data/./node_modules/@rdfjs/data-model/index.js","webpack://solid.data/./node_modules/jsonld-context-parser/index.js","webpack://solid.data/external [\"solid\",\"auth\"]","webpack://solid.data/external \"$rdf\"","webpack://solid.data/./node_modules/jsonld-context-parser/lib/ErrorCoded.js","webpack://solid.data/./node_modules/relative-to-absolute-iri/index.js","webpack://solid.data/./node_modules/jsonld-context-parser/lib/Util.js","webpack://solid.data/./node_modules/jsonld-context-parser/lib/ContextParser.js","webpack://solid.data/./node_modules/isomorphic-fetch/fetch-npm-browserify.js","webpack://solid.data/./node_modules/jsonld-context-parser/lib/FetchDocumentLoader.js","webpack://solid.data/./node_modules/jsonld-context-parser/lib/JsonLdContextNormalized.js","webpack://solid.data/./node_modules/@rdfjs/data-model/lib/default-graph.js","webpack://solid.data/./node_modules/@rdfjs/data-model/lib/named-node.js","webpack://solid.data/./node_modules/whatwg-fetch/fetch.js","webpack://solid.data/./node_modules/relative-to-absolute-iri/lib/Resolve.js","webpack://solid.data/./node_modules/http-link-header/lib/link.js","webpack://solid.data/./node_modules/buffer/index.js","webpack://solid.data/(webpack)/buildin/global.js","webpack://solid.data/./node_modules/base64-js/index.js","webpack://solid.data/./node_modules/ieee754/index.js","webpack://solid.data/./node_modules/isarray/index.js","webpack://solid.data/./node_modules/canonicalize/lib/canonicalize.js","webpack://solid.data/./node_modules/@rdfjs/data-model/lib/data-factory.js","webpack://solid.data/./node_modules/@rdfjs/data-model/lib/blank-node.js","webpack://solid.data/./node_modules/@rdfjs/data-model/lib/literal.js","webpack://solid.data/./node_modules/@rdfjs/data-model/lib/quad.js","webpack://solid.data/./node_modules/@rdfjs/data-model/lib/variable.js","webpack://solid.data/./node_modules/ldflex/module/iterableUtils.js","webpack://solid.data/./node_modules/ldflex/module/DataHandler.js","webpack://solid.data/./node_modules/ldflex/module/promiseUtils.js","webpack://solid.data/./node_modules/ldflex/module/valueUtils.js","webpack://solid.data/./node_modules/ldflex/module/MutationFunctionHandler.js","webpack://solid.data/./node_modules/ldflex/module/DeleteFunctionHandler.js","webpack://solid.data/./node_modules/ldflex/module/PreloadHandler.js","webpack://solid.data/./node_modules/ldflex/module/SortHandler.js","webpack://solid.data/./node_modules/ldflex/module/SparqlHandler.js","webpack://solid.data/./node_modules/ldflex/module/defaultHandlers.js","webpack://solid.data/./node_modules/ldflex/module/ThenHandler.js","webpack://solid.data/./node_modules/ldflex/module/AsyncIteratorHandler.js","webpack://solid.data/./node_modules/ldflex/module/GetFunctionHandler.js","webpack://solid.data/./node_modules/ldflex/module/SubjectHandler.js","webpack://solid.data/./node_modules/ldflex/module/PredicateHandler.js","webpack://solid.data/./node_modules/ldflex/module/PropertiesHandler.js","webpack://solid.data/./node_modules/ldflex/module/PredicatesHandler.js","webpack://solid.data/./node_modules/ldflex/module/PathExpressionHandler.js","webpack://solid.data/./node_modules/ldflex/module/SubjectsHandler.js","webpack://solid.data/./node_modules/ldflex/module/ExecuteQueryHandler.js","webpack://solid.data/./node_modules/ldflex/module/MutationExpressionsHandler.js","webpack://solid.data/./node_modules/ldflex/module/InsertFunctionHandler.js","webpack://solid.data/./node_modules/ldflex/module/SetFunctionHandler.js","webpack://solid.data/./node_modules/ldflex/module/ReplaceFunctionHandler.js","webpack://solid.data/./node_modules/ldflex/module/ToArrayHandler.js","webpack://solid.data/./node_modules/ldflex/module/StringToLDflexHandler.js","webpack://solid.data/./node_modules/ldflex/module/PathProxy.js","webpack://solid.data/./node_modules/ldflex/module/JSONLDResolver.js","webpack://solid.data/./node_modules/ldflex/module/PathFactory.js","webpack://solid.data/./src/handlers/ActivityHandler.js","webpack://solid.data/./src/util.js","webpack://solid.data/./node_modules/uuid/dist/esm-browser/rng.js","webpack://solid.data/./node_modules/uuid/dist/esm-browser/bytesToUuid.js","webpack://solid.data/./node_modules/uuid/dist/esm-browser/v4.js","webpack://solid.data/./src/handlers/CreateActivityHandler.js","webpack://solid.data/./src/handlers/DeleteActivityHandler.js","webpack://solid.data/./src/resolvers/SubjectPathResolver.js","webpack://solid.data/./src/handlers/SourcePathHandler.js","webpack://solid.data/./src/handlers/UserPathHandler.js","webpack://solid.data/./src/RootPath.js","webpack://solid.data/./src/resolvers/ContextResolver.js","webpack://solid.data/./src/handlers/PutHandler.js","webpack://solid.data/./src/handlers/SolidDeleteFunctionHandler.js","webpack://solid.data/./src/handlers/FindActivityHandler.js","webpack://solid.data/./src/SolidUpdateEngine.js","webpack://solid.data/./node_modules/@ldflex/rdflib/src/index.js","webpack://solid.data/./node_modules/@ldflex/rdflib/src/RdflibQueryEngine.js","webpack://solid.data/./src/exports/rdflib.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","DataFactory","__export","solid","$rdf","ErrorCoded","Error","message","code","super","this","ERROR_CODES","Util","term","indexOf","context","separatorPos","length","charAt","prefix","substr","contextValue","id","options","isPotentialKeyword","allowPrefixNonGenDelims","isPrefixIriEndingWithGenDelim","keyword","KEYWORD_REGEX","test","prefixIri","ENDS_WITH_GEN_DELIM","iri","IRI_REGEX","IRI_REGEX_WEAK","VALID_KEYWORDS","keys","isTermProtected","startsWith","REGEX_LANGUAGE_TAG","REGEX_DIRECTION_TAG","EXPAND_KEYS_BLACKLIST","ALIAS_DOMAIN_BLACKLIST","ALIAS_RANGE_BLACKLIST","CONTAINERS","CONTAINERS_1_0","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","done","then","apply","relative_to_absolute_iri_1","ErrorCoded_1","FetchDocumentLoader_1","JsonLdContextNormalized_1","Util_1","canonicalizeJson","ContextParser","documentLoader","FetchDocumentLoader","documentCache","validateContext","skipValidation","expandContentTypeToBase","remoteContextsDepthLimit","strictRange","errorCode","JSON","stringify","strictValues","INVALID_BASE_DIRECTION","isValidKeyword","INVALID_IRI_MAPPING","contextRaw","getContextRaw","isReservedInternalKeyword","keyValue","KEYWORD_REDEFINITION","getContextValueId","INVALID_KEYWORD_ALIAS","INVALID_TERM_DEFINITION","isPrefixValue","changed","expandTerm","type","canAddIdEntry","isValidIri","newId","processingMode","normalizeLanguageTags","toLowerCase","Array","isArray","newValue","containerValue","contextBefore","contextAfter","expandOptions","isPrefix","isSimpleTermDefinitionPrefix","valueBefore","PROTECTED_TERM_REDEFINITION","valueType","INVALID_VOCAB_MAPPING","INVALID_BASE_IRI","validateLanguage","INVALID_DEFAULT_LANGUAGE","INVALID_VERSION_VALUE","validateDirection","INVALID_CONTEXT_ENTRY","INVALID_PROPAGATE_VALUE","getPrefix","CYCLIC_IRI_MAPPING","isValidIriWeak","JsonLdContextNormalized","isCompactIri","objectKey","objectValue","INVALID_TYPE_MAPPING","INVALID_REVERSE_PROPERTY","join","INVALID_CONTAINER_MAPPING","INVALID_LANGUAGE_MAPPING","INVALID_PREFIX_VALUE","INVALID_NEST_VALUE","inheritFromParent","parentContext","baseIRI","external","contextIri","assign","parse","ignoreProtection","ignoreRemoteScopedContexts","INVALID_SCOPED_CONTEXT","minimalProcessing","DEFAULT_PROCESSING_MODE","parentContextInitial","remoteContexts","CONTEXT_OVERFLOW","hasProtectedTerms","INVALID_CONTEXT_NULLIFICATION","applyBaseEntry","normalizeContextIri","overriddenLoad","getOverriddenLoad","parsedStringContext","load","contextIris","contexts","all","map","subContext","reducedContexts","reduce","accContextPromise","contextEntry","accContext","newContext","containersToHash","importContext","INVALID_IMPORT_VALUE","loadImportContext","newContextWrapped","parseInnerContexts","validateKeywordRedefinitions","defaultExpandOptions","idifyReverseTerms","expandPrefixedTerms","normalize","applyScopedProtected","validate","INVALID_LOCAL_CONTEXT","url","cached","slice","document","LOADING_REMOTE_CONTEXT_FAILED","INVALID_REMOTE_CONTEXT","RECURSIVE_CONTEXT_INCLUSION","importContextIri","allowPrefixForcing","allowVocabRelativeToBase","self","fetch","http_link_header_1","fetcher","response","headers","Headers","accept","ok","mediaType","json","has","alternateUrl","forEach","linkHeader","link","rel","uri","LOADING_DOCUMENT_FAILED","statusText","status","ContextParser_1","expandVocab","validIriMapping","vocab","vocabRelative","base","potentialKeyword","contextPrefixValue","shortestPrefixing","suffix","DefaultGraph","equals","other","termType","NamedNode","support","Blob","viewClasses","isArrayBufferView","ArrayBuffer","isView","obj","toString","normalizeName","String","TypeError","normalizeValue","iteratorFor","items","iterator","shift","undefined","append","header","getOwnPropertyNames","consumed","body","bodyUsed","fileReaderReady","reader","onload","onerror","error","readBlobAsArrayBuffer","blob","FileReader","promise","readAsArrayBuffer","bufferClone","buf","view","Uint8Array","byteLength","set","buffer","Body","_initBody","_bodyInit","_bodyText","isPrototypeOf","_bodyBlob","FormData","_bodyFormData","URLSearchParams","DataView","_bodyArrayBuffer","arrayBuffer","text","readAsText","chars","fromCharCode","readArrayBufferAsText","formData","decode","oldValue","callback","push","values","entries","methods","Request","input","method","upcased","credentials","signal","toUpperCase","referrer","form","trim","split","bytes","replace","decodeURIComponent","Response","bodyInit","clone","redirectStatuses","redirect","RangeError","location","DOMException","err","stack","constructor","init","request","aborted","xhr","XMLHttpRequest","abortXhr","abort","rawHeaders","getAllResponseHeaders","line","parts","responseURL","responseText","ontimeout","onabort","open","withCredentials","responseType","setRequestHeader","addEventListener","onreadystatechange","readyState","removeEventListener","send","polyfill","removeDotSegments","path","segmentBuffers","isCharacterAllowedAfterRelativePathSegment","pop","removeDotSegmentsOfPath","colonPosition","searchOffset","pathSeparator","character","relativeIRI","baseFragmentPos","baseQueryPos","valueColonPos","baseColonPos","baseIRIScheme","baseSlashAfterColonPos","baseIRIPath","baseIRILastSlashPos","lastIndexOf","COMPATIBLE_ENCODING_PATTERN","WS_TRIM_PATTERN","WS_CHAR_PATTERN","WS_FOLD_PATTERN","DELIMITER_PATTERN","WS_DELIMITER_PATTERN","STATE","hasWhitespace","skipWhitespace","offset","needsQuotes","Link","refs","links","attr","state","ref","end","attrValue","isSingleOccurenceAttr","parseExtendedValue","formatAttribute","isCompatibleEncoding","isTokenAttr","escapeQuotes","exec","language","encoding","formatExtendedAttribute","data","Buffer","isBuffer","encodeURIComponent","item","base64","ieee754","kMaxLength","TYPED_ARRAY_SUPPORT","createBuffer","that","__proto__","arg","encodingOrOffset","allocUnsafe","from","array","byteOffset","fromArrayLike","fromArrayBuffer","string","isEncoding","actual","write","fromString","len","checked","copy","val","fromObject","assertSize","size","loweredCase","utf8ToBytes","base64ToBytes","slowToString","start","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","b","bidirectionalIndexOf","dir","isNaN","arrayIndexOf","arr","indexSize","arrLength","valLength","read","readUInt16BE","foundIndex","found","j","hexWrite","Number","remaining","strLen","parsed","parseInt","utf8Write","blitBuffer","asciiWrite","str","byteArray","charCodeAt","asciiToBytes","latin1Write","base64Write","ucs2Write","units","hi","lo","utf16leToBytes","fromByteArray","Math","min","res","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","decodeCodePointsArray","SlowBuffer","alloc","INSPECT_MAX_BYTES","global","foo","subarray","typedArraySupport","poolSize","_augment","species","configurable","fill","allocUnsafeSlow","_isBuffer","compare","a","x","y","concat","list","pos","swap16","swap32","swap64","arguments","inspect","max","match","target","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","ret","out","toHex","checkOffset","ext","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt8","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","floor","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","limit","sub","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","INVALID_BASE64_RE","Infinity","leadSurrogate","toByteArray","stringtrim","base64clean","src","dst","g","Function","window","b64","lens","getLens","validLen","placeHoldersLen","tmp","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","len2","encodeChunk","lookup","num","output","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","abs","log","LN2","serialize","cv","ci","sort","BlankNode","Literal","Quad","Variable","namedNode","blankNode","literal","languageOrDatatype","defaultGraph","defaultGraphInstance","variable","triple","subject","predicate","quad","graph","nextId","datatype","stringDatatype","langStringDatatype","async","iterableToArray","iterable","getFirstItem","asyncIterator","DataHandler","dataProperties","_isAsync","_isFunction","function","_dataProperties","pathData","_resolveDataPath","_resolveAsyncDataPath","_resolveSyncDataPath","lazyThenable","createPromise","getThen","onResolved","onRejected","toIterablePromise","cache","memoizeIterable","finally","xsd","xsdBoolean","xsdDateTime","xsdDecimal","xsdDouble","xsdInteger","xsdBooleanTerm","xsdDateTimeTerm","xsdDecimalTerm","xsdDoubleTerm","xsdIntegerTerm","xsdTrue","xsdFalse","xsdNaN","xsdInf","xsdMinusInf","xsdPrimitives","isAsyncIterable","isPlainObject","Date","hasPlainObjectArgs","args","allowMultiple","hasPlainObject","some","valueToTerm","isInteger","toISOString","mutationType","allowZeroArgs","_mutationType","_allowZeroArgs","mutationExpressions","createMutationExpressions","extendPath","createMutationExpression","pairs","expressions","predicateObjects","arrays","conditions","pathExpression","reverse","objects","extractObjects","VARIABLE","QUERY_TAIL","hashTerm","SortHandler","order","pathProxy","properties","rest","childData","childPath","NEEDS_ESCAPE","ESCAPE_ALL","ESCAPED_CHARS","SparqlHandler","mutationExpressionToQuery","filter","Boolean","pathExpressionToQuery","finalClause","queryVar","sorts","clauses","createVar","expressionToTriplePatterns","select","distinct","where","orderClauses","scope","termToString","lastPredicate","mutations","objectStrings","triplePatterns","mutationClauses","root","lastVar","lastIndex","skolemized","skolemId","skolemize","allowValues","segment","index","suggestion","counter","label","escapeCharacter","subjectString","predicateTerm","subjectStrings","results","readProperties","wrapSingleValues","parent","_handle","settings","parsedContext","predicates","compactIri","segments","current","unshift","sparql","subjects","resultsCache","queryEngine","query","bindings","execute","extractTerm","binding","sortDesc","preload","createResultsCache","vars","resultVar","createQuery","propertyCaches","hash","propertyCache","resultData","valuePath","parentQuery","variableMatch","preloadClauses","add","previousPath","delete","newValues","termPropertyHandler","canonical","sync","syncFunction","valueOf","subjectToPrimitiveHandler","toPrimitive","toArray","termTypes","handler","_","datatypes","languages","expression","ldflex","evaluator","handle","parseFloat","termToPrimitive","EMPTY","PathProxy","handlers","resolvers","_handlers","_resolvers","rawData","proxy","Proxy","newData","createPath","resolver","supports","_context","extendContext","expandProperty","getResultsCache","expandedProperty","_settings","_data","defaultHandlers","toHandler","getOwnPropertySymbols","toResolver","_pathProxy","as","ActivityHandler","activitiesPath","requireUser","user","storage","pim$storage","URL","href","actor","activity","createResults","processResults","replaceVariables","template","terms","RegExp","asList","getRandomValues","crypto","msCrypto","rnds8","rng","byteToHex","bth","rnds","random","ii","components","SubjectPathResolver","pathFactory","source","_paths","_source","_createSubjectPath","createQueryEngine","catch","SourcePathHandler","PathFactory","UserPathHandler","getWebId","session","auth","currentSession","webId","contextResolver","JSONLDResolver","exposedContext","_exposedContext","ctx","subjectHandlers","put","contentType","urls","Set","requests","DeleteFunctionHandler","existing","findActivity","likes","dislikes","follows","createActivity","uuidv4","insert","published","executeUpdate","like","dislike","follow","deleteActivity","unlike","undislike","unfollow","SolidUpdateEngine","sources","baseEngine","getUpdateSource","_engine","clearCache","return","noop","throw","defaultSources","_defaultStore","readSources","store","v","Map","sourceList","addQuad","finish","removeListener","on","defaultSettings","rootPath","subjectPathFactory","doc","RdflibQueryEngine"],"mappings":"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","file":"solid-query-ldflex.rdflib.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 29);\n","var DataFactory = require('./lib/data-factory')\n\nmodule.exports = DataFactory\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./lib/ContextParser\"));\n__export(require(\"./lib/ErrorCoded\"));\n__export(require(\"./lib/FetchDocumentLoader\"));\n__export(require(\"./lib/JsonLdContextNormalized\"));\n__export(require(\"./lib/Util\"));\n//# sourceMappingURL=index.js.map","module.exports = solid[\"auth\"];","module.exports = $rdf;","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * An error that has a certain error code.\n *\n * The error code can be any string.\n * All standardized error codes are listed in {@link ERROR_CODES}.\n */\nclass ErrorCoded extends Error {\n    /* istanbul ignore next */\n    constructor(message, code) {\n        super(message);\n        this.code = code;\n    }\n}\nexports.ErrorCoded = ErrorCoded;\n/**\n * All standardized JSON-LD error codes.\n * @see https://w3c.github.io/json-ld-api/#dom-jsonlderrorcode\n */\n// tslint:disable:object-literal-sort-keys\nvar ERROR_CODES;\n(function (ERROR_CODES) {\n    ERROR_CODES[\"COLLIDING_KEYWORDS\"] = \"colliding keywords\";\n    ERROR_CODES[\"CONFLICTING_INDEXES\"] = \"conflicting indexes\";\n    ERROR_CODES[\"CYCLIC_IRI_MAPPING\"] = \"cyclic IRI mapping\";\n    ERROR_CODES[\"INVALID_ID_VALUE\"] = \"invalid @id value\";\n    ERROR_CODES[\"INVALID_INDEX_VALUE\"] = \"invalid @index value\";\n    ERROR_CODES[\"INVALID_NEST_VALUE\"] = \"invalid @nest value\";\n    ERROR_CODES[\"INVALID_PREFIX_VALUE\"] = \"invalid @prefix value\";\n    ERROR_CODES[\"INVALID_PROPAGATE_VALUE\"] = \"invalid @propagate value\";\n    ERROR_CODES[\"INVALID_REVERSE_VALUE\"] = \"invalid @reverse value\";\n    ERROR_CODES[\"INVALID_IMPORT_VALUE\"] = \"invalid @import value\";\n    ERROR_CODES[\"INVALID_VERSION_VALUE\"] = \"invalid @version value\";\n    ERROR_CODES[\"INVALID_BASE_IRI\"] = \"invalid base IRI\";\n    ERROR_CODES[\"INVALID_CONTAINER_MAPPING\"] = \"invalid container mapping\";\n    ERROR_CODES[\"INVALID_CONTEXT_ENTRY\"] = \"invalid context entry\";\n    ERROR_CODES[\"INVALID_CONTEXT_NULLIFICATION\"] = \"invalid context nullification\";\n    ERROR_CODES[\"INVALID_DEFAULT_LANGUAGE\"] = \"invalid default language\";\n    ERROR_CODES[\"INVALID_INCLUDED_VALUE\"] = \"invalid @included value\";\n    ERROR_CODES[\"INVALID_IRI_MAPPING\"] = \"invalid IRI mapping\";\n    ERROR_CODES[\"INVALID_JSON_LITERAL\"] = \"invalid JSON literal\";\n    ERROR_CODES[\"INVALID_KEYWORD_ALIAS\"] = \"invalid keyword alias\";\n    ERROR_CODES[\"INVALID_LANGUAGE_MAP_VALUE\"] = \"invalid language map value\";\n    ERROR_CODES[\"INVALID_LANGUAGE_MAPPING\"] = \"invalid language mapping\";\n    ERROR_CODES[\"INVALID_LANGUAGE_TAGGED_STRING\"] = \"invalid language-tagged string\";\n    ERROR_CODES[\"INVALID_LANGUAGE_TAGGED_VALUE\"] = \"invalid language-tagged value\";\n    ERROR_CODES[\"INVALID_LOCAL_CONTEXT\"] = \"invalid local context\";\n    ERROR_CODES[\"INVALID_REMOTE_CONTEXT\"] = \"invalid remote context\";\n    ERROR_CODES[\"INVALID_REVERSE_PROPERTY\"] = \"invalid reverse property\";\n    ERROR_CODES[\"INVALID_REVERSE_PROPERTY_MAP\"] = \"invalid reverse property map\";\n    ERROR_CODES[\"INVALID_REVERSE_PROPERTY_VALUE\"] = \"invalid reverse property value\";\n    ERROR_CODES[\"INVALID_SCOPED_CONTEXT\"] = \"invalid scoped context\";\n    ERROR_CODES[\"INVALID_SCRIPT_ELEMENT\"] = \"invalid script element\";\n    ERROR_CODES[\"INVALID_SET_OR_LIST_OBJECT\"] = \"invalid set or list object\";\n    ERROR_CODES[\"INVALID_TERM_DEFINITION\"] = \"invalid term definition\";\n    ERROR_CODES[\"INVALID_TYPE_MAPPING\"] = \"invalid type mapping\";\n    ERROR_CODES[\"INVALID_TYPE_VALUE\"] = \"invalid type value\";\n    ERROR_CODES[\"INVALID_TYPED_VALUE\"] = \"invalid typed value\";\n    ERROR_CODES[\"INVALID_VALUE_OBJECT\"] = \"invalid value object\";\n    ERROR_CODES[\"INVALID_VALUE_OBJECT_VALUE\"] = \"invalid value object value\";\n    ERROR_CODES[\"INVALID_VOCAB_MAPPING\"] = \"invalid vocab mapping\";\n    ERROR_CODES[\"IRI_CONFUSED_WITH_PREFIX\"] = \"IRI confused with prefix\";\n    ERROR_CODES[\"KEYWORD_REDEFINITION\"] = \"keyword redefinition\";\n    ERROR_CODES[\"LOADING_DOCUMENT_FAILED\"] = \"loading document failed\";\n    ERROR_CODES[\"LOADING_REMOTE_CONTEXT_FAILED\"] = \"loading remote context failed\";\n    ERROR_CODES[\"MULTIPLE_CONTEXT_LINK_HEADERS\"] = \"multiple context link headers\";\n    ERROR_CODES[\"PROCESSING_MODE_CONFLICT\"] = \"processing mode conflict\";\n    ERROR_CODES[\"PROTECTED_TERM_REDEFINITION\"] = \"protected term redefinition\";\n    ERROR_CODES[\"CONTEXT_OVERFLOW\"] = \"context overflow\";\n    ERROR_CODES[\"INVALID_BASE_DIRECTION\"] = \"invalid base direction\";\n    ERROR_CODES[\"RECURSIVE_CONTEXT_INCLUSION\"] = \"recursive context inclusion\";\n    ERROR_CODES[\"INVALID_STREAMING_KEY_ORDER\"] = \"invalid streaming key order\";\n})(ERROR_CODES = exports.ERROR_CODES || (exports.ERROR_CODES = {}));\n//# sourceMappingURL=ErrorCoded.js.map","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./lib/Resolve\"));\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass Util {\n    /**\n     * Check if the given term is a valid compact IRI.\n     * Otherwise, it may be an IRI.\n     * @param {string} term A term.\n     * @return {boolean} If it is a compact IRI.\n     */\n    static isCompactIri(term) {\n        return term.indexOf(':') > 0 && !(term && term[0] === '#');\n    }\n    /**\n     * Get the prefix from the given term.\n     * @see https://json-ld.org/spec/latest/json-ld/#compact-iris\n     * @param {string} term A term that is an URL or a prefixed URL.\n     * @param {IJsonLdContextNormalizedRaw} context A context.\n     * @return {string} The prefix or null.\n     */\n    static getPrefix(term, context) {\n        // Do not consider relative IRIs starting with a hash as compact IRIs\n        if (term && term[0] === '#') {\n            return null;\n        }\n        const separatorPos = term.indexOf(':');\n        if (separatorPos >= 0) {\n            // Suffix can not begin with two slashes\n            if (term.length > separatorPos + 1\n                && term.charAt(separatorPos + 1) === '/'\n                && term.charAt(separatorPos + 2) === '/') {\n                return null;\n            }\n            const prefix = term.substr(0, separatorPos);\n            // Prefix can not be an underscore (this is a blank node)\n            if (prefix === '_') {\n                return null;\n            }\n            // Prefix must match a term in the active context\n            if (context[prefix]) {\n                return prefix;\n            }\n        }\n        return null;\n    }\n    /**\n     * From a given context entry value, get the string value, or the @id field.\n     * @param contextValue A value for a term in a context.\n     * @return {string} The id value, or null.\n     */\n    static getContextValueId(contextValue) {\n        if (contextValue === null || typeof contextValue === 'string') {\n            return contextValue;\n        }\n        const id = contextValue['@id'];\n        return id ? id : null;\n    }\n    /**\n     * Check if the given simple term definition (string-based value of a context term)\n     * should be considered a prefix.\n     * @param value A simple term definition value.\n     * @param options Options that define the way how expansion must be done.\n     */\n    static isSimpleTermDefinitionPrefix(value, options) {\n        return !Util.isPotentialKeyword(value)\n            && (value[0] === '_' || options.allowPrefixNonGenDelims || Util.isPrefixIriEndingWithGenDelim(value));\n    }\n    /**\n     * Check if the given keyword is of the keyword format \"@\"1*ALPHA.\n     * @param {string} keyword A potential keyword.\n     * @return {boolean} If the given keyword is of the keyword format.\n     */\n    static isPotentialKeyword(keyword) {\n        return typeof keyword === 'string' && Util.KEYWORD_REGEX.test(keyword);\n    }\n    /**\n     * Check if the given prefix ends with a gen-delim character.\n     * @param {string} prefixIri A prefix IRI.\n     * @return {boolean} If the given prefix IRI is valid.\n     */\n    static isPrefixIriEndingWithGenDelim(prefixIri) {\n        return Util.ENDS_WITH_GEN_DELIM.test(prefixIri);\n    }\n    /**\n     * Check if the given context value can be a prefix value.\n     * @param value A context value.\n     * @return {boolean} If it can be a prefix value.\n     */\n    static isPrefixValue(value) {\n        return value && (typeof value === 'string' || (value && typeof value === 'object'));\n    }\n    /**\n     * Check if the given IRI is valid.\n     * @param {string} iri A potential IRI.\n     * @return {boolean} If the given IRI is valid.\n     */\n    static isValidIri(iri) {\n        return Util.IRI_REGEX.test(iri);\n    }\n    /**\n     * Check if the given IRI is valid, this includes the possibility of being a relative IRI.\n     * @param {string} iri A potential IRI.\n     * @return {boolean} If the given IRI is valid.\n     */\n    static isValidIriWeak(iri) {\n        return !!iri && iri[0] !== ':' && Util.IRI_REGEX_WEAK.test(iri);\n    }\n    /**\n     * Check if the given keyword is a defined according to the JSON-LD specification.\n     * @param {string} keyword A potential keyword.\n     * @return {boolean} If the given keyword is valid.\n     */\n    static isValidKeyword(keyword) {\n        return Util.VALID_KEYWORDS[keyword];\n    }\n    /**\n     * Check if the given term is protected in the context.\n     * @param {IJsonLdContextNormalizedRaw} context A context.\n     * @param {string} key A context term.\n     * @return {boolean} If the given term has an @protected flag.\n     */\n    static isTermProtected(context, key) {\n        const value = context[key];\n        return !(typeof value === 'string') && value && value['@protected'];\n    }\n    /**\n     * Check if the given context has at least one protected term.\n     * @param context A context.\n     * @return If the context has a protected term.\n     */\n    static hasProtectedTerms(context) {\n        for (const key of Object.keys(context)) {\n            if (Util.isTermProtected(context, key)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    /**\n     * Check if the given key is an internal reserved keyword.\n     * @param key A context key.\n     */\n    static isReservedInternalKeyword(key) {\n        return key.startsWith('@__');\n    }\n}\n// Regex for valid IRIs\nUtil.IRI_REGEX = /^([A-Za-z][A-Za-z0-9+-.]*|_):[^ \"<>{}|\\\\\\[\\]`#]*(#[^#]*)?$/;\n// Weaker regex for valid IRIs, this includes relative IRIs\nUtil.IRI_REGEX_WEAK = /(?::[^:])|\\//;\n// Regex for keyword form\nUtil.KEYWORD_REGEX = /^@[a-z]+$/i;\n// Regex to see if an IRI ends with a gen-delim character (see RFC 3986)\nUtil.ENDS_WITH_GEN_DELIM = /[:/?#\\[\\]@]$/;\n// Regex for language tags\nUtil.REGEX_LANGUAGE_TAG = /^[a-zA-Z]+(-[a-zA-Z0-9]+)*$/;\n// Regex for base directions\nUtil.REGEX_DIRECTION_TAG = /^(ltr)|(rtl)$/;\n// All known valid JSON-LD keywords\n// @see https://www.w3.org/TR/json-ld11/#keywords\nUtil.VALID_KEYWORDS = {\n    '@base': true,\n    '@container': true,\n    '@context': true,\n    '@direction': true,\n    '@graph': true,\n    '@id': true,\n    '@import': true,\n    '@included': true,\n    '@index': true,\n    '@json': true,\n    '@language': true,\n    '@list': true,\n    '@nest': true,\n    '@none': true,\n    '@prefix': true,\n    '@propagate': true,\n    '@protected': true,\n    '@reverse': true,\n    '@set': true,\n    '@type': true,\n    '@value': true,\n    '@version': true,\n    '@vocab': true,\n};\n// Keys in the contexts that will not be expanded based on the base IRI\nUtil.EXPAND_KEYS_BLACKLIST = [\n    '@base',\n    '@vocab',\n    '@language',\n    '@version',\n    '@direction',\n];\n// Keys in the contexts that may not be aliased from\nUtil.ALIAS_DOMAIN_BLACKLIST = [\n    '@container',\n    '@graph',\n    '@id',\n    '@index',\n    '@list',\n    '@nest',\n    '@none',\n    '@prefix',\n    '@reverse',\n    '@set',\n    '@type',\n    '@value',\n    '@version',\n];\n// Keys in the contexts that may not be aliased to\nUtil.ALIAS_RANGE_BLACKLIST = [\n    '@context',\n    '@preserve',\n];\n// All valid @container values\nUtil.CONTAINERS = [\n    '@list',\n    '@set',\n    '@index',\n    '@language',\n    '@graph',\n    '@id',\n    '@type',\n];\n// All valid @container values under processing mode 1.0\nUtil.CONTAINERS_1_0 = [\n    '@list',\n    '@set',\n    '@index',\n];\nexports.Util = Util;\n//# sourceMappingURL=Util.js.map","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"isomorphic-fetch\");\nconst relative_to_absolute_iri_1 = require(\"relative-to-absolute-iri\");\nconst ErrorCoded_1 = require(\"./ErrorCoded\");\nconst FetchDocumentLoader_1 = require(\"./FetchDocumentLoader\");\nconst JsonLdContextNormalized_1 = require(\"./JsonLdContextNormalized\");\nconst Util_1 = require(\"./Util\");\n// tslint:disable-next-line:no-var-requires\nconst canonicalizeJson = require('canonicalize');\n/**\n * Parses JSON-LD contexts.\n */\nclass ContextParser {\n    constructor(options) {\n        options = options || {};\n        this.documentLoader = options.documentLoader || new FetchDocumentLoader_1.FetchDocumentLoader();\n        this.documentCache = {};\n        this.validateContext = !options.skipValidation;\n        this.expandContentTypeToBase = !!options.expandContentTypeToBase;\n        this.remoteContextsDepthLimit = options.remoteContextsDepthLimit || 32;\n    }\n    /**\n     * Validate the given @language value.\n     * An error will be thrown if it is invalid.\n     * @param value An @language value.\n     * @param {boolean} strictRange If the string value should be strictly checked against a regex.\n     * @param {string} errorCode The error code to emit on errors.\n     * @return {boolean} If validation passed.\n     *                   Can only be false if strictRange is false and the string value did not pass the regex.\n     */\n    static validateLanguage(value, strictRange, errorCode) {\n        if (typeof value !== 'string') {\n            throw new ErrorCoded_1.ErrorCoded(`The value of an '@language' must be a string, got '${JSON.stringify(value)}'`, errorCode);\n        }\n        if (!Util_1.Util.REGEX_LANGUAGE_TAG.test(value)) {\n            if (strictRange) {\n                throw new ErrorCoded_1.ErrorCoded(`The value of an '@language' must be a valid language tag, got '${JSON.stringify(value)}'`, errorCode);\n            }\n            else {\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * Validate the given @direction value.\n     * An error will be thrown if it is invalid.\n     * @param value An @direction value.\n     * @param {boolean} strictValues If the string value should be strictly checked against a regex.\n     * @return {boolean} If validation passed.\n     *                   Can only be false if strictRange is false and the string value did not pass the regex.\n     */\n    static validateDirection(value, strictValues) {\n        if (typeof value !== 'string') {\n            throw new ErrorCoded_1.ErrorCoded(`The value of an '@direction' must be a string, got '${JSON.stringify(value)}'`, ErrorCoded_1.ERROR_CODES.INVALID_BASE_DIRECTION);\n        }\n        if (!Util_1.Util.REGEX_DIRECTION_TAG.test(value)) {\n            if (strictValues) {\n                throw new ErrorCoded_1.ErrorCoded(`The value of an '@direction' must be 'ltr' or 'rtl', got '${JSON.stringify(value)}'`, ErrorCoded_1.ERROR_CODES.INVALID_BASE_DIRECTION);\n            }\n            else {\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * Add an @id term for all @reverse terms.\n     * @param {IJsonLdContextNormalizedRaw} context A context.\n     * @return {IJsonLdContextNormalizedRaw} The mutated input context.\n     */\n    idifyReverseTerms(context) {\n        for (const key of Object.keys(context)) {\n            const value = context[key];\n            if (value && typeof value === 'object') {\n                if (value['@reverse'] && !value['@id']) {\n                    if (typeof value['@reverse'] !== 'string' || Util_1.Util.isValidKeyword(value['@reverse'])) {\n                        throw new ErrorCoded_1.ErrorCoded(`Invalid @reverse value, must be absolute IRI or blank node: '${value['@reverse']}'`, ErrorCoded_1.ERROR_CODES.INVALID_IRI_MAPPING);\n                    }\n                    value['@id'] = value['@reverse'];\n                    if (Util_1.Util.isPotentialKeyword(value['@reverse'])) {\n                        delete value['@reverse'];\n                    }\n                    else {\n                        value['@reverse'] = true;\n                    }\n                }\n            }\n        }\n        return context;\n    }\n    /**\n     * Expand all prefixed terms in the given context.\n     * @param {IJsonLdContextNormalizedRaw} context A context.\n     * @param {boolean} expandContentTypeToBase If @type inside the context may be expanded\n     *                                          via @base if @vocab is set to null.\n     */\n    expandPrefixedTerms(context, expandContentTypeToBase) {\n        const contextRaw = context.getContextRaw();\n        for (const key of Object.keys(contextRaw)) {\n            // Only expand allowed keys\n            if (Util_1.Util.EXPAND_KEYS_BLACKLIST.indexOf(key) < 0 && !Util_1.Util.isReservedInternalKeyword(key)) {\n                // Error if we try to alias a keyword to something else.\n                const keyValue = contextRaw[key];\n                if (Util_1.Util.isPotentialKeyword(key) && Util_1.Util.ALIAS_DOMAIN_BLACKLIST.indexOf(key) >= 0) {\n                    if (key !== '@type' || typeof contextRaw[key] === 'object'\n                        && !(contextRaw[key]['@protected'] || contextRaw[key]['@container'] === '@set')) {\n                        throw new ErrorCoded_1.ErrorCoded(`Keywords can not be aliased to something else.\nTried mapping ${key} to ${JSON.stringify(keyValue)}`, ErrorCoded_1.ERROR_CODES.KEYWORD_REDEFINITION);\n                    }\n                }\n                // Error if we try to alias to an illegal keyword\n                if (Util_1.Util.ALIAS_RANGE_BLACKLIST.indexOf(Util_1.Util.getContextValueId(keyValue)) >= 0) {\n                    throw new ErrorCoded_1.ErrorCoded(`Aliasing to certain keywords is not allowed.\nTried mapping ${key} to ${JSON.stringify(keyValue)}`, ErrorCoded_1.ERROR_CODES.INVALID_KEYWORD_ALIAS);\n                }\n                // Error if this term was marked as prefix as well\n                if (keyValue && Util_1.Util.isPotentialKeyword(Util_1.Util.getContextValueId(keyValue))\n                    && keyValue['@prefix'] === true) {\n                    throw new ErrorCoded_1.ErrorCoded(`Tried to use keyword aliases as prefix: '${key}': '${JSON.stringify(keyValue)}'`, ErrorCoded_1.ERROR_CODES.INVALID_TERM_DEFINITION);\n                }\n                // Loop because prefixes might be nested\n                while (Util_1.Util.isPrefixValue(contextRaw[key])) {\n                    const value = contextRaw[key];\n                    let changed = false;\n                    if (typeof value === 'string') {\n                        contextRaw[key] = context.expandTerm(value, true);\n                        changed = changed || value !== contextRaw[key];\n                    }\n                    else {\n                        const id = value['@id'];\n                        const type = value['@type'];\n                        // If @id is missing, don't allow @id to be added if @prefix: true and key not being a valid IRI.\n                        const canAddIdEntry = !('@prefix' in value) || Util_1.Util.isValidIri(key);\n                        if ('@id' in value) {\n                            // Use @id value for expansion\n                            if (id !== undefined && id !== null && typeof id === 'string') {\n                                contextRaw[key]['@id'] = context.expandTerm(id, true);\n                                changed = changed || id !== contextRaw[key]['@id'];\n                            }\n                        }\n                        else if (!Util_1.Util.isPotentialKeyword(key) && canAddIdEntry) {\n                            // Add an explicit @id value based on the expanded key value\n                            const newId = context.expandTerm(key, true);\n                            if (newId !== key) {\n                                // Don't set @id if expansion failed\n                                contextRaw[key]['@id'] = newId;\n                                changed = true;\n                            }\n                        }\n                        if (type && typeof type === 'string' && type !== '@vocab'\n                            && (!value['@container'] || !value['@container']['@type'])\n                            && canAddIdEntry) {\n                            // First check @vocab, then fallback to @base\n                            contextRaw[key]['@type'] = context.expandTerm(type, true);\n                            if (expandContentTypeToBase && type === contextRaw[key]['@type']) {\n                                contextRaw[key]['@type'] = context.expandTerm(type, false);\n                            }\n                            changed = changed || type !== contextRaw[key]['@type'];\n                        }\n                    }\n                    if (!changed) {\n                        break;\n                    }\n                }\n            }\n        }\n    }\n    /**\n     * Normalize the @language entries in the given context to lowercase.\n     * @param {IJsonLdContextNormalizedRaw} context A context.\n     * @param {IParseOptions} parseOptions The parsing options.\n     */\n    normalize(context, { processingMode, normalizeLanguageTags }) {\n        // Lowercase language keys in 1.0\n        if (normalizeLanguageTags || processingMode === 1.0) {\n            for (const key of Object.keys(context)) {\n                if (key === '@language' && typeof context[key] === 'string') {\n                    context[key] = context[key].toLowerCase();\n                }\n                else {\n                    const value = context[key];\n                    if (value && typeof value === 'object') {\n                        if (typeof value['@language'] === 'string') {\n                            value['@language'] = value['@language'].toLowerCase();\n                        }\n                    }\n                }\n            }\n        }\n    }\n    /**\n     * Convert all @container strings and array values to hash-based values.\n     * @param {IJsonLdContextNormalizedRaw} context A context.\n     */\n    containersToHash(context) {\n        for (const key of Object.keys(context)) {\n            const value = context[key];\n            if (value && typeof value === 'object') {\n                if (typeof value['@container'] === 'string') {\n                    value['@container'] = { [value['@container']]: true };\n                }\n                else if (Array.isArray(value['@container'])) {\n                    const newValue = {};\n                    for (const containerValue of value['@container']) {\n                        newValue[containerValue] = true;\n                    }\n                    value['@container'] = newValue;\n                }\n            }\n        }\n    }\n    /**\n     * Normalize and apply context-levevl @protected terms onto each term separately.\n     * @param {IJsonLdContextNormalizedRaw} context A context.\n     * @param {number} processingMode The processing mode.\n     */\n    applyScopedProtected(context, { processingMode }) {\n        if (processingMode && processingMode >= 1.1) {\n            if (context['@protected']) {\n                for (const key of Object.keys(context)) {\n                    if (Util_1.Util.isReservedInternalKeyword(key)) {\n                        continue;\n                    }\n                    if (!Util_1.Util.isPotentialKeyword(key) && !Util_1.Util.isTermProtected(context, key)) {\n                        const value = context[key];\n                        if (value && typeof value === 'object') {\n                            if (!('@protected' in context[key])) {\n                                // Mark terms with object values as protected if they don't have an @protected: false annotation\n                                context[key]['@protected'] = true;\n                            }\n                        }\n                        else {\n                            // Convert string-based term values to object-based values with @protected: true\n                            context[key] = {\n                                '@id': value,\n                                '@protected': true,\n                            };\n                        }\n                    }\n                }\n                delete context['@protected'];\n            }\n        }\n    }\n    /**\n     * Check if the given context inheritance does not contain any overrides of protected terms.\n     * @param {IJsonLdContextNormalizedRaw} contextBefore The context that may contain some protected terms.\n     * @param {IJsonLdContextNormalizedRaw} contextAfter A new context that is being applied on the first one.\n     * @param {IExpandOptions} expandOptions Options that are needed for any expansions during this validation.\n     */\n    validateKeywordRedefinitions(contextBefore, contextAfter, expandOptions) {\n        for (const key of Object.keys(contextAfter)) {\n            if (Util_1.Util.isTermProtected(contextBefore, key)) {\n                // The entry in the context before will always be in object-mode\n                // If the new entry is in string-mode, convert it to object-mode\n                // before checking if it is identical.\n                if (typeof contextAfter[key] === 'string') {\n                    const isPrefix = Util_1.Util.isSimpleTermDefinitionPrefix(contextAfter[key], expandOptions);\n                    contextAfter[key] = { '@id': contextAfter[key] };\n                    // If the simple term def was a prefix, explicitly mark the term as a prefix in the expanded term definition,\n                    // because otherwise we loose this information due to JSON-LD interpreting prefixes differently\n                    // in simple vs expanded term definitions.\n                    if (isPrefix) {\n                        contextAfter[key]['@prefix'] = true;\n                        contextBefore[key]['@prefix'] = true; // Also on before, to make sure the next step still considers them ==\n                    }\n                }\n                // Convert term values to strings for each comparison\n                const valueBefore = canonicalizeJson(contextBefore[key]);\n                // We modify this deliberately,\n                // as we need it for the value comparison (they must be identical modulo '@protected')),\n                // and for the fact that this new value will override the first one.\n                contextAfter[key]['@protected'] = true;\n                const valueAfter = canonicalizeJson(contextAfter[key]);\n                // Error if they are not identical\n                if (valueBefore !== valueAfter) {\n                    throw new ErrorCoded_1.ErrorCoded(`Attempted to override the protected keyword ${key} from ${JSON.stringify(Util_1.Util.getContextValueId(contextBefore[key]))} to ${JSON.stringify(Util_1.Util.getContextValueId(contextAfter[key]))}`, ErrorCoded_1.ERROR_CODES.PROTECTED_TERM_REDEFINITION);\n                }\n            }\n        }\n    }\n    /**\n     * Validate the entries of the given context.\n     * @param {IJsonLdContextNormalizedRaw} context A context.\n     * @param {IParseOptions} options The parse options.\n     */\n    validate(context, { processingMode }) {\n        for (const key of Object.keys(context)) {\n            // Ignore reserved internal keywords.\n            if (Util_1.Util.isReservedInternalKeyword(key)) {\n                continue;\n            }\n            // Do not allow empty term\n            if (key === '') {\n                throw new ErrorCoded_1.ErrorCoded(`The empty term is not allowed, got: '${key}': '${JSON.stringify(context[key])}'`, ErrorCoded_1.ERROR_CODES.INVALID_TERM_DEFINITION);\n            }\n            const value = context[key];\n            const valueType = typeof value;\n            // First check if the key is a keyword\n            if (Util_1.Util.isPotentialKeyword(key)) {\n                switch (key.substr(1)) {\n                    case 'vocab':\n                        if (value !== null && valueType !== 'string') {\n                            throw new ErrorCoded_1.ErrorCoded(`Found an invalid @vocab IRI: ${value}`, ErrorCoded_1.ERROR_CODES.INVALID_VOCAB_MAPPING);\n                        }\n                        break;\n                    case 'base':\n                        if (value !== null && valueType !== 'string') {\n                            throw new ErrorCoded_1.ErrorCoded(`Found an invalid @base IRI: ${context[key]}`, ErrorCoded_1.ERROR_CODES.INVALID_BASE_IRI);\n                        }\n                        break;\n                    case 'language':\n                        if (value !== null) {\n                            ContextParser.validateLanguage(value, true, ErrorCoded_1.ERROR_CODES.INVALID_DEFAULT_LANGUAGE);\n                        }\n                        break;\n                    case 'version':\n                        if (value !== null && valueType !== 'number') {\n                            throw new ErrorCoded_1.ErrorCoded(`Found an invalid @version number: ${value}`, ErrorCoded_1.ERROR_CODES.INVALID_VERSION_VALUE);\n                        }\n                        break;\n                    case 'direction':\n                        if (value !== null) {\n                            ContextParser.validateDirection(value, true);\n                        }\n                        break;\n                    case 'propagate':\n                        if (processingMode === 1.0) {\n                            throw new ErrorCoded_1.ErrorCoded(`Found an illegal @propagate keyword: ${value}`, ErrorCoded_1.ERROR_CODES.INVALID_CONTEXT_ENTRY);\n                        }\n                        if (value !== null && valueType !== 'boolean') {\n                            throw new ErrorCoded_1.ErrorCoded(`Found an invalid @propagate value: ${value}`, ErrorCoded_1.ERROR_CODES.INVALID_PROPAGATE_VALUE);\n                        }\n                        break;\n                }\n                // Don't allow keywords to be overridden\n                if (Util_1.Util.isValidKeyword(key) && Util_1.Util.isValidKeyword(Util_1.Util.getContextValueId(value))) {\n                    throw new ErrorCoded_1.ErrorCoded(`Illegal keyword alias in term value, found: '${key}': '${Util_1.Util\n                        .getContextValueId(value)}'`, ErrorCoded_1.ERROR_CODES.KEYWORD_REDEFINITION);\n                }\n                continue;\n            }\n            // Otherwise, consider the key a term\n            if (value !== null) {\n                switch (valueType) {\n                    case 'string':\n                        if (Util_1.Util.getPrefix(value, context) === key) {\n                            throw new ErrorCoded_1.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${key}': '${JSON\n                                .stringify(value)}'`, ErrorCoded_1.ERROR_CODES.CYCLIC_IRI_MAPPING);\n                        }\n                        if (Util_1.Util.isValidIriWeak(key)) {\n                            if (value === '@type') {\n                                throw new ErrorCoded_1.ErrorCoded(`IRIs can not be mapped to @type, found: '${key}': '${value}'`, ErrorCoded_1.ERROR_CODES.INVALID_IRI_MAPPING);\n                            }\n                            else if (Util_1.Util.isValidIri(value) && value !== new JsonLdContextNormalized_1.JsonLdContextNormalized(context).expandTerm(key)) {\n                                throw new ErrorCoded_1.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${key}': '${value}'`, ErrorCoded_1.ERROR_CODES.INVALID_IRI_MAPPING);\n                            }\n                        }\n                        break;\n                    case 'object':\n                        if (!Util_1.Util.isCompactIri(key) && !('@id' in value)\n                            && (value['@type'] === '@id' ? !context['@base'] : !context['@vocab'])) {\n                            throw new ErrorCoded_1.ErrorCoded(`Missing @id in context entry: '${key}': '${JSON.stringify(value)}'`, ErrorCoded_1.ERROR_CODES.INVALID_IRI_MAPPING);\n                        }\n                        for (const objectKey of Object.keys(value)) {\n                            const objectValue = value[objectKey];\n                            if (!objectValue) {\n                                continue;\n                            }\n                            switch (objectKey) {\n                                case '@id':\n                                    if (Util_1.Util.isValidKeyword(objectValue)\n                                        && objectValue !== '@type' && objectValue !== '@id' && objectValue !== '@graph') {\n                                        throw new ErrorCoded_1.ErrorCoded(`Illegal keyword alias in term value, found: '${key}': '${JSON.stringify(value)}'`, ErrorCoded_1.ERROR_CODES.INVALID_IRI_MAPPING);\n                                    }\n                                    if (Util_1.Util.isValidIriWeak(key)) {\n                                        if (objectValue === '@type') {\n                                            throw new ErrorCoded_1.ErrorCoded(`IRIs can not be mapped to @type, found: '${key}': '${JSON.stringify(value)}'`, ErrorCoded_1.ERROR_CODES.INVALID_IRI_MAPPING);\n                                        }\n                                        else if (Util_1.Util.isValidIri(objectValue)\n                                            && objectValue !== new JsonLdContextNormalized_1.JsonLdContextNormalized(context).expandTerm(key)) {\n                                            throw new ErrorCoded_1.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${key}': '${JSON.stringify(value)}'`, ErrorCoded_1.ERROR_CODES.INVALID_IRI_MAPPING);\n                                        }\n                                    }\n                                    if (typeof objectValue !== 'string') {\n                                        throw new ErrorCoded_1.ErrorCoded(`Detected non-string @id in context entry: '${key}': '${JSON.stringify(value)}'`, ErrorCoded_1.ERROR_CODES.INVALID_IRI_MAPPING);\n                                    }\n                                    if (Util_1.Util.getPrefix(objectValue, context) === key) {\n                                        throw new ErrorCoded_1.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${key}': '${JSON\n                                            .stringify(value)}'`, ErrorCoded_1.ERROR_CODES.CYCLIC_IRI_MAPPING);\n                                    }\n                                    break;\n                                case '@type':\n                                    if (value['@container'] === '@type' && objectValue !== '@id' && objectValue !== '@vocab') {\n                                        throw new ErrorCoded_1.ErrorCoded(`@container: @type only allows @type: @id or @vocab, but got: '${key}': '${objectValue}'`, ErrorCoded_1.ERROR_CODES.INVALID_TYPE_MAPPING);\n                                    }\n                                    if (typeof objectValue !== 'string') {\n                                        throw new ErrorCoded_1.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(valueType)}'`, ErrorCoded_1.ERROR_CODES.INVALID_TYPE_MAPPING);\n                                    }\n                                    if (objectValue !== '@id' && objectValue !== '@vocab'\n                                        && (processingMode === 1.0 || objectValue !== '@json')\n                                        && (processingMode === 1.0 || objectValue !== '@none')\n                                        && (objectValue[0] === '_' || !Util_1.Util.isValidIri(objectValue))) {\n                                        throw new ErrorCoded_1.ErrorCoded(`A context @type must be an absolute IRI, found: '${key}': '${objectValue}'`, ErrorCoded_1.ERROR_CODES.INVALID_TYPE_MAPPING);\n                                    }\n                                    break;\n                                case '@reverse':\n                                    if (typeof objectValue === 'string' && value['@id'] && value['@id'] !== objectValue) {\n                                        throw new ErrorCoded_1.ErrorCoded(`Found non-matching @id and @reverse term values in '${key}':\\\n'${objectValue}' and '${value['@id']}'`, ErrorCoded_1.ERROR_CODES.INVALID_REVERSE_PROPERTY);\n                                    }\n                                    if ('@nest' in value) {\n                                        throw new ErrorCoded_1.ErrorCoded(`@nest is not allowed in the reverse property '${key}'`, ErrorCoded_1.ERROR_CODES.INVALID_REVERSE_PROPERTY);\n                                    }\n                                    break;\n                                case '@container':\n                                    if (processingMode === 1.0) {\n                                        if (Object.keys(objectValue).length > 1\n                                            || Util_1.Util.CONTAINERS_1_0.indexOf(Object.keys(objectValue)[0]) < 0) {\n                                            throw new ErrorCoded_1.ErrorCoded(`Invalid term @container for '${key}' ('${Object.keys(objectValue)}') in 1.0, \\\nmust be only one of ${Util_1.Util.CONTAINERS_1_0.join(', ')}`, ErrorCoded_1.ERROR_CODES.INVALID_CONTAINER_MAPPING);\n                                        }\n                                    }\n                                    for (const containerValue of Object.keys(objectValue)) {\n                                        if (containerValue === '@list' && value['@reverse']) {\n                                            throw new ErrorCoded_1.ErrorCoded(`Term value can not be @container: @list and @reverse at the same time on '${key}'`, ErrorCoded_1.ERROR_CODES.INVALID_REVERSE_PROPERTY);\n                                        }\n                                        if (Util_1.Util.CONTAINERS.indexOf(containerValue) < 0) {\n                                            throw new ErrorCoded_1.ErrorCoded(`Invalid term @container for '${key}' ('${containerValue}'), \\\nmust be one of ${Util_1.Util.CONTAINERS.join(', ')}`, ErrorCoded_1.ERROR_CODES.INVALID_CONTAINER_MAPPING);\n                                        }\n                                    }\n                                    break;\n                                case '@language':\n                                    ContextParser.validateLanguage(objectValue, true, ErrorCoded_1.ERROR_CODES.INVALID_LANGUAGE_MAPPING);\n                                    break;\n                                case '@direction':\n                                    ContextParser.validateDirection(objectValue, true);\n                                    break;\n                                case '@prefix':\n                                    if (objectValue !== null && typeof objectValue !== 'boolean') {\n                                        throw new ErrorCoded_1.ErrorCoded(`Found an invalid term @prefix boolean in: '${key}': '${JSON.stringify(value)}'`, ErrorCoded_1.ERROR_CODES.INVALID_PREFIX_VALUE);\n                                    }\n                                    if (!('@id' in value) && !Util_1.Util.isValidIri(key)) {\n                                        throw new ErrorCoded_1.ErrorCoded(`Invalid @prefix definition for '${key}' ('${JSON.stringify(value)}'`, ErrorCoded_1.ERROR_CODES.INVALID_TERM_DEFINITION);\n                                    }\n                                    break;\n                                case '@index':\n                                    if (processingMode === 1.0 || !value['@container'] || !value['@container']['@index']) {\n                                        throw new ErrorCoded_1.ErrorCoded(`Attempt to add illegal key to value object: '${key}': '${JSON.stringify(value)}'`, ErrorCoded_1.ERROR_CODES.INVALID_TERM_DEFINITION);\n                                    }\n                                    break;\n                                case '@nest':\n                                    if (Util_1.Util.isPotentialKeyword(objectValue) && objectValue !== '@nest') {\n                                        throw new ErrorCoded_1.ErrorCoded(`Found an invalid term @nest value in: '${key}': '${JSON.stringify(value)}'`, ErrorCoded_1.ERROR_CODES.INVALID_NEST_VALUE);\n                                    }\n                            }\n                        }\n                        break;\n                    default:\n                        throw new ErrorCoded_1.ErrorCoded(`Found an invalid term value: '${key}': '${value}'`, ErrorCoded_1.ERROR_CODES.INVALID_TERM_DEFINITION);\n                }\n            }\n        }\n    }\n    /**\n     * Apply the @base context entry to the given context under certain circumstances.\n     * @param context A context.\n     * @param options Parsing options.\n     * @param inheritFromParent If the @base value from the parent context can be inherited.\n     * @return The given context.\n     */\n    applyBaseEntry(context, options, inheritFromParent) {\n        // In some special cases, this can be a string, so ignore those.\n        if (typeof context === 'string') {\n            return context;\n        }\n        // Give priority to @base in the parent context\n        if (inheritFromParent && !('@base' in context) && options.parentContext && '@base' in options.parentContext) {\n            context['@base'] = options.parentContext['@base'];\n            if (options.parentContext['@__baseDocument']) {\n                context['@__baseDocument'] = true;\n            }\n        }\n        // Override the base IRI if provided.\n        if (options.baseIRI && !options.external) {\n            if (!('@base' in context)) {\n                // The context base is the document base\n                context['@base'] = options.baseIRI;\n                context['@__baseDocument'] = true;\n            }\n            else if (context['@base'] !== null && typeof context['@base'] === 'string'\n                && !Util_1.Util.isValidIri(context['@base'])) {\n                // The context base is relative to the document base\n                context['@base'] = relative_to_absolute_iri_1.resolve(context['@base'], options.parentContext && options.parentContext['@base'] || options.baseIRI);\n            }\n        }\n        return context;\n    }\n    /**\n     * Resolve relative context IRIs, or return full IRIs as-is.\n     * @param {string} contextIri A context IRI.\n     * @param {string} baseIRI A base IRI.\n     * @return {string} The normalized context IRI.\n     */\n    normalizeContextIri(contextIri, baseIRI) {\n        if (!Util_1.Util.isValidIri(contextIri)) {\n            contextIri = relative_to_absolute_iri_1.resolve(contextIri, baseIRI);\n            if (!Util_1.Util.isValidIri(contextIri)) {\n                throw new Error(`Invalid context IRI: ${contextIri}`);\n            }\n        }\n        return contextIri;\n    }\n    /**\n     * Parse scoped contexts in the given context.\n     * @param {IJsonLdContextNormalizedRaw} context A context.\n     * @param {IParseOptions} options Parsing options.\n     * @return {IJsonLdContextNormalizedRaw} The mutated input context.\n     */\n    parseInnerContexts(context, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            for (const key of Object.keys(context)) {\n                const value = context[key];\n                if (value && typeof value === 'object') {\n                    if ('@context' in value && value['@context'] !== null) {\n                        // Simulate a processing based on the parent context to check if there are any (potential errors).\n                        // Honestly, I find it a bit weird to do this here, as the context may be unused,\n                        // and the final effective context may differ based on any other embedded/scoped contexts.\n                        // But hey, it's part of the spec, so we have no choice...\n                        // https://w3c.github.io/json-ld-api/#h-note-10\n                        if (this.validateContext) {\n                            try {\n                                const parentContext = Object.assign({}, context);\n                                parentContext[key] = Object.assign({}, parentContext[key]);\n                                delete parentContext[key]['@context'];\n                                yield this.parse(value['@context'], Object.assign({}, options, { parentContext, ignoreProtection: true, ignoreRemoteScopedContexts: true }));\n                            }\n                            catch (e) {\n                                throw new ErrorCoded_1.ErrorCoded(e.message, ErrorCoded_1.ERROR_CODES.INVALID_SCOPED_CONTEXT);\n                            }\n                        }\n                        value['@context'] = (yield this.parse(value['@context'], Object.assign({}, options, { minimalProcessing: true, ignoreRemoteScopedContexts: true, parentContext: context })))\n                            .getContextRaw();\n                    }\n                }\n            }\n            return context;\n        });\n    }\n    /**\n     * Parse a JSON-LD context in any form.\n     * @param {JsonLdContext} context A context, URL to a context, or an array of contexts/URLs.\n     * @param {IParseOptions} options Optional parsing options.\n     * @return {Promise<JsonLdContextNormalized>} A promise resolving to the context.\n     */\n    parse(context, options = {\n        processingMode: ContextParser.DEFAULT_PROCESSING_MODE,\n    }) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { baseIRI, parentContext: parentContextInitial, external, processingMode, normalizeLanguageTags, ignoreProtection, minimalProcessing, } = options;\n            let parentContext = parentContextInitial;\n            const remoteContexts = options.remoteContexts || {};\n            // Avoid remote context overflows\n            if (Object.keys(remoteContexts).length >= this.remoteContextsDepthLimit) {\n                throw new ErrorCoded_1.ErrorCoded('Detected an overflow in remote context inclusions: ' + Object.keys(remoteContexts), ErrorCoded_1.ERROR_CODES.CONTEXT_OVERFLOW);\n            }\n            if (context === null || context === undefined) {\n                // Don't allow context nullification and there are protected terms\n                if (!ignoreProtection && parentContext && Util_1.Util.hasProtectedTerms(parentContext)) {\n                    throw new ErrorCoded_1.ErrorCoded('Illegal context nullification when terms are protected', ErrorCoded_1.ERROR_CODES.INVALID_CONTEXT_NULLIFICATION);\n                }\n                // Context that are explicitly set to null are empty.\n                return new JsonLdContextNormalized_1.JsonLdContextNormalized(this.applyBaseEntry({}, options, false));\n            }\n            else if (typeof context === 'string') {\n                const contextIri = this.normalizeContextIri(context, baseIRI);\n                const overriddenLoad = this.getOverriddenLoad(contextIri, options);\n                if (overriddenLoad) {\n                    return new JsonLdContextNormalized_1.JsonLdContextNormalized(overriddenLoad);\n                }\n                const parsedStringContext = yield this.parse(yield this.load(contextIri), Object.assign({}, options, { baseIRI: contextIri, external: true, remoteContexts: Object.assign({}, remoteContexts, { [contextIri]: true }) }));\n                this.applyBaseEntry(parsedStringContext.getContextRaw(), options, true);\n                return parsedStringContext;\n            }\n            else if (Array.isArray(context)) {\n                // As a performance consideration, first load all external contexts in parallel.\n                const contextIris = [];\n                const contexts = yield Promise.all(context.map((subContext, i) => {\n                    if (typeof subContext === 'string') {\n                        const contextIri = this.normalizeContextIri(subContext, baseIRI);\n                        contextIris[i] = contextIri;\n                        const overriddenLoad = this.getOverriddenLoad(contextIri, options);\n                        if (overriddenLoad) {\n                            return overriddenLoad;\n                        }\n                        return this.load(contextIri);\n                    }\n                    else {\n                        return subContext;\n                    }\n                }));\n                // Don't apply inheritance logic on minimal processing\n                if (minimalProcessing) {\n                    return new JsonLdContextNormalized_1.JsonLdContextNormalized(contexts);\n                }\n                const reducedContexts = yield contexts.reduce((accContextPromise, contextEntry, i) => accContextPromise\n                    .then((accContext) => this.parse(contextEntry, Object.assign({}, options, { baseIRI: contextIris[i] || options.baseIRI, external: !!contextIris[i] || options.external, parentContext: accContext.getContextRaw(), remoteContexts: contextIris[i] ? Object.assign({}, remoteContexts, { [contextIris[i]]: true }) : remoteContexts }))), Promise.resolve(new JsonLdContextNormalized_1.JsonLdContextNormalized(parentContext || {})));\n                // Override the base IRI if provided.\n                this.applyBaseEntry(reducedContexts.getContextRaw(), options, true);\n                return reducedContexts;\n            }\n            else if (typeof context === 'object') {\n                if ('@context' in context) {\n                    return yield this.parse(context['@context'], options);\n                }\n                // Make a deep clone of the given context, to avoid modifying it.\n                context = JSON.parse(JSON.stringify(context)); // No better way in JS at the moment.\n                if (parentContext) {\n                    parentContext = JSON.parse(JSON.stringify(parentContext));\n                }\n                // We have an actual context object.\n                let newContext = {};\n                // According to the JSON-LD spec, @base must be ignored from external contexts.\n                if (external) {\n                    delete context['@base'];\n                }\n                // Override the base IRI if provided.\n                this.applyBaseEntry(context, options, true);\n                // Hashify container entries\n                // Do this before protected term validation as that influences term format\n                this.containersToHash(context);\n                // Don't perform any other modifications if only minimal processing is needed.\n                if (minimalProcessing) {\n                    return new JsonLdContextNormalized_1.JsonLdContextNormalized(context);\n                }\n                // In JSON-LD 1.1, load @import'ed context prior to processing.\n                let importContext = {};\n                if ('@import' in context) {\n                    if (processingMode && processingMode >= 1.1) {\n                        // Only accept string values\n                        if (typeof context['@import'] !== 'string') {\n                            throw new ErrorCoded_1.ErrorCoded('An @import value must be a string, but got ' + typeof context['@import'], ErrorCoded_1.ERROR_CODES.INVALID_IMPORT_VALUE);\n                        }\n                        // Load context\n                        importContext = yield this.loadImportContext(this.normalizeContextIri(context['@import'], baseIRI));\n                        delete context['@import'];\n                    }\n                    else {\n                        throw new ErrorCoded_1.ErrorCoded('Context importing is not supported in JSON-LD 1.0', ErrorCoded_1.ERROR_CODES.INVALID_CONTEXT_ENTRY);\n                    }\n                }\n                // Merge different parts of the final context in order\n                newContext = Object.assign({}, newContext, parentContext, importContext, context);\n                const newContextWrapped = new JsonLdContextNormalized_1.JsonLdContextNormalized(newContext);\n                // Parse inner contexts with minimal processing\n                yield this.parseInnerContexts(newContext, options);\n                // In JSON-LD 1.1, check if we are not redefining any protected keywords\n                if (!ignoreProtection && parentContext && processingMode && processingMode >= 1.1) {\n                    this.validateKeywordRedefinitions(parentContext, newContext, exports.defaultExpandOptions);\n                }\n                // In JSON-LD 1.1, @vocab can be relative to @vocab in the parent context.\n                if ((newContext && newContext['@version'] || processingMode || ContextParser.DEFAULT_PROCESSING_MODE) >= 1.1\n                    && ((context['@vocab'] && typeof context['@vocab'] === 'string') || context['@vocab'] === '')\n                    && context['@vocab'].indexOf(':') < 0 && parentContext && '@vocab' in parentContext) {\n                    newContext['@vocab'] = parentContext['@vocab'] + context['@vocab'];\n                }\n                this.idifyReverseTerms(newContext);\n                this.expandPrefixedTerms(newContextWrapped, this.expandContentTypeToBase);\n                this.normalize(newContext, { processingMode, normalizeLanguageTags });\n                this.applyScopedProtected(newContext, { processingMode });\n                if (this.validateContext) {\n                    this.validate(newContext, { processingMode });\n                }\n                return newContextWrapped;\n            }\n            else {\n                throw new ErrorCoded_1.ErrorCoded(`Tried parsing a context that is not a string, array or object, but got ${context}`, ErrorCoded_1.ERROR_CODES.INVALID_LOCAL_CONTEXT);\n            }\n        });\n    }\n    /**\n     * Fetch the given URL as a raw JSON-LD context.\n     * @param url An URL.\n     * @return A promise resolving to a raw JSON-LD context.\n     */\n    load(url) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // First try to retrieve the context from cache\n            const cached = this.documentCache[url];\n            if (cached) {\n                return typeof cached === 'string' ? cached : Array.isArray(cached) ? cached.slice() : Object.assign({}, cached);\n            }\n            // If not in cache, load it\n            let document;\n            try {\n                document = yield this.documentLoader.load(url);\n            }\n            catch (e) {\n                throw new ErrorCoded_1.ErrorCoded(`Failed to load remote context ${url}: ${e.message}`, ErrorCoded_1.ERROR_CODES.LOADING_REMOTE_CONTEXT_FAILED);\n            }\n            // Validate the context\n            if (!('@context' in document)) {\n                throw new ErrorCoded_1.ErrorCoded(`Missing @context in remote context at ${url}`, ErrorCoded_1.ERROR_CODES.INVALID_REMOTE_CONTEXT);\n            }\n            return this.documentCache[url] = document['@context'];\n        });\n    }\n    /**\n     * Override the given context that may be loaded.\n     *\n     * This will check whether or not the url is recursively being loaded.\n     * @param url An URL.\n     * @param options Parsing options.\n     * @return An overridden context, or null.\n     *         Optionally an error can be thrown if a cyclic context is detected.\n     */\n    getOverriddenLoad(url, options) {\n        if (url in (options.remoteContexts || {})) {\n            if (options.ignoreRemoteScopedContexts) {\n                return url;\n            }\n            else {\n                throw new ErrorCoded_1.ErrorCoded('Detected a cyclic context inclusion of ' + url, ErrorCoded_1.ERROR_CODES.RECURSIVE_CONTEXT_INCLUSION);\n            }\n        }\n        return null;\n    }\n    /**\n     * Load an @import'ed context.\n     * @param importContextIri The full URI of an @import value.\n     */\n    loadImportContext(importContextIri) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // Load the context\n            const importContext = yield this.load(importContextIri);\n            // Require the context to be a non-array object\n            if (typeof importContext !== 'object' || Array.isArray(importContext)) {\n                throw new ErrorCoded_1.ErrorCoded('An imported context must be a single object: ' + importContextIri, ErrorCoded_1.ERROR_CODES.INVALID_REMOTE_CONTEXT);\n            }\n            // Error if the context contains another @import\n            if ('@import' in importContext) {\n                throw new ErrorCoded_1.ErrorCoded('An imported context can not import another context: ' + importContextIri, ErrorCoded_1.ERROR_CODES.INVALID_CONTEXT_ENTRY);\n            }\n            return importContext;\n        });\n    }\n}\nContextParser.DEFAULT_PROCESSING_MODE = 1.1;\nexports.ContextParser = ContextParser;\nexports.defaultExpandOptions = {\n    allowPrefixForcing: true,\n    allowPrefixNonGenDelims: false,\n    allowVocabRelativeToBase: true,\n};\n//# sourceMappingURL=ContextParser.js.map","// the whatwg-fetch polyfill installs the fetch() function\n// on the global object (window or self)\n//\n// Return that as the export for use in Webpack, Browserify etc.\nrequire('whatwg-fetch');\nmodule.exports = self.fetch.bind(self);\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nrequire(\"isomorphic-fetch\");\nconst ErrorCoded_1 = require(\"./ErrorCoded\");\nconst http_link_header_1 = require(\"http-link-header\");\nconst relative_to_absolute_iri_1 = require(\"relative-to-absolute-iri\");\n/**\n * Loads documents via the fetch API.\n */\nclass FetchDocumentLoader {\n    constructor(fetcher) {\n        this.fetcher = fetcher || fetch;\n    }\n    load(url) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const response = yield this.fetcher(url, { headers: new Headers({ accept: 'application/ld+json' }) });\n            if (response.ok && response.headers) {\n                const mediaType = response.headers.get('Content-Type');\n                if (mediaType === 'application/ld+json') {\n                    // Return JSON-LD if proper content type was returned\n                    return (yield response.json());\n                }\n                else {\n                    // Check for alternate link for a non-JSON-LD response\n                    if (response.headers.has('Link')) {\n                        let alternateUrl;\n                        response.headers.forEach((value, key) => {\n                            if (key === 'link') {\n                                const linkHeader = http_link_header_1.parse(value);\n                                for (const link of linkHeader.get('type', 'application/ld+json')) {\n                                    if (link.rel === 'alternate') {\n                                        if (alternateUrl) {\n                                            throw new Error('Multiple JSON-LD alternate links were found on ' + url);\n                                        }\n                                        alternateUrl = relative_to_absolute_iri_1.resolve(link.uri, url);\n                                    }\n                                }\n                            }\n                        });\n                        if (alternateUrl) {\n                            return this.load(alternateUrl);\n                        }\n                    }\n                    throw new ErrorCoded_1.ErrorCoded(`Unsupported JSON-LD media type ${mediaType}`, ErrorCoded_1.ERROR_CODES.LOADING_DOCUMENT_FAILED);\n                }\n            }\n            else {\n                throw new Error(response.statusText || `Status code: ${response.status}`);\n            }\n        });\n    }\n}\nexports.FetchDocumentLoader = FetchDocumentLoader;\n//# sourceMappingURL=FetchDocumentLoader.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst relative_to_absolute_iri_1 = require(\"relative-to-absolute-iri\");\nconst ContextParser_1 = require(\"./ContextParser\");\nconst ErrorCoded_1 = require(\"./ErrorCoded\");\nconst Util_1 = require(\"./Util\");\n/**\n * A class exposing operations over a normalized JSON-LD context.\n */\nclass JsonLdContextNormalized {\n    constructor(contextRaw) {\n        this.contextRaw = contextRaw;\n    }\n    /**\n     * @return The raw inner context.\n     */\n    getContextRaw() {\n        return this.contextRaw;\n    }\n    /**\n     * Expand the term or prefix of the given term if it has one,\n     * otherwise return the term as-is.\n     *\n     * This will try to expand the IRI as much as possible.\n     *\n     * Iff in vocab-mode, then other references to other terms in the context can be used,\n     * such as to `myTerm`:\n     * ```\n     * {\n     *   \"myTerm\": \"http://example.org/myLongTerm\"\n     * }\n     * ```\n     *\n     * @param {string} term A term that is an URL or a prefixed URL.\n     * @param {boolean} expandVocab If the term is a predicate or type and should be expanded based on @vocab,\n     *                              otherwise it is considered a regular term that is expanded based on @base.\n     * @param {IExpandOptions} options Options that define the way how expansion must be done.\n     * @return {string} The expanded term, the term as-is, or null if it was explicitly disabled in the context.\n     * @throws If the term is aliased to an invalid value (not a string, IRI or keyword).\n     */\n    expandTerm(term, expandVocab, options = ContextParser_1.defaultExpandOptions) {\n        const contextValue = this.contextRaw[term];\n        // Immediately return if the term was disabled in the context\n        if (contextValue === null || (contextValue && contextValue['@id'] === null)) {\n            return null;\n        }\n        // Check the @id\n        let validIriMapping = true;\n        if (contextValue && expandVocab) {\n            const value = Util_1.Util.getContextValueId(contextValue);\n            if (value && value !== term) {\n                if (typeof value !== 'string' || (!Util_1.Util.isValidIri(value) && !Util_1.Util.isValidKeyword(value))) {\n                    // Don't mark this mapping as invalid if we have an unknown keyword, but of the correct form.\n                    if (!Util_1.Util.isPotentialKeyword(value)) {\n                        validIriMapping = false;\n                    }\n                }\n                else {\n                    return value;\n                }\n            }\n        }\n        // Check if the term is prefixed\n        const prefix = Util_1.Util.getPrefix(term, this.contextRaw);\n        const vocab = this.contextRaw['@vocab'];\n        const vocabRelative = (!!vocab || vocab === '') && vocab.indexOf(':') < 0;\n        const base = this.contextRaw['@base'];\n        const potentialKeyword = Util_1.Util.isPotentialKeyword(term);\n        if (prefix) {\n            const contextPrefixValue = this.contextRaw[prefix];\n            const value = Util_1.Util.getContextValueId(contextPrefixValue);\n            if (value) {\n                if (typeof contextPrefixValue === 'string' || !options.allowPrefixForcing) {\n                    // If we have a simple term definition,\n                    // check the last character of the prefix to determine whether or not it is a prefix.\n                    // Validate that prefix ends with gen-delim character, unless @prefix is true\n                    if (!Util_1.Util.isSimpleTermDefinitionPrefix(value, options)) {\n                        // Treat the term as an absolute IRI\n                        return term;\n                    }\n                }\n                else {\n                    // If we have an expanded term definition, default to @prefix: false\n                    if (value[0] !== '_' && !potentialKeyword && !contextPrefixValue['@prefix'] && !(term in this.contextRaw)) {\n                        // Treat the term as an absolute IRI\n                        return term;\n                    }\n                }\n                return value + term.substr(prefix.length + 1);\n            }\n        }\n        else if (expandVocab && ((vocab || vocab === '') || (options.allowVocabRelativeToBase && (base && vocabRelative)))\n            && !potentialKeyword && !Util_1.Util.isCompactIri(term)) {\n            if (vocabRelative) {\n                if (options.allowVocabRelativeToBase) {\n                    return relative_to_absolute_iri_1.resolve(vocab, base) + term;\n                }\n                else {\n                    throw new ErrorCoded_1.ErrorCoded(`Relative vocab expansion for term '${term}' with vocab '${vocab}' is not allowed.`, ErrorCoded_1.ERROR_CODES.INVALID_VOCAB_MAPPING);\n                }\n            }\n            else {\n                return vocab + term;\n            }\n        }\n        else if (!expandVocab && base && !potentialKeyword && !Util_1.Util.isCompactIri(term)) {\n            return relative_to_absolute_iri_1.resolve(term, base);\n        }\n        // Return the term as-is, unless we discovered an invalid IRI mapping for this term in the context earlier.\n        if (validIriMapping) {\n            return term;\n        }\n        else {\n            throw new ErrorCoded_1.ErrorCoded(`Invalid IRI mapping found for context entry '${term}': '${JSON.stringify(contextValue)}'`, ErrorCoded_1.ERROR_CODES.INVALID_IRI_MAPPING);\n        }\n    }\n    /**\n     * Compact the given term using @base, @vocab, an aliased term, or a prefixed term.\n     *\n     * This will try to compact the IRI as much as possible.\n     *\n     * @param {string} iri An IRI to compact.\n     * @param {boolean} vocab If the term is a predicate or type and should be compacted based on @vocab,\n     *                        otherwise it is considered a regular term that is compacted based on @base.\n     * @return {string} The compacted term or the IRI as-is.\n     */\n    compactIri(iri, vocab) {\n        // Try @vocab compacting\n        if (vocab && this.contextRaw['@vocab'] && iri.startsWith(this.contextRaw['@vocab'])) {\n            return iri.substr(this.contextRaw['@vocab'].length);\n        }\n        // Try @base compacting\n        if (!vocab && this.contextRaw['@base'] && iri.startsWith(this.contextRaw['@base'])) {\n            return iri.substr(this.contextRaw['@base'].length);\n        }\n        // Loop over all terms in the context\n        // This will try to prefix as short as possible.\n        // Once a fully compacted alias is found, return immediately, as we can not go any shorter.\n        const shortestPrefixing = { prefix: '', suffix: iri };\n        for (const key in this.contextRaw) {\n            const value = this.contextRaw[key];\n            if (value && !Util_1.Util.isPotentialKeyword(key)) {\n                const contextIri = Util_1.Util.getContextValueId(value);\n                if (iri.startsWith(contextIri)) {\n                    const suffix = iri.substr(contextIri.length);\n                    if (!suffix) {\n                        if (vocab) {\n                            // Immediately return on compacted alias\n                            return key;\n                        }\n                    }\n                    else if (suffix.length < shortestPrefixing.suffix.length) {\n                        // Overwrite the shortest prefix\n                        shortestPrefixing.prefix = key;\n                        shortestPrefixing.suffix = suffix;\n                    }\n                }\n            }\n        }\n        // Return the shortest prefix\n        if (shortestPrefixing.prefix) {\n            return shortestPrefixing.prefix + ':' + shortestPrefixing.suffix;\n        }\n        return iri;\n    }\n}\nexports.JsonLdContextNormalized = JsonLdContextNormalized;\n//# sourceMappingURL=JsonLdContextNormalized.js.map","function DefaultGraph () {\n  this.value = ''\n}\n\nDefaultGraph.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType\n}\n\nDefaultGraph.prototype.termType = 'DefaultGraph'\n\nmodule.exports = DefaultGraph\n","function NamedNode (iri) {\n  this.value = iri\n}\n\nNamedNode.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType && other.value === this.value\n}\n\nNamedNode.prototype.termType = 'NamedNode'\n\nmodule.exports = NamedNode\n","var support = {\n  searchParams: 'URLSearchParams' in self,\n  iterable: 'Symbol' in self && 'iterator' in Symbol,\n  blob:\n    'FileReader' in self &&\n    'Blob' in self &&\n    (function() {\n      try {\n        new Blob()\n        return true\n      } catch (e) {\n        return false\n      }\n    })(),\n  formData: 'FormData' in self,\n  arrayBuffer: 'ArrayBuffer' in self\n}\n\nfunction isDataView(obj) {\n  return obj && DataView.prototype.isPrototypeOf(obj)\n}\n\nif (support.arrayBuffer) {\n  var viewClasses = [\n    '[object Int8Array]',\n    '[object Uint8Array]',\n    '[object Uint8ClampedArray]',\n    '[object Int16Array]',\n    '[object Uint16Array]',\n    '[object Int32Array]',\n    '[object Uint32Array]',\n    '[object Float32Array]',\n    '[object Float64Array]'\n  ]\n\n  var isArrayBufferView =\n    ArrayBuffer.isView ||\n    function(obj) {\n      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n    }\n}\n\nfunction normalizeName(name) {\n  if (typeof name !== 'string') {\n    name = String(name)\n  }\n  if (/[^a-z0-9\\-#$%&'*+.^_`|~]/i.test(name)) {\n    throw new TypeError('Invalid character in header field name')\n  }\n  return name.toLowerCase()\n}\n\nfunction normalizeValue(value) {\n  if (typeof value !== 'string') {\n    value = String(value)\n  }\n  return value\n}\n\n// Build a destructive iterator for the value list\nfunction iteratorFor(items) {\n  var iterator = {\n    next: function() {\n      var value = items.shift()\n      return {done: value === undefined, value: value}\n    }\n  }\n\n  if (support.iterable) {\n    iterator[Symbol.iterator] = function() {\n      return iterator\n    }\n  }\n\n  return iterator\n}\n\nexport function Headers(headers) {\n  this.map = {}\n\n  if (headers instanceof Headers) {\n    headers.forEach(function(value, name) {\n      this.append(name, value)\n    }, this)\n  } else if (Array.isArray(headers)) {\n    headers.forEach(function(header) {\n      this.append(header[0], header[1])\n    }, this)\n  } else if (headers) {\n    Object.getOwnPropertyNames(headers).forEach(function(name) {\n      this.append(name, headers[name])\n    }, this)\n  }\n}\n\nHeaders.prototype.append = function(name, value) {\n  name = normalizeName(name)\n  value = normalizeValue(value)\n  var oldValue = this.map[name]\n  this.map[name] = oldValue ? oldValue + ', ' + value : value\n}\n\nHeaders.prototype['delete'] = function(name) {\n  delete this.map[normalizeName(name)]\n}\n\nHeaders.prototype.get = function(name) {\n  name = normalizeName(name)\n  return this.has(name) ? this.map[name] : null\n}\n\nHeaders.prototype.has = function(name) {\n  return this.map.hasOwnProperty(normalizeName(name))\n}\n\nHeaders.prototype.set = function(name, value) {\n  this.map[normalizeName(name)] = normalizeValue(value)\n}\n\nHeaders.prototype.forEach = function(callback, thisArg) {\n  for (var name in this.map) {\n    if (this.map.hasOwnProperty(name)) {\n      callback.call(thisArg, this.map[name], name, this)\n    }\n  }\n}\n\nHeaders.prototype.keys = function() {\n  var items = []\n  this.forEach(function(value, name) {\n    items.push(name)\n  })\n  return iteratorFor(items)\n}\n\nHeaders.prototype.values = function() {\n  var items = []\n  this.forEach(function(value) {\n    items.push(value)\n  })\n  return iteratorFor(items)\n}\n\nHeaders.prototype.entries = function() {\n  var items = []\n  this.forEach(function(value, name) {\n    items.push([name, value])\n  })\n  return iteratorFor(items)\n}\n\nif (support.iterable) {\n  Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n}\n\nfunction consumed(body) {\n  if (body.bodyUsed) {\n    return Promise.reject(new TypeError('Already read'))\n  }\n  body.bodyUsed = true\n}\n\nfunction fileReaderReady(reader) {\n  return new Promise(function(resolve, reject) {\n    reader.onload = function() {\n      resolve(reader.result)\n    }\n    reader.onerror = function() {\n      reject(reader.error)\n    }\n  })\n}\n\nfunction readBlobAsArrayBuffer(blob) {\n  var reader = new FileReader()\n  var promise = fileReaderReady(reader)\n  reader.readAsArrayBuffer(blob)\n  return promise\n}\n\nfunction readBlobAsText(blob) {\n  var reader = new FileReader()\n  var promise = fileReaderReady(reader)\n  reader.readAsText(blob)\n  return promise\n}\n\nfunction readArrayBufferAsText(buf) {\n  var view = new Uint8Array(buf)\n  var chars = new Array(view.length)\n\n  for (var i = 0; i < view.length; i++) {\n    chars[i] = String.fromCharCode(view[i])\n  }\n  return chars.join('')\n}\n\nfunction bufferClone(buf) {\n  if (buf.slice) {\n    return buf.slice(0)\n  } else {\n    var view = new Uint8Array(buf.byteLength)\n    view.set(new Uint8Array(buf))\n    return view.buffer\n  }\n}\n\nfunction Body() {\n  this.bodyUsed = false\n\n  this._initBody = function(body) {\n    this._bodyInit = body\n    if (!body) {\n      this._bodyText = ''\n    } else if (typeof body === 'string') {\n      this._bodyText = body\n    } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n      this._bodyBlob = body\n    } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n      this._bodyFormData = body\n    } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n      this._bodyText = body.toString()\n    } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n      this._bodyArrayBuffer = bufferClone(body.buffer)\n      // IE 10-11 can't handle a DataView body.\n      this._bodyInit = new Blob([this._bodyArrayBuffer])\n    } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n      this._bodyArrayBuffer = bufferClone(body)\n    } else {\n      this._bodyText = body = Object.prototype.toString.call(body)\n    }\n\n    if (!this.headers.get('content-type')) {\n      if (typeof body === 'string') {\n        this.headers.set('content-type', 'text/plain;charset=UTF-8')\n      } else if (this._bodyBlob && this._bodyBlob.type) {\n        this.headers.set('content-type', this._bodyBlob.type)\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n      }\n    }\n  }\n\n  if (support.blob) {\n    this.blob = function() {\n      var rejected = consumed(this)\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return Promise.resolve(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as blob')\n      } else {\n        return Promise.resolve(new Blob([this._bodyText]))\n      }\n    }\n\n    this.arrayBuffer = function() {\n      if (this._bodyArrayBuffer) {\n        return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n      } else {\n        return this.blob().then(readBlobAsArrayBuffer)\n      }\n    }\n  }\n\n  this.text = function() {\n    var rejected = consumed(this)\n    if (rejected) {\n      return rejected\n    }\n\n    if (this._bodyBlob) {\n      return readBlobAsText(this._bodyBlob)\n    } else if (this._bodyArrayBuffer) {\n      return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n    } else if (this._bodyFormData) {\n      throw new Error('could not read FormData body as text')\n    } else {\n      return Promise.resolve(this._bodyText)\n    }\n  }\n\n  if (support.formData) {\n    this.formData = function() {\n      return this.text().then(decode)\n    }\n  }\n\n  this.json = function() {\n    return this.text().then(JSON.parse)\n  }\n\n  return this\n}\n\n// HTTP methods whose capitalization should be normalized\nvar methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\nfunction normalizeMethod(method) {\n  var upcased = method.toUpperCase()\n  return methods.indexOf(upcased) > -1 ? upcased : method\n}\n\nexport function Request(input, options) {\n  options = options || {}\n  var body = options.body\n\n  if (input instanceof Request) {\n    if (input.bodyUsed) {\n      throw new TypeError('Already read')\n    }\n    this.url = input.url\n    this.credentials = input.credentials\n    if (!options.headers) {\n      this.headers = new Headers(input.headers)\n    }\n    this.method = input.method\n    this.mode = input.mode\n    this.signal = input.signal\n    if (!body && input._bodyInit != null) {\n      body = input._bodyInit\n      input.bodyUsed = true\n    }\n  } else {\n    this.url = String(input)\n  }\n\n  this.credentials = options.credentials || this.credentials || 'same-origin'\n  if (options.headers || !this.headers) {\n    this.headers = new Headers(options.headers)\n  }\n  this.method = normalizeMethod(options.method || this.method || 'GET')\n  this.mode = options.mode || this.mode || null\n  this.signal = options.signal || this.signal\n  this.referrer = null\n\n  if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n    throw new TypeError('Body not allowed for GET or HEAD requests')\n  }\n  this._initBody(body)\n}\n\nRequest.prototype.clone = function() {\n  return new Request(this, {body: this._bodyInit})\n}\n\nfunction decode(body) {\n  var form = new FormData()\n  body\n    .trim()\n    .split('&')\n    .forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n  return form\n}\n\nfunction parseHeaders(rawHeaders) {\n  var headers = new Headers()\n  // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n  // https://tools.ietf.org/html/rfc7230#section-3.2\n  var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ')\n  preProcessedHeaders.split(/\\r?\\n/).forEach(function(line) {\n    var parts = line.split(':')\n    var key = parts.shift().trim()\n    if (key) {\n      var value = parts.join(':').trim()\n      headers.append(key, value)\n    }\n  })\n  return headers\n}\n\nBody.call(Request.prototype)\n\nexport function Response(bodyInit, options) {\n  if (!options) {\n    options = {}\n  }\n\n  this.type = 'default'\n  this.status = options.status === undefined ? 200 : options.status\n  this.ok = this.status >= 200 && this.status < 300\n  this.statusText = 'statusText' in options ? options.statusText : 'OK'\n  this.headers = new Headers(options.headers)\n  this.url = options.url || ''\n  this._initBody(bodyInit)\n}\n\nBody.call(Response.prototype)\n\nResponse.prototype.clone = function() {\n  return new Response(this._bodyInit, {\n    status: this.status,\n    statusText: this.statusText,\n    headers: new Headers(this.headers),\n    url: this.url\n  })\n}\n\nResponse.error = function() {\n  var response = new Response(null, {status: 0, statusText: ''})\n  response.type = 'error'\n  return response\n}\n\nvar redirectStatuses = [301, 302, 303, 307, 308]\n\nResponse.redirect = function(url, status) {\n  if (redirectStatuses.indexOf(status) === -1) {\n    throw new RangeError('Invalid status code')\n  }\n\n  return new Response(null, {status: status, headers: {location: url}})\n}\n\nexport var DOMException = self.DOMException\ntry {\n  new DOMException()\n} catch (err) {\n  DOMException = function(message, name) {\n    this.message = message\n    this.name = name\n    var error = Error(message)\n    this.stack = error.stack\n  }\n  DOMException.prototype = Object.create(Error.prototype)\n  DOMException.prototype.constructor = DOMException\n}\n\nexport function fetch(input, init) {\n  return new Promise(function(resolve, reject) {\n    var request = new Request(input, init)\n\n    if (request.signal && request.signal.aborted) {\n      return reject(new DOMException('Aborted', 'AbortError'))\n    }\n\n    var xhr = new XMLHttpRequest()\n\n    function abortXhr() {\n      xhr.abort()\n    }\n\n    xhr.onload = function() {\n      var options = {\n        status: xhr.status,\n        statusText: xhr.statusText,\n        headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n      }\n      options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n      var body = 'response' in xhr ? xhr.response : xhr.responseText\n      resolve(new Response(body, options))\n    }\n\n    xhr.onerror = function() {\n      reject(new TypeError('Network request failed'))\n    }\n\n    xhr.ontimeout = function() {\n      reject(new TypeError('Network request failed'))\n    }\n\n    xhr.onabort = function() {\n      reject(new DOMException('Aborted', 'AbortError'))\n    }\n\n    xhr.open(request.method, request.url, true)\n\n    if (request.credentials === 'include') {\n      xhr.withCredentials = true\n    } else if (request.credentials === 'omit') {\n      xhr.withCredentials = false\n    }\n\n    if ('responseType' in xhr && support.blob) {\n      xhr.responseType = 'blob'\n    }\n\n    request.headers.forEach(function(value, name) {\n      xhr.setRequestHeader(name, value)\n    })\n\n    if (request.signal) {\n      request.signal.addEventListener('abort', abortXhr)\n\n      xhr.onreadystatechange = function() {\n        // DONE (success or failure)\n        if (xhr.readyState === 4) {\n          request.signal.removeEventListener('abort', abortXhr)\n        }\n      }\n    }\n\n    xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n  })\n}\n\nfetch.polyfill = true\n\nif (!self.fetch) {\n  self.fetch = fetch\n  self.Headers = Headers\n  self.Request = Request\n  self.Response = Response\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Convert the given relative IRI to an absolute IRI\n * by taking into account the given optional baseIRI.\n *\n * @param {string} relativeIRI The relative IRI to convert to an absolute IRI.\n * @param {string} baseIRI The optional base IRI.\n * @return {string} an absolute IRI.\n */\nfunction resolve(relativeIRI, baseIRI) {\n    baseIRI = baseIRI || '';\n    const baseFragmentPos = baseIRI.indexOf('#');\n    // Ignore any fragments in the base IRI\n    if (baseFragmentPos > 0) {\n        baseIRI = baseIRI.substr(0, baseFragmentPos);\n    }\n    // Convert empty value directly to base IRI\n    if (!relativeIRI.length) {\n        return baseIRI;\n    }\n    // If the value starts with a query character, concat directly (but strip the existing query)\n    if (relativeIRI.startsWith('?')) {\n        const baseQueryPos = baseIRI.indexOf('?');\n        if (baseQueryPos > 0) {\n            baseIRI = baseIRI.substr(0, baseQueryPos);\n        }\n        return baseIRI + relativeIRI;\n    }\n    // If the value starts with a fragment character, concat directly\n    if (relativeIRI.startsWith('#')) {\n        return baseIRI + relativeIRI;\n    }\n    // Ignore baseIRI if it is empty\n    if (!baseIRI.length) {\n        return removeDotSegmentsOfPath(relativeIRI, relativeIRI.indexOf(':'));\n    }\n    // Ignore baseIRI if the value is absolute\n    const valueColonPos = relativeIRI.indexOf(':');\n    if (valueColonPos >= 0) {\n        return removeDotSegmentsOfPath(relativeIRI, valueColonPos);\n    }\n    // At this point, the baseIRI MUST be absolute, otherwise we error\n    const baseColonPos = baseIRI.indexOf(':');\n    if (baseColonPos < 0) {\n        throw new Error(`Found invalid baseIRI '${baseIRI}' for value '${relativeIRI}'`);\n    }\n    const baseIRIScheme = baseIRI.substr(0, baseColonPos + 1);\n    // Inherit the baseIRI scheme if the value starts with '//'\n    if (relativeIRI.indexOf('//') === 0) {\n        return baseIRIScheme + removeDotSegmentsOfPath(relativeIRI, valueColonPos);\n    }\n    // Check cases where '://' occurs in the baseIRI, and where there is no '/' after a ':' anymore.\n    let baseSlashAfterColonPos;\n    if (baseIRI.indexOf('//', baseColonPos) === baseColonPos + 1) {\n        // If there is no additional '/' after the '//'.\n        baseSlashAfterColonPos = baseIRI.indexOf('/', baseColonPos + 3);\n        if (baseSlashAfterColonPos < 0) {\n            // If something other than a '/' follows the '://', append the value after a '/',\n            // otherwise, prefix the value with only the baseIRI scheme.\n            if (baseIRI.length > baseColonPos + 3) {\n                return baseIRI + '/' + removeDotSegmentsOfPath(relativeIRI, valueColonPos);\n            }\n            else {\n                return baseIRIScheme + removeDotSegmentsOfPath(relativeIRI, valueColonPos);\n            }\n        }\n    }\n    else {\n        // If there is not even a single '/' after the ':'\n        baseSlashAfterColonPos = baseIRI.indexOf('/', baseColonPos + 1);\n        if (baseSlashAfterColonPos < 0) {\n            // If we don't have a '/' after the ':',\n            // prefix the value with only the baseIRI scheme.\n            return baseIRIScheme + removeDotSegmentsOfPath(relativeIRI, valueColonPos);\n        }\n    }\n    // If the value starts with a '/', then prefix it with everything before the first effective slash of the base IRI.\n    if (relativeIRI.indexOf('/') === 0) {\n        return baseIRI.substr(0, baseSlashAfterColonPos) + removeDotSegments(relativeIRI);\n    }\n    let baseIRIPath = baseIRI.substr(baseSlashAfterColonPos);\n    const baseIRILastSlashPos = baseIRIPath.lastIndexOf('/');\n    // Ignore everything after the last '/' in the baseIRI path\n    if (baseIRILastSlashPos >= 0 && baseIRILastSlashPos < baseIRIPath.length - 1) {\n        baseIRIPath = baseIRIPath.substr(0, baseIRILastSlashPos + 1);\n        // Also remove the first character of the relative path if it starts with '.' (and not '..' or './')\n        // This change is only allowed if there is something else following the path\n        if (relativeIRI[0] === '.' && relativeIRI[1] !== '.' && relativeIRI[1] !== '/' && relativeIRI[2]) {\n            relativeIRI = relativeIRI.substr(1);\n        }\n    }\n    // Prefix the value with the baseIRI path where\n    relativeIRI = baseIRIPath + relativeIRI;\n    // Remove dot segment from the IRI\n    relativeIRI = removeDotSegments(relativeIRI);\n    // Prefix our transformed value with the part of the baseIRI until the first '/' after the first ':'.\n    return baseIRI.substr(0, baseSlashAfterColonPos) + relativeIRI;\n}\nexports.resolve = resolve;\n/**\n * Remove dot segments from the given path,\n * as described in https://www.ietf.org/rfc/rfc3986.txt (page 32).\n * @param {string} path An IRI path.\n * @return {string} A path, will always start with a '/'.\n */\nfunction removeDotSegments(path) {\n    // Prepare a buffer with segments between each '/.\n    // Each segment represents an array of characters.\n    const segmentBuffers = [];\n    let i = 0;\n    while (i < path.length) {\n        // Remove '/.' or '/..'\n        switch (path[i]) {\n            case '/':\n                if (path[i + 1] === '.') {\n                    if (path[i + 2] === '.') {\n                        // Start a new segment if we find an invalid character after the '.'\n                        if (!isCharacterAllowedAfterRelativePathSegment(path[i + 3])) {\n                            segmentBuffers.push([]);\n                            i++;\n                            break;\n                        }\n                        // Go to parent directory,\n                        // so we remove a parent segment\n                        segmentBuffers.pop();\n                        // Ensure that we end with a slash if there is a trailing '/..'\n                        if (!path[i + 3]) {\n                            segmentBuffers.push([]);\n                        }\n                        i += 3;\n                    }\n                    else {\n                        // Start a new segment if we find an invalid character after the '.'\n                        if (!isCharacterAllowedAfterRelativePathSegment(path[i + 2])) {\n                            segmentBuffers.push([]);\n                            i++;\n                            break;\n                        }\n                        // Ensure that we end with a slash if there is a trailing '/.'\n                        if (!path[i + 2]) {\n                            segmentBuffers.push([]);\n                        }\n                        // Go to the current directory,\n                        // so we do nothing\n                        i += 2;\n                    }\n                }\n                else {\n                    // Start a new segment\n                    segmentBuffers.push([]);\n                    i++;\n                }\n                break;\n            case '#':\n            case '?':\n                // Query and fragment string should be appended unchanged\n                if (!segmentBuffers.length) {\n                    segmentBuffers.push([]);\n                }\n                segmentBuffers[segmentBuffers.length - 1].push(path.substr(i));\n                // Break the while loop\n                i = path.length;\n                break;\n            default:\n                // Not a special character, just append it to our buffer\n                if (!segmentBuffers.length) {\n                    segmentBuffers.push([]);\n                }\n                segmentBuffers[segmentBuffers.length - 1].push(path[i]);\n                i++;\n                break;\n        }\n    }\n    return '/' + segmentBuffers.map((buffer) => buffer.join('')).join('/');\n}\nexports.removeDotSegments = removeDotSegments;\n/**\n * Removes dot segments of the given IRI.\n * @param {string} iri An IRI (or part of IRI).\n * @param {number} colonPosition The position of the first ':' in the IRI.\n * @return {string} The IRI where dot segments were removed.\n */\nfunction removeDotSegmentsOfPath(iri, colonPosition) {\n    // Determine where we should start looking for the first '/' that indicates the start of the path\n    let searchOffset = colonPosition + 1;\n    if (colonPosition >= 0) {\n        if (iri[colonPosition + 1] === '/' && iri[colonPosition + 2] === '/') {\n            searchOffset = colonPosition + 3;\n        }\n    }\n    else {\n        if (iri[0] === '/' && iri[1] === '/') {\n            searchOffset = 2;\n        }\n    }\n    // Determine the path\n    const pathSeparator = iri.indexOf('/', searchOffset);\n    if (pathSeparator < 0) {\n        return iri;\n    }\n    const base = iri.substr(0, pathSeparator);\n    const path = iri.substr(pathSeparator);\n    // Remove dot segments from the path\n    return base + removeDotSegments(path);\n}\nexports.removeDotSegmentsOfPath = removeDotSegmentsOfPath;\nfunction isCharacterAllowedAfterRelativePathSegment(character) {\n    return !character || character === '#' || character === '?' || character === '/';\n}\n//# sourceMappingURL=Resolve.js.map","'use strict'\n\nvar COMPATIBLE_ENCODING_PATTERN = /^utf-?8|ascii|utf-?16-?le|ucs-?2|base-?64|latin-?1$/i\nvar WS_TRIM_PATTERN = /^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g\nvar WS_CHAR_PATTERN = /\\s|\\uFEFF|\\xA0/\nvar WS_FOLD_PATTERN = /\\r?\\n[\\x20\\x09]+/g\nvar DELIMITER_PATTERN = /[;,\"]/\nvar WS_DELIMITER_PATTERN = /[;,\"]|\\s/\n\nvar STATE = {\n  IDLE: 1 << 0,\n  URI: 1 << 1,\n  ATTR: 1 << 2,\n}\n\nfunction trim( value ) {\n  return value.replace( WS_TRIM_PATTERN, '' )\n}\n\nfunction hasWhitespace( value ) {\n  return WS_CHAR_PATTERN.test( value )\n}\n\nfunction skipWhitespace( value, offset ) {\n  while( hasWhitespace( value[offset] ) ) {\n    offset++\n  }\n  return offset\n}\n\nfunction needsQuotes( value ) {\n  return WS_DELIMITER_PATTERN.test( value )\n}\n\nclass Link {\n\n  /**\n   * Link\n   * @constructor\n   * @param {String} [value]\n   * @returns {Link}\n   */\n  constructor( value ) {\n\n    /** @type {Array} URI references */\n    this.refs = []\n\n    if( value ) {\n      this.parse( value )\n    }\n\n  }\n\n  /**\n   * Get refs with given relation type\n   * @param {String} value\n   * @returns {Array<Object>}\n   */\n  rel( value ) {\n\n    var links = []\n\n    for( var i = 0; i < this.refs.length; i++ ) {\n      if( this.refs[ i ].rel === value ) {\n        links.push( this.refs[ i ] )\n      }\n    }\n\n    return links\n\n  }\n\n  /**\n   * Get refs where given attribute has a given value\n   * @param {String} attr\n   * @param {String} value\n   * @returns {Array<Object>}\n   */\n  get( attr, value ) {\n\n    attr = attr.toLowerCase()\n\n    var links = []\n\n    for( var i = 0; i < this.refs.length; i++ ) {\n      if( this.refs[ i ][ attr ] === value ) {\n        links.push( this.refs[ i ] )\n      }\n    }\n\n    return links\n\n  }\n\n  set( link ) {\n    this.refs.push( link )\n    return this\n  }\n\n  has( attr, value ) {\n\n    attr = attr.toLowerCase()\n\n    for( var i = 0; i < this.refs.length; i++ ) {\n      if( this.refs[ i ][ attr ] === value ) {\n        return true\n      }\n    }\n\n    return false\n\n  }\n\n  parse( value, offset ) {\n\n    offset = offset || 0\n    value = offset ? value.slice( offset ) : value\n\n    // Trim & unfold folded lines\n    value = trim( value ).replace( WS_FOLD_PATTERN, '' )\n\n    var state = STATE.IDLE\n    var length = value.length\n    var offset = 0\n    var ref = null\n\n    while( offset < length ) {\n      if( state === STATE.IDLE ) {\n        if( hasWhitespace( value[offset] ) ) {\n          offset++\n          continue\n        } else if( value[offset] === '<' ) {\n          var end = value.indexOf( '>', offset )\n          if( end === -1 ) throw new Error( 'Expected end of URI delimiter at offset ' + offset )\n          ref = { uri: value.slice( offset + 1, end ) }\n          this.refs.push( ref )\n          offset = end\n          state = STATE.URI\n        } else {\n          throw new Error( 'Unexpected character \"' + value[offset] + '\" at offset ' + offset )\n        }\n        offset++\n      } else if( state === STATE.URI ) {\n        if( hasWhitespace( value[offset] ) ) {\n          offset++\n          continue\n        } else if( value[offset] === ';' ) {\n          state = STATE.ATTR\n          offset++\n        } else if( value[offset] === ',' ) {\n          state = STATE.IDLE\n          offset++\n        } else {\n          throw new Error( 'Unexpected character \"' + value[offset] + '\" at offset ' + offset )\n        }\n      } else if( state === STATE.ATTR ) {\n        if( value[offset] ===';' || hasWhitespace( value[offset] ) ) {\n          offset++\n          continue\n        }\n        var end = value.indexOf( '=', offset )\n        if( end === -1 ) throw new Error( 'Expected attribute delimiter at offset ' + offset )\n        var attr = trim( value.slice( offset, end ) ).toLowerCase()\n        var attrValue = ''\n        offset = end + 1\n        offset = skipWhitespace( value, offset )\n        if( value[offset] === '\"' ) {\n          offset++\n          while( offset < length ) {\n            if( value[offset] === '\"' ) {\n              offset++; break\n            }\n            if( value[offset] === '\\\\' ) {\n              offset++\n            }\n            attrValue += value[offset]\n            offset++\n          }\n        } else {\n          var end = offset + 1\n          while( !DELIMITER_PATTERN.test( value[end] ) && end < length ) {\n            end++\n          }\n          attrValue = value.slice( offset, end )\n          offset = end\n        }\n        if( ref[ attr ] && Link.isSingleOccurenceAttr( attr ) ) {\n          // Ignore multiples of attributes which may only appear once\n        } else if( attr[ attr.length - 1 ] === '*' ) {\n          ref[ attr ] = Link.parseExtendedValue( attrValue )\n        } else {\n          attrValue = attr === 'rel' || attr === 'type' ?\n            attrValue.toLowerCase() : attrValue\n          if( ref[ attr ] != null ) {\n            if( Array.isArray( ref[ attr ] ) ) {\n              ref[ attr ].push( attrValue )\n            } else {\n              ref[ attr ] = [ ref[ attr ], attrValue ]\n            }\n          } else {\n            ref[ attr ] = attrValue\n          }\n        }\n        switch( value[offset] ) {\n          case ',': state = STATE.IDLE; break\n          case ';': state = STATE.ATTR; break\n        }\n        offset++\n      } else {\n        throw new Error( 'Unknown parser state \"' + state + '\"' )\n      }\n    }\n\n    ref = null\n\n    return this\n\n  }\n\n  toString() {\n\n    var refs = []\n    var link = ''\n    var ref = null\n\n    for( var i = 0; i < this.refs.length; i++ ) {\n      ref = this.refs[i]\n      link = Object.keys( this.refs[i] ).reduce( function( link, attr ) {\n        if( attr === 'uri' ) return link\n        return link + '; ' + Link.formatAttribute( attr, ref[ attr ] )\n      }, '<' + ref.uri + '>' )\n      refs.push( link )\n    }\n\n    return refs.join( ', ' )\n\n  }\n\n}\n\n/**\n * Determines whether an encoding can be\n * natively handled with a `Buffer`\n * @param {String} value\n * @returns {Boolean}\n */\nLink.isCompatibleEncoding = function( value ) {\n  return COMPATIBLE_ENCODING_PATTERN.test( value )\n}\n\nLink.parse = function( value, offset ) {\n  return new Link().parse( value, offset )\n}\n\nLink.isSingleOccurenceAttr = function( attr ) {\n  return attr === 'rel' || attr === 'type' || attr === 'media' ||\n    attr === 'title' || attr === 'title*'\n}\n\nLink.isTokenAttr = function( attr ) {\n  return attr === 'rel' || attr === 'type' || attr === 'anchor'\n}\n\nLink.escapeQuotes = function( value ) {\n  return value.replace( /\"/g, '\\\\\"' )\n}\n\n/**\n * Parses an extended value and attempts to decode it\n * @internal\n * @param {String} value\n * @return {Object}\n */\nLink.parseExtendedValue = function( value ) {\n  var parts = /([^']+)?(?:'([^']+)')?(.+)/.exec( value )\n  return {\n    language: parts[2].toLowerCase(),\n    encoding: Link.isCompatibleEncoding( parts[1] ) ?\n      null : parts[1].toLowerCase(),\n    value: Link.isCompatibleEncoding( parts[1] ) ?\n      decodeURIComponent( parts[3] ) : parts[3]\n  }\n}\n\n/**\n * Format a given extended attribute and it's value\n * @param {String} attr\n * @param {Object} data\n * @return {String}\n */\nLink.formatExtendedAttribute = function( attr, data ) {\n\n  var encoding = ( data.encoding ||'utf-8' ).toUpperCase()\n  var language = data.language || 'en'\n\n  var encodedValue = ''\n\n  if( Buffer.isBuffer( data.value ) && Link.isCompatibleEncoding( encoding ) ) {\n    encodedValue = data.value.toString( encoding )\n  } else if( Buffer.isBuffer( data.value ) ) {\n    encodedValue = data.value.toString( 'hex' )\n      .replace( /[0-9a-f]{2}/gi, '%$1' )\n  } else {\n    encodedValue = encodeURIComponent( data.value )\n  }\n\n  return attr + '=' + encoding + '\\'' +\n    language + '\\'' + encodedValue\n\n}\n\n/**\n * Format a given attribute and it's value\n * @param {String} attr\n * @param {String|Object} value\n * @return {String}\n */\nLink.formatAttribute = function( attr, value ) {\n\n  if( Array.isArray( value ) ) {\n    return value.map(( item ) => {\n      return Link.formatAttribute( attr, item )\n    }).join( '; ' )\n  }\n\n  if( attr[ attr.length - 1 ] === '*' || typeof value !== 'string' ) {\n    return Link.formatExtendedAttribute( attr, value )\n  }\n\n  if( Link.isTokenAttr( attr ) ) {\n    value = needsQuotes( value ) ?\n      '\"' + Link.escapeQuotes( value ) + '\"' :\n      Link.escapeQuotes( value )\n  } else if( needsQuotes( value ) ) {\n    value = encodeURIComponent( value )\n    // We don't need to escape <SP> <,> <;> within quotes\n    value = value\n      .replace( /%20/g, ' ' )\n      .replace( /%2C/g, ',' )\n      .replace( /%3B/g, ';' )\n\n    value = '\"' + value + '\"'\n  }\n\n  return attr + '=' + value\n\n}\n\nmodule.exports = Link\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(\n      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)\n    ))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","/* jshint esversion: 6 */\n/* jslint node: true */\n'use strict';\n\nmodule.exports = function (object) {\n  return serialize(object);\n\n  function serialize (object) {\n    if (object === null || typeof object !== 'object' || object.toJSON != null) {\n      return JSON.stringify(object);\n    }\n    if (Array.isArray(object) && object.length === 0) {\n      return '[]';\n    }\n    if (Array.isArray(object) && object.length === 1) {\n      return '[' + serialize(object[0]) + ']';\n    }\n    if (Array.isArray(object)) {\n      return '[' + object.reduce((t, cv, ci) => {\n        t = (ci === 1 ? serialize(t) : t);\n        return t + ',' + serialize(cv);\n      }) + ']';\n    }\n    const keys = Object.keys(object);\n    if (keys.length === 0) {\n      return '{}';\n    }\n    if (keys.length === 1) {\n      return '{' + serialize(keys[0]) + ':' + serialize(object[keys[0]]) + '}';\n    }\n    return '{' + keys.sort().reduce((t, cv, ci) => {\n      t = (ci === 1 ? serialize(t) + ':' + serialize(object[t]) : t);\n      return t + ',' + serialize(cv) + ':' + serialize(object[cv]);\n    }) + '}';\n  }\n};\n","var BlankNode = require('./blank-node')\nvar DefaultGraph = require('./default-graph')\nvar Literal = require('./literal')\nvar NamedNode = require('./named-node')\nvar Quad = require('./quad')\nvar Variable = require('./variable')\n\nfunction DataFactory () {}\n\nDataFactory.namedNode = function (value) {\n  return new NamedNode(value)\n}\n\nDataFactory.blankNode = function (value) {\n  return new BlankNode(value)\n}\n\nDataFactory.literal = function (value, languageOrDatatype) {\n  if (typeof languageOrDatatype === 'string') {\n    if (languageOrDatatype.indexOf(':') === -1) {\n      return new Literal(value, languageOrDatatype)\n    }\n\n    return new Literal(value, null, DataFactory.namedNode(languageOrDatatype))\n  }\n\n  return new Literal(value, null, languageOrDatatype)\n}\n\nDataFactory.defaultGraph = function () {\n  return DataFactory.defaultGraphInstance\n}\n\nDataFactory.variable = function (value) {\n  return new Variable(value)\n}\n\nDataFactory.triple = function (subject, predicate, object) {\n  return DataFactory.quad(subject, predicate, object)\n}\n\nDataFactory.quad = function (subject, predicate, object, graph) {\n  return new Quad(subject, predicate, object, graph || DataFactory.defaultGraphInstance)\n}\n\nDataFactory.defaultGraphInstance = new DefaultGraph()\n\nmodule.exports = DataFactory\n","function BlankNode (id) {\n  this.value = id || ('b' + (++BlankNode.nextId))\n}\n\nBlankNode.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType && other.value === this.value\n}\n\nBlankNode.prototype.termType = 'BlankNode'\n\nBlankNode.nextId = 0\n\nmodule.exports = BlankNode\n","var NamedNode = require('./named-node')\n\nfunction Literal (value, language, datatype) {\n  this.value = value\n  this.datatype = Literal.stringDatatype\n  this.language = ''\n\n  if (language) {\n    this.language = language\n    this.datatype = Literal.langStringDatatype\n  } else if (datatype) {\n    this.datatype = datatype\n  }\n}\n\nLiteral.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType && other.value === this.value &&\n    other.language === this.language && other.datatype.equals(this.datatype)\n}\n\nLiteral.prototype.termType = 'Literal'\nLiteral.langStringDatatype = new NamedNode('http://www.w3.org/1999/02/22-rdf-syntax-ns#langString')\nLiteral.stringDatatype = new NamedNode('http://www.w3.org/2001/XMLSchema#string')\n\nmodule.exports = Literal\n","var DefaultGraph = require('./default-graph')\n\nfunction Quad (subject, predicate, object, graph) {\n  this.subject = subject\n  this.predicate = predicate\n  this.object = object\n\n  if (graph) {\n    this.graph = graph\n  } else {\n    this.graph = new DefaultGraph()\n  }\n}\n\nQuad.prototype.equals = function (other) {\n  return !!other && other.subject.equals(this.subject) && other.predicate.equals(this.predicate) &&\n    other.object.equals(this.object) && other.graph.equals(this.graph)\n}\n\nmodule.exports = Quad\n","function Variable (name) {\n  this.value = name\n}\n\nVariable.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType && other.value === this.value\n}\n\nVariable.prototype.termType = 'Variable'\n\nmodule.exports = Variable\n","const done = {};\n/**\n * Returns the elements of the iterable as an array\n */\n\nexport async function iterableToArray(iterable) {\n  const items = [];\n\n  for await (const item of iterable) items.push(item);\n\n  return items;\n}\n/**\n * Gets the first element of the iterable.\n */\n\nexport function getFirstItem(iterable) {\n  const iterator = iterable[Symbol.asyncIterator]();\n  return iterator.next().then(item => item.value);\n}\n/**\n * Creates an async iterator with the item as only element.\n */\n\nexport function iteratorFor(item) {\n  return {\n    async next() {\n      if (item !== done) {\n        const value = await item;\n        item = done;\n        return {\n          value\n        };\n      }\n\n      return {\n        done: true\n      };\n    }\n\n  };\n}","/**\n * Resolves to the given item in the path data.\n * For example, new DataHandler({}, 'foo', 'bar')\n * will return pathData.foo.bar.\n *\n * Resolution can optionally be async,\n * and/or be behind a function call.\n */\nexport default class DataHandler {\n  constructor(options, ...dataProperties) {\n    this._isAsync = options.async;\n    this._isFunction = options.function;\n    this._dataProperties = dataProperties;\n  }\n\n  static sync(...dataProperties) {\n    return new DataHandler({\n      async: false\n    }, ...dataProperties);\n  }\n\n  static syncFunction(...dataProperties) {\n    return new DataHandler({\n      async: false,\n      function: true\n    }, ...dataProperties);\n  }\n\n  static async(...dataProperties) {\n    return new DataHandler({\n      async: true\n    }, ...dataProperties);\n  }\n\n  static asyncFunction(...dataProperties) {\n    return new DataHandler({\n      async: true,\n      function: true\n    }, ...dataProperties);\n  } // Resolves the data path, or returns a function that does so\n\n\n  handle(pathData) {\n    return !this._isFunction ? this._resolveDataPath(pathData) : () => this._resolveDataPath(pathData);\n  } // Resolves the data path\n\n\n  _resolveDataPath(data) {\n    return !this._isAsync ? this._resolveSyncDataPath(data) : this._resolveAsyncDataPath(data);\n  } // Resolves synchronous property access\n\n\n  _resolveSyncDataPath(data) {\n    for (const property of this._dataProperties) data = data && data[property];\n\n    return data;\n  } // Resolves asynchronous property access\n\n\n  async _resolveAsyncDataPath(data) {\n    for (const property of this._dataProperties) data = data && (await data[property]);\n\n    return data;\n  }\n\n}","import { getFirstItem } from './iterableUtils';\n/**\n * Returns a lazy thenable to the created promise.\n */\n\nexport function lazyThenable(createPromise) {\n  return {\n    then: getThen(createPromise)\n  };\n}\n/**\n * Lazily returns the `then` function of the created promise.\n */\n\nexport function getThen(createPromise) {\n  return (onResolved, onRejected) => createPromise().then(onResolved, onRejected);\n}\n/**\n * Returns an iterable that is also a promise to the first element.\n */\n\nexport function toIterablePromise(iterable) {\n  // If called with a generator function,\n  // memoize it to enable multiple iterations\n  if (typeof iterable === 'function') iterable = memoizeIterable(iterable()); // Return an object that is iterable and a promise\n\n  return {\n    [Symbol.asyncIterator]() {\n      return iterable[Symbol.asyncIterator]();\n    },\n\n    get then() {\n      return getThen(() => getFirstItem(this));\n    },\n\n    catch(onRejected) {\n      return this.then(null, onRejected);\n    },\n\n    finally(callback) {\n      return this.then().finally(callback);\n    }\n\n  };\n}\n/**\n * Returns a memoized version of the iterable\n * that can be iterated over as many times as needed.\n */\n\nexport function memoizeIterable(iterable) {\n  const cache = [];\n  let iterator = iterable[Symbol.asyncIterator]();\n  return {\n    [Symbol.asyncIterator]() {\n      let i = 0;\n      return {\n        async next() {\n          // Return the item if it has been read already\n          if (i < cache.length) return cache[i++]; // Stop if there are no more items\n\n          if (!iterator) return {\n            done: true\n          }; // Read and cache an item from the iterable otherwise\n\n          const item = cache[i++] = iterator.next();\n          if ((await item).done) iterator = null;\n          return item;\n        }\n\n      };\n    }\n\n  };\n}","import { namedNode, literal } from '@rdfjs/data-model';\nconst xsd = 'http://www.w3.org/2001/XMLSchema#';\nconst xsdBoolean = `${xsd}boolean`;\nconst xsdDateTime = `${xsd}dateTime`;\nconst xsdDecimal = `${xsd}decimal`;\nconst xsdDouble = `${xsd}double`;\nconst xsdFloat = `${xsd}float`;\nconst xsdInteger = `${xsd}integer`;\nconst xsdBooleanTerm = namedNode(xsdBoolean);\nconst xsdDateTimeTerm = namedNode(xsdDateTime);\nconst xsdDecimalTerm = namedNode(xsdDecimal);\nconst xsdDoubleTerm = namedNode(xsdDouble);\nconst xsdIntegerTerm = namedNode(xsdInteger);\nconst xsdTrue = literal('true', xsdBooleanTerm);\nconst xsdFalse = literal('false', xsdBooleanTerm);\nconst xsdNaN = literal('NaN', xsdDoubleTerm);\nconst xsdInf = literal('INF', xsdDoubleTerm);\nconst xsdMinusInf = literal('-INF', xsdDoubleTerm);\nconst xsdPrimitives = {\n  NaN,\n  'INF': Infinity,\n  '-INF': -Infinity\n}; // Checks whether the value is asynchronously iterable\n\nexport function isAsyncIterable(value) {\n  return value && typeof value[Symbol.asyncIterator] === 'function';\n} // Checks whether the value is an object without special meaning to LDflex\n\nexport function isPlainObject(value) {\n  return value !== null && // Ignore non-objects\n  typeof value === 'object' && // Ignore arrays\n  !Array.isArray(value) && // Ignore dates\n  !(value instanceof Date) && // Ignore Promise instances\n  typeof value.then !== 'function' && // Ignore RDF/JS Term instances\n  typeof value.termType !== 'string' && // Ignore LDflex paths\n  !isAsyncIterable(value);\n} // Checks whether the arguments consist of exactly one plain object\n\nexport function hasPlainObjectArgs(args, allowMultiple = false) {\n  const hasPlainObject = args.some(isPlainObject);\n  if (hasPlainObject && !allowMultiple && args.length !== 1) throw new Error(`Expected only 1 plain object, but got ${args.length} arguments`);\n  return hasPlainObject;\n} // Ensures that the value is an array\n\nexport function ensureArray(value) {\n  if (Array.isArray(value)) return value;\n  return value ? [value] : [];\n} // Joins the arrays into a single array\n\nexport function joinArrays(arrays) {\n  return [].concat(...arrays);\n} // Ensures the value is an RDF/JS term\n\nexport function valueToTerm(value) {\n  switch (typeof value) {\n    // strings\n    case 'string':\n      return literal(value);\n    // booleans\n\n    case 'boolean':\n      return value ? xsdTrue : xsdFalse;\n    // numbers\n\n    case 'number':\n      if (Number.isInteger(value)) return literal(value.toString(), xsdIntegerTerm);else if (Number.isFinite(value)) return literal(value.toString(), xsdDecimalTerm);else if (value === Infinity) return xsdInf;else if (value === -Infinity) return xsdMinusInf;\n      return xsdNaN;\n    // other objects\n\n    default:\n      if (value) {\n        // RDF/JS Term\n        if (typeof value.termType === 'string') return value; // Date\n\n        if (value instanceof Date) return literal(value.toISOString(), xsdDateTimeTerm);\n      }\n\n  } // invalid objects\n\n\n  throw new Error(`Invalid object: ${value}`);\n} // Converts the term into a primitive value\n\nexport function termToPrimitive(term) {\n  const {\n    termType,\n    value\n  } = term; // Some literals convert into specific primitive values\n\n  if (termType === 'Literal') {\n    const datatype = term.datatype.value;\n\n    if (datatype.startsWith(xsd)) {\n      switch (datatype) {\n        case xsdBoolean:\n          return value === 'true' || value === '1';\n\n        case xsdInteger:\n          return Number.parseInt(value, 10);\n\n        case xsdDecimal:\n          return Number.parseFloat(value);\n\n        case xsdDouble:\n        case xsdFloat:\n          if (value in xsdPrimitives) return xsdPrimitives[value];\n          return Number.parseFloat(value);\n\n        case xsdDateTime:\n          return new Date(Date.parse(value));\n\n        default:\n      }\n    }\n  } // All other nodes convert to their value\n\n\n  return value;\n}","import { lazyThenable } from './promiseUtils';\nimport { iterableToArray } from './iterableUtils';\nimport { ensureArray, joinArrays, valueToTerm, hasPlainObjectArgs, isAsyncIterable } from './valueUtils';\n/**\n * Returns a function that, when called with arguments,\n * extends the path with mutationExpressions.\n *\n * Mutation functions can be called in two equivalent ways:\n * - path.property.set(object, object)\n * - path.set({ property: [object, object] })\n * Objects can be strings, terms, or path expressions.\n * The second syntax allows setting multiple properties at once.\n * It also has `null` and `undefined` as shortcuts for the empty array,\n * and a direct value as shortcut for a single-valued array.\n *\n * Requires:\n * - a pathExpression property on the path proxy and all non-raw arguments.\n */\n\nexport default class MutationFunctionHandler {\n  constructor(mutationType, allowZeroArgs) {\n    this._mutationType = mutationType;\n    this._allowZeroArgs = allowZeroArgs;\n  } // Creates a function that performs a mutation\n\n\n  handle(pathData, path) {\n    return (...args) => {\n      // Check if the given arguments are valid\n      if (!this._allowZeroArgs && !args.length) throw new Error('Mutation cannot be invoked without arguments'); // Create a lazy Promise to the mutation expressions\n\n      const mutationExpressions = lazyThenable(() => this.createMutationExpressions(pathData, path, args));\n      return pathData.extendPath({\n        mutationExpressions\n      });\n    };\n  } // Creates expressions that represent the requested mutation\n\n\n  async createMutationExpressions(pathData, path, args) {\n    // The mutation targets a single property on the path by passing objects\n    if (!hasPlainObjectArgs(args)) return [await this.createMutationExpression(pathData, path, args)]; // The mutation targets multiple properties through a map of property-objects pairs\n\n    const pairs = Object.entries(args[0]);\n    const expressions = await Promise.all(pairs.map(([property, values]) => this.createMutationExpression(pathData, path[property], ensureArray(values)))); // Group expressions together to maintain the same structure as the singular case\n    // (All properties have the same parent path, and hence the same condition)\n\n    return [expressions.length === 0 ? {} : { ...expressions[0],\n      predicateObjects: joinArrays(expressions.map(e => e.predicateObjects))\n    }];\n  } // Creates an expression that represents a mutation with the given objects\n\n\n  async createMutationExpression(pathData, path, values) {\n    // Obtain the path segments, which are the selection conditions for the mutation\n    const conditions = await path.pathExpression;\n    if (!Array.isArray(conditions)) throw new Error(`${pathData} has no pathExpression property`);\n    if (conditions.length < 2) throw new Error(`${pathData} should at least contain a subject and a predicate`); // Obtain the predicate and target objects\n\n    const {\n      predicate,\n      reverse\n    } = conditions[conditions.length - 1];\n    if (!predicate) throw new Error(`Expected predicate in ${pathData}`);\n    const objects = await this.extractObjects(pathData, path, values); // Create a mutation, unless no objects are affected (`null` means all)\n\n    return objects !== null && objects.length === 0 ? {} : {\n      mutationType: this._mutationType,\n      conditions: conditions.slice(0, -1),\n      predicateObjects: [{\n        predicate,\n        reverse,\n        objects\n      }]\n    };\n  } // Extracts individual objects from a set of values passed to a mutation function\n\n\n  async extractObjects(pathData, path, values) {\n    // If no specific values are specified, match all (represented by `null`)\n    if (values.length === 0) return null; // Otherwise, expand singular values, promises, and paths\n\n    const objects = [];\n\n    for (const value of values) {\n      if (!isAsyncIterable(value)) // Add a (promise to) a single value\n        objects.push((await value)); // Add multiple values from a path\n      else objects.push(...(await iterableToArray(value)));\n    }\n\n    return objects.map(valueToTerm);\n  }\n\n}","import MutationFunctionHandler from './MutationFunctionHandler';\n/**\n * A MutationFunctionHandler for deletions.\n */\n\nexport default class DeleteFunctionHandler extends MutationFunctionHandler {\n  constructor() {\n    super('DELETE', true);\n  }\n\n}","const VARIABLE = /(SELECT\\s+)(\\?\\S+)/;\nconst QUERY_TAIL = /\\}[^}]*$/;\n/**\n * Returns a function that preloads and caches\n * certain properties of results on the current path.\n *\n * Requires:\n * - a predicate handler on the path proxy\n * - a queryEngine property in the path settings\n *\n * Creates:\n * - a resultsCache property on the path data\n */\n\nexport default class PreloadHandler {\n  /**\n   * Creates a preload function.\n   */\n  handle(pathData, pathProxy) {\n    return async (...properties) => {\n      if (properties.length > 0) {\n        // Map the properties to predicates\n        const predicates = await Promise.all(properties.map(async p => (await pathProxy[p].predicate).value)); // Create and attach the results cache to the path data\n\n        pathData.resultsCache = await this.createResultsCache(predicates, pathData, pathProxy);\n      }\n\n      return pathProxy;\n    };\n  }\n  /**\n   * Creates a cache for the results of\n   * resolving the given predicates against the path.\n   */\n\n\n  async createResultsCache(predicates, pathData, path) {\n    // Execute the preloading query\n    const {\n      query,\n      vars,\n      resultVar\n    } = await this.createQuery(predicates, path);\n    const {\n      settings: {\n        queryEngine\n      }\n    } = pathData;\n    const bindings = queryEngine.execute(query); // Extract all results and their preloaded property values\n\n    const resultsCache = {};\n    const propertyCaches = {};\n\n    for await (const binding of bindings) {\n      // Initialize the result's cache if needed\n      const result = binding.get(resultVar),\n            hash = hashTerm(result);\n\n      if (!(hash in resultsCache)) {\n        // Create the property cache\n        const propertyCache = propertyCaches[hash] = {};\n\n        for (const predicate of predicates) propertyCache[predicate] = []; // Create the result path\n\n\n        const resultData = {\n          subject: result,\n          propertyCache\n        };\n        resultsCache[hash] = pathData.extendPath(resultData, null);\n      } // Create and cache a possible property value path from the binding\n\n\n      const propertyCache = propertyCaches[hash];\n\n      for (let i = 0; i < vars.length; i++) {\n        const value = binding.get(vars[i]);\n\n        if (value) {\n          const valuePath = pathData.extendPath({\n            subject: value\n          }, null);\n          propertyCache[predicates[i]].push(valuePath);\n        }\n      }\n    }\n\n    return Object.values(resultsCache);\n  }\n  /**\n   * Creates the query for preloading the given predicates on the path\n   */\n\n\n  async createQuery(predicates, path) {\n    // Obtain the query for the current path, and its main variable\n    const parentQuery = await path.sparql;\n    const variableMatch = VARIABLE.exec(parentQuery);\n    if (!variableMatch) throw new Error(`Unexpected path query: ${parentQuery}`);\n    const resultVar = variableMatch[2]; // Modify the query to include the preload clauses\n    // TODO: instead of query manipulation, adjust the query generator\n    // TODO: support reverse predicates\n\n    const vars = predicates.map((p, i) => `?preload_${i}`);\n    const preloadClauses = predicates.map((predicate, i) => `    { ${resultVar} <${predicate}> ${vars[i]}. }`).join('\\n    UNION\\n');\n    const query = parentQuery.replace(VARIABLE, `$1$2 ${vars.join(' ')}`).replace(QUERY_TAIL, `  OPTIONAL {\\n${preloadClauses}\\n  }\\n$&`);\n    return {\n      query,\n      vars,\n      resultVar\n    };\n  }\n\n} // Returns a unique string representation of the term\n\nfunction hashTerm(term) {\n  const {\n    termType,\n    value\n  } = term;\n\n  switch (termType) {\n    case 'NamedNode':\n      return value;\n\n    case 'Literal':\n      const {\n        language,\n        datatype\n      } = term;\n      return `${termType}|${language}|${datatype.value}|${value}`;\n\n    default:\n      return `${termType}|${value}`;\n  }\n}","/**\n * Returns a function that creates a new path with the same values,\n * but sorted on the given property.\n * The function accepts multiple properties to sort on a deeper path.\n *\n * Requires:\n *  - a predicate on the path proxy\n *  - a sort function on the path proxy (for multi-property sorting)\n */\nexport default class SortHandler {\n  constructor(order = 'ASC') {\n    this.order = order;\n  }\n\n  handle(pathData, pathProxy) {\n    return (...properties) => {\n      // Do nothing if no sort properties were given\n      if (properties.length === 0) return pathProxy; // Split off the first sort property and obtain its predicate\n\n      const [property, ...rest] = properties;\n      const {\n        predicate\n      } = pathProxy[property]; // Sort on the first property, and create paths for the next one\n\n      const childData = {\n        property,\n        predicate,\n        sort: this.order\n      };\n      const childPath = pathData.extendPath(childData);\n      return rest.length === 0 ? childPath : childPath.sort(...rest);\n    };\n  }\n\n}","import { namedNode } from '@rdfjs/data-model';\nconst NEEDS_ESCAPE = /[\"\\\\\\t\\n\\r\\b\\f\\u0000-\\u0019\\ud800-\\udbff]/,\n      ESCAPE_ALL = /[\"\\\\\\t\\n\\r\\b\\f\\u0000-\\u0019]|[\\ud800-\\udbff][\\udc00-\\udfff]/g,\n      ESCAPED_CHARS = {\n  '\\\\': '\\\\\\\\',\n  '\"': '\\\\\"',\n  '\\t': '\\\\t',\n  '\\n': '\\\\n',\n  '\\r': '\\\\r',\n  '\\b': '\\\\b',\n  '\\f': '\\\\f'\n};\n/**\n * Expresses a path or mutation as a SPARQL query.\n *\n * Requires:\n * - a mutationExpressions or pathExpression property on the path proxy\n */\n\nexport default class SparqlHandler {\n  async handle(pathData, path) {\n    // First check if we have a mutation expression\n    const mutationExpressions = await path.mutationExpressions;\n    if (Array.isArray(mutationExpressions) && mutationExpressions.length) // Remove empty results to prevent dangling semicolons\n      return mutationExpressions.map(e => this.mutationExpressionToQuery(e)).filter(Boolean).join('\\n;\\n'); // Otherwise, fall back to checking for a path expression\n\n    const pathExpression = await path.pathExpression;\n    if (!Array.isArray(pathExpression)) throw new Error(`${pathData} has no pathExpression property`);\n    return this.pathExpressionToQuery(pathData, path, pathExpression);\n  }\n\n  pathExpressionToQuery(pathData, path, pathExpression) {\n    if (pathExpression.length < 2 && !pathData.finalClause) throw new Error(`${pathData} should at least contain a subject and a predicate`); // Create triple patterns\n\n    let queryVar = '?subject',\n        sorts = [],\n        clauses = [];\n\n    if (pathExpression.length > 1) {\n      queryVar = this.createVar(pathData.property);\n      ({\n        queryVar,\n        sorts,\n        clauses\n      } = this.expressionToTriplePatterns(pathExpression, queryVar));\n    }\n\n    if (pathData.finalClause) clauses.push(pathData.finalClause(queryVar)); // Create SPARQL query body\n\n    const distinct = pathData.distinct ? 'DISTINCT ' : '';\n    const select = `SELECT ${distinct}${pathData.select ? pathData.select : queryVar}`;\n    const where = ` WHERE {\\n  ${clauses.join('\\n  ')}\\n}`;\n    const orderClauses = sorts.map(({\n      order,\n      variable\n    }) => `${order}(${variable})`);\n    const orderBy = orderClauses.length === 0 ? '' : `\\nORDER BY ${orderClauses.join(' ')}`;\n    return `${select}${where}${orderBy}`;\n  }\n\n  mutationExpressionToQuery({\n    mutationType,\n    conditions,\n    predicateObjects\n  }) {\n    // If there are no mutations, there is no query\n    if (!mutationType || !conditions || predicateObjects && predicateObjects.length === 0) return ''; // Create the WHERE clauses\n\n    const scope = {};\n    let subject, where; // If the only condition is a subject, we need no WHERE clause\n\n    if (conditions.length === 1) {\n      subject = this.termToString(conditions[0].subject);\n      where = [];\n    } // Otherwise, create a WHERE clause from all conditions\n    else {\n        const lastPredicate = conditions[conditions.length - 1].predicate;\n        subject = this.createVar(lastPredicate.value, scope);\n        ({\n          queryVar: subject,\n          clauses: where\n        } = this.expressionToTriplePatterns(conditions, subject, scope));\n      } // Create the mutation clauses\n\n\n    const mutations = [];\n\n    for (const {\n      predicate,\n      reverse,\n      objects\n    } of predicateObjects) {\n      // Mutate either only the specified objects, or all of them\n      const objectStrings = objects ? objects.map(o => this.termToString(o)) : [this.createVar(predicate.value, scope)]; // Generate a triple pattern for all subjects\n\n      mutations.push(...this.triplePatterns(subject, predicate, objectStrings, reverse));\n    }\n\n    const mutationClauses = `{\\n  ${mutations.join('\\n  ')}\\n}`; // Join clauses into a SPARQL query\n\n    return where.length === 0 ? // If there are no WHERE clauses, just mutate raw data\n    `${mutationType} DATA ${mutationClauses}` : // Otherwise, return a DELETE/INSERT ... WHERE ... query\n    `${mutationType} ${mutationClauses} WHERE {\\n  ${where.join('\\n  ')}\\n}`;\n  }\n\n  expressionToTriplePatterns([root, ...pathExpression], lastVar, scope = {}) {\n    const lastIndex = pathExpression.length - 1;\n    const clauses = [];\n    const sorts = [];\n    let object = this.termToString(skolemize(root.subject));\n    let queryVar = object;\n    let allowValues = false;\n    pathExpression.forEach((segment, index) => {\n      // Obtain components and generate triple pattern\n      const subject = object;\n      const {\n        predicate,\n        reverse,\n        sort,\n        values\n      } = segment; // Use fixed object values values if they were specified\n\n      let objects;\n\n      if (values && values.length > 0) {\n        if (!allowValues) throw new Error('Specifying fixed values is not allowed here');\n        objects = values.map(this.termToString);\n        allowValues = false; // disallow subsequent fixed values for this predicate\n      } // Otherwise, use a variable subject\n      else {\n          object = index < lastIndex ? this.createVar(`v${index}`, scope) : lastVar;\n          objects = [object];\n          allowValues = true;\n        }\n\n      clauses.push(...this.triplePatterns(subject, predicate, objects, reverse)); // If the sort option was not set, use this object as a query variable\n\n      if (!sort) {\n        queryVar = object;\n      } // If sort was set, use this object as a sorting variable\n      else {\n          // TODO: handle when an object is used for sorting, and later also for querying\n          sorts.push({\n            variable: object,\n            order: sort\n          }); // TODO: use a descriptive lastVar in case of sorting\n\n          object = queryVar;\n        }\n    });\n    return {\n      queryVar,\n      sorts,\n      clauses\n    };\n  } // Creates a unique query variable within the given scope, based on the suggestion\n\n\n  createVar(suggestion = '', scope) {\n    let counter = 0;\n    let label = `?${suggestion.match(/[a-z0-9]*$/i)[0] || 'result'}`;\n\n    if (scope) {\n      suggestion = label;\n\n      while (scope[label]) label = `${suggestion}_${counter++}`;\n\n      scope[label] = true;\n    }\n\n    return label;\n  } // Converts an RDFJS term to a string that we can use in a query\n\n\n  termToString(term) {\n    // Determine escaped value\n    let {\n      value\n    } = term;\n    if (NEEDS_ESCAPE.test(value)) value = value.replace(ESCAPE_ALL, escapeCharacter);\n\n    switch (term.termType) {\n      case 'NamedNode':\n        return `<${value}>`;\n\n      case 'BlankNode':\n        return `_:${value}`;\n\n      case 'Literal':\n        // Determine optional language or datatype\n        let suffix = '';\n        if (term.language) suffix = `@${term.language}`;else if (term.datatype.value !== 'http://www.w3.org/2001/XMLSchema#string') suffix = `^^<${term.datatype.value}>`;\n        return `\"${value}\"${suffix}`;\n\n      default:\n        throw new Error(`Could not convert a term of type ${term.termType}`);\n    }\n  } // Creates triple patterns for the given subject, predicate, and objects\n\n\n  triplePatterns(subjectString, predicateTerm, objectStrings, reverse = false) {\n    let subjectStrings = [subjectString];\n    if (reverse) [subjectStrings, objectStrings] = [objectStrings, subjectStrings];\n    const objects = objectStrings.join(', ');\n    return subjectStrings.map(s => `${s} <${predicateTerm.value}> ${objects}.`);\n  }\n\n} // Replaces a character by its escaped version\n// (borrowed from https://www.npmjs.com/package/n3)\n\nfunction escapeCharacter(character) {\n  // Replace a single character by its escaped version\n  let result = ESCAPED_CHARS[character];\n\n  if (result === undefined) {\n    // Replace a single character with its 4-bit unicode escape sequence\n    if (character.length === 1) {\n      result = character.charCodeAt(0).toString(16);\n      result = '\\\\u0000'.substr(0, 6 - result.length) + result;\n    } // Replace a surrogate pair with its 8-bit unicode escape sequence\n    else {\n        result = ((character.charCodeAt(0) - 0xD800) * 0x400 + character.charCodeAt(1) + 0x2400).toString(16);\n        result = '\\\\U00000000'.substr(0, 10 - result.length) + result;\n      }\n  }\n\n  return result;\n} // Skolemizes the given term if it is a blank node\n\n\nlet skolemId = 0;\n\nfunction skolemize(term) {\n  if (term.termType !== 'BlankNode') return term;\n  if (!term.skolemized) term.skolemized = namedNode(`urn:ldflex:sk${skolemId++}`);\n  return term.skolemized;\n}","import AsyncIteratorHandler from './AsyncIteratorHandler';\nimport DataHandler from './DataHandler';\nimport DeleteFunctionHandler from './DeleteFunctionHandler';\nimport ExecuteQueryHandler from './ExecuteQueryHandler';\nimport GetHandler from './GetFunctionHandler';\nimport InsertFunctionHandler from './InsertFunctionHandler';\nimport MutationExpressionsHandler from './MutationExpressionsHandler';\nimport PathExpressionHandler from './PathExpressionHandler';\nimport PredicateHandler from './PredicateHandler';\nimport PredicatesHandler from './PredicatesHandler';\nimport PreloadHandler from './PreloadHandler';\nimport PropertiesHandler from './PropertiesHandler';\nimport ReplaceFunctionHandler from './ReplaceFunctionHandler';\nimport SetFunctionHandler from './SetFunctionHandler';\nimport SortHandler from './SortHandler';\nimport SparqlHandler from './SparqlHandler';\nimport StringToLDflexHandler from './StringToLDflexHandler';\nimport SubjectHandler from './SubjectHandler';\nimport SubjectsHandler from './SubjectsHandler';\nimport ThenHandler from './ThenHandler';\nimport ToArrayHandler from './ToArrayHandler';\nimport { termToPrimitive } from './valueUtils';\n/**\n * A map with default property handlers.\n */\n\nexport default {\n  // Flag to loaders that exported paths are not ES6 modules\n  __esModule: () => undefined,\n  // Add thenable and async iterable behavior\n  then: new ThenHandler(),\n  [Symbol.asyncIterator]: new AsyncIteratorHandler(),\n  // Add read and query functionality\n  get: new GetHandler(),\n  subject: new SubjectHandler(),\n  predicate: new PredicateHandler(),\n  properties: new PropertiesHandler(),\n  predicates: new PredicatesHandler(),\n  pathExpression: new PathExpressionHandler(),\n  sparql: new SparqlHandler(),\n  subjects: new SubjectsHandler(),\n  results: new ExecuteQueryHandler(),\n  sort: new SortHandler('ASC'),\n  sortDesc: new SortHandler('DESC'),\n  preload: new PreloadHandler(),\n  // Add write functionality\n  mutationExpressions: new MutationExpressionsHandler(),\n  add: new InsertFunctionHandler(),\n  set: new SetFunctionHandler(),\n  replace: new ReplaceFunctionHandler(),\n  delete: new DeleteFunctionHandler(),\n  // Add RDFJS term handling\n  termType: termPropertyHandler('termType'),\n  value: termPropertyHandler('value'),\n  datatype: termPropertyHandler('datatype'),\n  language: termPropertyHandler('language'),\n  canonical: termPropertyHandler('canonical'),\n  equals: DataHandler.sync('subject', 'equals'),\n  toString: DataHandler.syncFunction('subject', 'value'),\n  valueOf: subjectToPrimitiveHandler(),\n  toPrimitive: subjectToPrimitiveHandler(),\n  // Add iteration helpers\n  toArray: new ToArrayHandler(),\n  termTypes: handler((_, path) => path.toArray(term => term.termType)),\n  values: handler((_, path) => path.toArray(term => term.value)),\n  datatypes: handler((_, path) => path.toArray(term => term.datatype)),\n  languages: handler((_, path) => path.toArray(term => term.language)),\n  // Parse a string into an LDflex object\n  resolve: new StringToLDflexHandler()\n}; // Creates a handler from the given function\n\nfunction handler(handle) {\n  return {\n    handle\n  };\n} // Creates a handler for the given RDF/JS Term property\n\n\nfunction termPropertyHandler(property) {\n  // If a resolved subject is present,\n  // behave as an RDF/JS term and synchronously expose the property;\n  // otherwise, return a promise to the property value\n  return handler(({\n    subject\n  }, path) => subject && property in subject ? subject[property] : path.then && path.then(term => term === null || term === void 0 ? void 0 : term[property]));\n} // Creates a handler that converts the subject into a primitive\n\n\nfunction subjectToPrimitiveHandler() {\n  return handler(({\n    subject\n  }) => () => typeof (subject === null || subject === void 0 ? void 0 : subject.termType) !== 'string' ? undefined : termToPrimitive(subject));\n}","import { getThen } from './promiseUtils';\nimport { getFirstItem } from './iterableUtils';\n/**\n * Thenable handler that resolves to either the subject\n * of the first item of the results.\n *\n * Requires:\n *  - (optional) a subject on the path data\n *  - (optional) a subject on the path proxy\n *  - (optional) results on the path proxy\n */\n\nexport default class ThenHandler {\n  handle({\n    subject\n  }, pathProxy) {\n    // Resolve to either the subject (zero-length path) or the first result\n    return subject ? // If the subject is not a promise, it has already been resolved;\n    // consumers should not resolve it, but access its properties directly.\n    // This avoids infinite `then` chains when `await`ing this path.\n    subject.then && getThen(() => pathProxy.subject) : // Otherwise, return the first result of this path\n    getThen(() => getFirstItem(pathProxy.results));\n  }\n\n}","import { iteratorFor } from './iterableUtils';\n/**\n * AsyncIterator handler that yields either the subject or all results.\n *\n * Requires:\n *  - (optional) a subject on the path data\n *  - (optional) a subject on the path proxy\n *  - (optional) results on the path proxy\n */\n\nexport default class AsyncIteratorHandler {\n  handle({\n    subject\n  }, pathProxy) {\n    // Return a one-item iterator of the subject if present;\n    // otherwise, return all results of this path\n    return subject ? () => iteratorFor(pathProxy.subject) : () => pathProxy.results[Symbol.asyncIterator]();\n  }\n\n}","import { isPlainObject, isAsyncIterable } from './valueUtils';\nimport { iterableToArray } from './iterableUtils';\n/**\n * Returns a function that requests the values of multiple properties.\n * You can use this function to access properties as follows:\n * - fn() returns []\n * - fn(p1) returns [path[p1]]\n * - fn(p1, p2) returns [path[p1], path[p2]]\n * - fn([p1, p2]) returns [path[p1], path[p2]]\n * - fn(asyncIterable) returns [path[p1], path[p2]]\n * - fn({ p1: null, p2: null }) returns { p1: path[p1], p2: path[p2] }\n * Combinations of the above are possible by passing them in arrays.\n */\n\nexport default class GetFunctionHandler {\n  handle(pathData, path) {\n    return (...args) => this.readProperties(path, args.length === 1 ? args[0] : args, true);\n  }\n\n  async readProperties(path, properties, wrapSingleValues = false) {\n    // Convert an async iterable to an array\n    if (isAsyncIterable(properties)) properties = await iterableToArray(properties); // If passed an array, read every property\n\n    if (Array.isArray(properties)) {\n      const values = properties.map(p => this.readProperties(path, p));\n      return Promise.all(values);\n    } // If passed an object with property names as keys,\n    // return an object with the values filled in\n\n\n    if (isPlainObject(properties)) {\n      // Use the key as property value if none is specified\n      const keys = Object.keys(properties);\n      properties = keys.map(key => properties[key] || key); // Store the resolved properties by key\n\n      const results = {};\n      const values = await this.readProperties(path, properties);\n\n      for (let i = 0; i < keys.length; i++) results[keys[i]] = values[i];\n\n      return results;\n    } // Otherwise, perform a single property access\n\n\n    const value = path[properties];\n    return wrapSingleValues ? [value] : value;\n  }\n\n}","/**\n * Returns a new path starting from the subject of the current path.\n *\n * Requires:\n * - (optional) a subject property on the path data\n * - (optional) a parent property on the path data\n */\nexport default class SubjectHandler {\n  handle(pathData) {\n    // Traverse parents until we find a subject\n    let {\n      subject,\n      parent\n    } = pathData;\n\n    while (!subject && parent) ({\n      subject,\n      parent\n    } = parent); // Resolve the subject if it exists,\n    // and return a path starting from that subject\n\n\n    return !subject ? undefined : Promise.resolve(subject).then(value => pathData.extendPath({\n      subject: value\n    }, null));\n  }\n\n}","/**\n * Returns a new path starting from the predicate of the current path.\n *\n * Requires:\n * - (optional) a predicate property on the path data\n */\nexport default class PredicateHandler {\n  handle(pathData) {\n    const {\n      predicate\n    } = pathData;\n    return !predicate ? undefined : Promise.resolve(predicate).then(subject => pathData.extendPath({\n      subject\n    }, null));\n  }\n\n}","/**\n * Queries for all compacted predicates of a path subject\n */\nimport { JsonLdContextNormalized } from 'jsonld-context-parser';\nimport { toIterablePromise } from './promiseUtils';\nexport default class PropertiesHandler {\n  handle(pathData, path) {\n    return toIterablePromise(this._handle(pathData, path));\n  }\n\n  async *_handle(pathData, path) {\n    const contextRaw = (await pathData.settings.parsedContext) || {};\n    const context = new JsonLdContextNormalized(contextRaw);\n\n    for await (const predicate of path.predicates) yield context.compactIri(`${await predicate}`, true);\n  }\n\n}","/**\n * Queries for all predicates of a path subject\n */\nexport default class PredicatesHandler {\n  handle(pathData) {\n    return pathData.extendPath({\n      distinct: true,\n      select: '?predicate',\n      finalClause: queryVar => `${queryVar} ?predicate ?object.`,\n      property: pathData.property\n    });\n  }\n\n}","/**\n * Traverses a path to collect links and nodes into an expression.\n */\nexport default class PathExpressionHandler {\n  async handle(pathData) {\n    const segments = [];\n    let current = pathData; // Add all predicates to the path\n\n    while (current.parent) {\n      // Obtain and store predicate\n      if (current.predicate) {\n        segments.unshift({\n          predicate: await current.predicate,\n          reverse: await current.reverse,\n          sort: current.sort,\n          values: current.values\n        });\n      } // Move to parent link\n\n\n      current = current.parent;\n    } // Add the root subject to the path\n\n\n    if (!current.subject) throw new Error(`Expected root subject in ${current}`);\n    const subject = await current.subject;\n    segments.unshift({\n      subject\n    });\n    return segments;\n  }\n\n}","/**\n * Queries for all subjects of a document\n */\nexport default class SubjectsHandler {\n  handle(pathData) {\n    return pathData.extendPath({\n      distinct: true,\n      select: '?subject',\n      finalClause: () => '?subject ?predicate ?object.',\n      property: pathData.property\n    });\n  }\n\n}","/**\n * Executes the query represented by a path.\n *\n * Requires:\n * - a queryEngine property in the path settings\n * - a sparql property on the path proxy\n * - (optional) a resultsCache property on the path data\n */\nexport default class ExecuteQueryHandler {\n  async *handle(pathData, path) {\n    // Try to retrieve the result from cache\n    const resultsCache = await pathData.resultsCache;\n\n    if (resultsCache) {\n      for (const result of resultsCache) yield result;\n\n      return;\n    } // Retrieve the query engine and query\n\n\n    const {\n      queryEngine\n    } = pathData.settings;\n    if (!queryEngine) throw new Error(`${pathData} has no queryEngine setting`);\n    const query = await path.sparql;\n    if (query === null || query === undefined) throw new Error(`${pathData} has no sparql property`); // No results if the query is empty\n\n    if (query.length === 0) return; // Extract the term from every query result\n\n    for await (const bindings of queryEngine.execute(query)) yield this.extractTerm(bindings, pathData);\n  }\n  /**\n   * Extracts the first term from a query result binding as a new path.\n   */\n\n\n  extractTerm(binding, pathData) {\n    // Extract the first term from the binding map\n    if (binding.size !== 1) throw new Error('Only single-variable queries are supported');\n    const subject = binding.values().next().value; // Each result is a new path that starts from the term as subject\n\n    return pathData.extendPath({\n      subject\n    }, null);\n  }\n\n}","/**\n * Traverses a path to collect mutationExpressions into an expression.\n * This is needed because mutations can be chained.\n *\n * Requires:\n * - a mutationExpressions property on the path proxy\n */\nexport default class MutationExpressionsHandler {\n  async handle(pathData) {\n    const mutationExpressions = []; // Add all mutationExpressions to the path\n\n    let current = pathData;\n\n    while (current) {\n      // Obtain and store mutationExpressions\n      if (current.mutationExpressions) mutationExpressions.unshift(...(await current.mutationExpressions)); // Move to parent link\n\n      current = current.parent;\n    }\n\n    return mutationExpressions;\n  }\n\n}","import MutationFunctionHandler from './MutationFunctionHandler';\n/**\n * A MutationFunctionHandler for insertions.\n */\n\nexport default class InsertFunctionHandler extends MutationFunctionHandler {\n  constructor() {\n    super('INSERT', false);\n  }\n\n}","import MutationFunctionHandler from './MutationFunctionHandler';\nimport { hasPlainObjectArgs } from './valueUtils';\n/**\n * Returns a function that deletes all existing values\n * for the path, and then adds the given values to the path.\n *\n * Requires:\n * - a delete function on the path proxy.\n * - an add function on the path proxy.\n */\n\nexport default class SetFunctionHandler extends MutationFunctionHandler {\n  handle(pathData, path) {\n    return (...args) => {\n      // First, delete all existing values for the property/properties\n      const deletePath = !hasPlainObjectArgs(args) ? // When a single property is given, delete all of its values\n      path.delete() : // When a map of properties is given, delete all of their values\n      Object.keys(args[0]).reduce((previousPath, property) => previousPath.delete({\n        [property]: []\n      }), path); // Next, insert the new values\n\n      return deletePath.add(...args);\n    };\n  }\n\n}","/**\n * Returns a function that deletes the given value\n * for the path, and then adds the given values to the path.\n *\n * Requires:\n * - a delete function on the path proxy.\n * - an add function on the path proxy.\n */\nexport default class ReplaceFunctionHandler {\n  handle(pathData, path) {\n    return function (oldValue, ...newValues) {\n      if (!oldValue || !newValues.length) throw new Error('Replacing values requires at least two arguments, old value followed by all new values');\n      return path.delete(oldValue).add(...newValues);\n    };\n  }\n\n}","import { isAsyncIterable } from './valueUtils';\n/**\n * Converts an asynchronously iterable path into an array.\n *\n * Requires:\n * - (optional) an iterable path\n */\n\nexport default class ToArrayHandler {\n  handle(pathData, path) {\n    return async map => {\n      const items = [];\n\n      if (isAsyncIterable(path)) {\n        // Ensure the mapping function is valid\n        if (typeof map !== 'function') map = item => item; // Retrieve and map all elements\n\n        let index = 0;\n\n        for await (const item of path) items.push((await map(item, index++)));\n      }\n\n      return items;\n    };\n  }\n\n}","/**\n * Yields a function that interprets a string expression as an LDflex path.\n */\nexport default class StringToLDflexHandler {\n  handle(pathData, path) {\n    // Resolves the given string expression against the LDflex object\n    return (expression = '', ldflex = path) => {\n      // An expression starts with a property access in dot or bracket notation\n      const propertyPath = expression // Add brackets around a single URL\n      .replace(/^(https?:\\/\\/[^()[\\]'\"]+)$/, '[\"$1\"]') // Add the starting dot if omitted\n      .replace(/^(?=[a-z$_])/i, '.') // Add quotes inside of brackets if omitted\n      .replace(/\\[([^'\"`\\](]*)\\]/g, '[\"$1\"]'); // Create a function to evaluate the expression\n\n      const body = `\"use strict\";return ldflex${propertyPath}`;\n      let evaluator;\n\n      try {\n        /* eslint no-new-func: off */\n        evaluator = Function('ldflex', body);\n      } catch ({\n        message\n      }) {\n        throw new Error(`Expression \"${expression}\" is invalid: ${message}`);\n      } // Evaluate the function\n\n\n      return evaluator(ldflex);\n    };\n  }\n\n}","const EMPTY = Object.create(null);\n/**\n * A PathProxy creates path expressions,\n * to which functionality can be attached.\n *\n * To users, these paths act as regular JavaScript objects\n * (such as `path.foo.bar.prop`) thanks to Proxy.\n * Behind the scenes, they carry around internal data\n * that can be used to influence their functionality.\n *\n * A path's functionality is realized by:\n * - handlers, which handle a specific named property\n * - resolvers, which can handle arbitrary properties\n * Only handlers and resolvers see the internal data.\n *\n * A path can have arbitrary internal data fields, but these are reserved:\n * - settings, an object that is passed on as-is to child paths\n * - proxy, a reference to the proxied object the user sees\n * - parent, a reference to the parent path\n * - apply, a function the will be invoked when the path is called as a function\n * - extendPath, a method to create a child path with this path as parent\n */\n\nexport default class PathProxy {\n  constructor({\n    handlers = EMPTY,\n    resolvers = []\n  } = {}) {\n    this._handlers = handlers;\n    this._resolvers = resolvers;\n  }\n  /**\n   * Creates a path Proxy with the given settings and internal data fields.\n   */\n\n\n  createPath(settings = {}, data) {\n    // The settings parameter is optional\n    if (data === undefined) [data, settings] = [settings, {}]; // Create the path's internal data object and the proxy that wraps it\n\n    const {\n      apply,\n      ...rawData\n    } = data;\n    const path = apply ? Object.assign(callPathFunction, rawData) : rawData;\n    const proxy = new Proxy(path, this);\n    path.proxy = proxy;\n    path.settings = settings;\n\n    function callPathFunction(...args) {\n      return apply(args, path, proxy);\n    } // Add an extendPath method to create child paths\n\n\n    if (!path.extendPath) {\n      const pathProxy = this;\n\n      path.extendPath = function extendPath(newData, parent = this) {\n        return pathProxy.createPath(settings, {\n          parent,\n          extendPath,\n          ...newData\n        });\n      };\n    } // Return the proxied path\n\n\n    return proxy;\n  }\n  /**\n   * Handles access to a property\n   */\n\n\n  get(pathData, property) {\n    // Handlers provide functionality for a specific property,\n    // so check if we find a handler first\n    const handler = this._handlers[property];\n    if (handler && typeof handler.handle === 'function') return handler.handle(pathData, pathData.proxy); // Resolvers provide functionality for arbitrary properties,\n    // so find a resolver that can handle this property\n\n    for (const resolver of this._resolvers) {\n      if (resolver.supports(property)) return resolver.resolve(property, pathData, pathData.proxy);\n    } // Otherwise, the property does not exist\n\n\n    return undefined;\n  }\n\n}","import { ContextParser, Util as ContextUtil } from 'jsonld-context-parser';\nimport { namedNode } from '@rdfjs/data-model';\nimport { lazyThenable } from './promiseUtils';\nimport { valueToTerm } from './valueUtils';\n/**\n * Resolves property names of a path\n * to their corresponding IRIs through a JSON-LD context.\n */\n\nexport default class JSONLDResolver {\n  /**\n   * Creates a new resolver for the given context(s).\n   */\n  constructor(...contexts) {\n    this._context = Promise.resolve({});\n    this.extendContext(...contexts);\n  }\n  /**\n   * The JSON-LD resolver supports all string properties.\n   */\n\n\n  supports(property) {\n    return typeof property === 'string';\n  }\n  /**\n   * When resolving a JSON-LD property,\n   * we create a new chainable path segment corresponding to the predicate.\n   *\n   * Example usage: person.friends.firstName\n   */\n\n\n  resolve(property, pathData) {\n    const predicate = lazyThenable(() => this.expandProperty(property));\n    const reverse = lazyThenable(() => this._context.then(({\n      contextRaw\n    }) => contextRaw[property] && contextRaw[property]['@reverse']));\n    const resultsCache = this.getResultsCache(pathData, predicate, reverse);\n    const newData = {\n      property,\n      predicate,\n      resultsCache,\n      reverse,\n      apply: this.apply\n    };\n    return pathData.extendPath(newData);\n  }\n  /**\n   * When the property is called as a function,\n   * it adds property-object constraints to the path.\n   *\n   * Example usage: person.friends.location(place).firstName\n   */\n\n\n  apply(args, pathData, path) {\n    if (args.length === 0) {\n      const {\n        property\n      } = pathData;\n      throw new Error(`Specify at least one term when calling .${property}() on a path`);\n    } // With the property constraint added, continue from the previous path\n\n\n    pathData.values = args.map(valueToTerm);\n    return path;\n  }\n  /**\n   * Expands a JSON property key into a full IRI.\n   */\n\n\n  async expandProperty(property) {\n    // JavaScript requires keys containing colons to be quoted,\n    // so prefixed names would need to written as path['foaf:knows'].\n    // We thus allow writing path.foaf_knows or path.foaf$knows instead.\n    property = property.replace(/^([a-z][a-z0-9]*)[_$]/i, '$1:'); // Expand the property to a full IRI\n\n    const context = await this._context;\n    const expandedProperty = context.expandTerm(property, true);\n    if (!ContextUtil.isValidIri(expandedProperty)) throw new Error(`The JSON-LD context cannot expand the '${property}' property`);\n    return namedNode(expandedProperty);\n  }\n  /**\n   * Extends the current JSON-LD context with the given context(s).\n   */\n\n\n  async extendContext(...contexts) {\n    await (this._context = this._context.then(({\n      contextRaw\n    }) => new ContextParser().parse([contextRaw, ...contexts])));\n  }\n  /**\n   * Gets the results cache for the given predicate.\n   */\n\n\n  getResultsCache(pathData, predicate, reverse) {\n    let {\n      propertyCache\n    } = pathData;\n    return propertyCache && lazyThenable(async () => {\n      // Preloading does not work with reversed predicates\n      propertyCache = !(await reverse) && (await propertyCache);\n      return propertyCache && propertyCache[(await predicate).value];\n    });\n  }\n\n}","import PathProxy from './PathProxy';\nimport JSONLDResolver from './JSONLDResolver';\nimport defaultHandlers from './defaultHandlers';\nimport { ContextParser } from 'jsonld-context-parser';\n/**\n * A PathFactory creates paths with default settings.\n */\n\nexport default class PathFactory {\n  constructor(settings, data) {\n    // Store settings and data\n    this._settings = settings = { ...settings\n    };\n    this._data = data = { ...data\n    }; // Prepare the handlers\n\n    const handlers = settings.handlers || defaultHandlers;\n\n    for (const key in handlers) handlers[key] = toHandler(handlers[key]);\n\n    for (const key of Object.getOwnPropertySymbols(handlers)) handlers[key] = toHandler(handlers[key]); // Prepare the resolvers\n\n\n    const resolvers = (settings.resolvers || []).map(toResolver);\n\n    if (settings.context) {\n      resolvers.push(new JSONLDResolver(settings.context));\n      settings.parsedContext = new ContextParser().parse(settings.context).then(({\n        contextRaw\n      }) => contextRaw);\n    } else {\n      settings.context = settings.parsedContext = {};\n    } // Instantiate PathProxy that will create the paths\n\n\n    this._pathProxy = new PathProxy({\n      handlers,\n      resolvers\n    }); // Remove PathProxy settings from the settings object\n\n    delete settings.handlers;\n    delete settings.resolvers;\n  }\n  /**\n   * Creates a path with the given (optional) settings and data.\n   */\n\n\n  create(settings = {}, data) {\n    // The settings parameter is optional\n    if (!data) [data, settings] = [settings, null]; // Apply defaults on settings and data\n\n    return this._pathProxy.createPath(Object.assign(Object.create(null), this._settings, settings), Object.assign(Object.create(null), this._data, data));\n  }\n\n}\nPathFactory.defaultHandlers = defaultHandlers;\n/**\n * Converts a handler function into a handler object.\n */\n\nexport function toHandler(handle) {\n  return typeof handle.handle === 'function' ? handle : {\n    handle\n  };\n}\n/**\n * Converts a resolver function into a catch-all resolver object.\n */\n\nexport function toResolver(resolve) {\n  return typeof resolve.resolve === 'function' ? resolve : {\n    supports,\n    resolve\n  };\n} // Catch-all resolvers support everything\n\nfunction supports() {\n  return true;\n}","import { toIterablePromise } from 'ldflex';\nimport { namedNode } from '@rdfjs/data-model';\nimport context from '@solid/context';\n\nconst { as } = context['@context'];\n\n/**\n * Base class for handlers that manipulate activities\n * Requires:\n * - the `root.user` handler\n * - the `root[...]` resolver\n * - a queryEngine property in the path settings\n */\nexport default class ActivityHandler {\n  requireUser = true;\n\n  constructor({ activitiesPath = '/public/activities' } = {}) {\n    this.activitiesPath = activitiesPath;\n  }\n\n  handle(pathData, path) {\n    const self = this;\n    const { root } = path;\n    const { settings: { queryEngine } } = pathData;\n\n    // Return an iterator over the activity paths\n    return (type = `${as}Like`) => toIterablePromise(async function* () {\n      // Only process activities if a user is logged in\n      let user;\n      try {\n        user = await root.user;\n      }\n      catch (error) {\n        if (self.requireUser)\n          throw error;\n        return;\n      }\n\n      // Determine the storage location\n      const storage = await root.user.pim$storage;\n      const document = new URL(self.activitiesPath, storage || user).href;\n\n      // Obtain results for every activity on the path\n      const results = [];\n      const actor = namedNode(user);\n      type = namedNode(type);\n      for await (const object of path) {\n        if (object.termType === 'NamedNode') {\n          const activity = { actor, type, object };\n          for await (const result of self.createResults(activity, document, queryEngine))\n            results.push(result);\n        }\n      }\n\n      // Process all results and return paths starting from the returned terms\n      for (const term of await self.processResults(results, document, queryEngine))\n        yield root[term.value];\n    });\n  }\n\n  async processResults(results) {\n    return results;\n  }\n}\n","import { SparqlHandler } from 'ldflex';\n\nexport const { termToString } = SparqlHandler.prototype;\n\nexport function replaceVariables(template, terms) {\n  for (const name in terms)\n    template = template.replace(new RegExp(`_:${name}`, 'g'), termToString(terms[name]));\n  return template;\n}\n\n// Transforms the arguments into an Immutable.js-style list\nexport function asList(...items) {\n  return {\n    size: items.length,\n    values: () => ({\n      next: () => ({ value: items.shift() }),\n    }),\n  };\n}\n","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n// find the complete implementation of crypto (msCrypto) on IE11.\nvar getRandomValues = typeof crypto != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto != 'undefined' && typeof msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto);\nvar rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\nexport default function rng() {\n  if (!getRandomValues) {\n    throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n  }\n\n  return getRandomValues(rnds8);\n}","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex; // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n\n  return [bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]]].join('');\n}\n\nexport default bytesToUuid;","import rng from './rng.js';\nimport bytesToUuid from './bytesToUuid.js';\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof options == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nexport default v4;","import ActivityHandler from './ActivityHandler';\nimport activityTemplate from './activity.ttl';\nimport { replaceVariables } from '../util';\nimport { namedNode, literal } from '@rdfjs/data-model';\nimport { v4 as uuidv4 } from 'uuid';\nimport context from '@solid/context';\n\nconst { xsd } = context['@context'];\n\n/**\n * Handler that creates an activity in the user's data pod\n * Requires:\n * - the `root.user` handler\n * - the `root[...]` resolver\n * - a queryEngine property in the path settings\n */\nexport default class CreateActivityHandler extends ActivityHandler {\n  // Creates an activity for insertion in the given document\n  async* createResults(activity, document) {\n    const id = namedNode(new URL(`#${uuidv4()}`, document).href);\n    const published = literal(new Date().toISOString(), `${xsd}dateTime`);\n    activity = { id, published, ...activity };\n\n    const insert = replaceVariables(activityTemplate, activity);\n    yield { id, insert };\n  }\n\n  // Inserts the activities into the document\n  async processResults(results, document, queryEngine) {\n    const sparql = `INSERT {\\n${results.map(r => r.insert).join('')}}`;\n    await queryEngine.executeUpdate(sparql, document).next();\n    return results.map(r => r.id);\n  }\n}\n","import ActivityHandler from './ActivityHandler';\nimport queryTemplate from './activity-triples.sparql';\nimport { replaceVariables, termToString } from '../util';\n\nconst components = ['?subject', '?predicate', '?object'];\n\n/**\n * Handler that deletes an activity in the user's data pod\n * Requires:\n * - the `root.user` handler\n * - the `root[...]` resolver\n * - a queryEngine property in the path settings\n */\nexport default class DeleteActivityHandler extends ActivityHandler {\n  // Finds activity triples for deletion\n  async* createResults(activity, document, queryEngine) {\n    const query = replaceVariables(queryTemplate, activity);\n    for await (const triple of queryEngine.execute(query, document)) {\n      const terms = components.map(c => termToString(triple.get(c)));\n      yield `${terms.join(' ')}.\\n`;\n    }\n  }\n\n  // Deletes the activity triples from the document\n  async processResults(results, document, queryEngine) {\n    const sparql = `DELETE {\\n${results.join('')}}`;\n    await queryEngine.executeUpdate(sparql, document).next();\n    return [];\n  }\n}\n","import { namedNode } from '@rdfjs/data-model';\n\n/**\n * LDflex property resolver that returns a new path\n * starting from the property name as a subject.\n *\n * For example, when triggered as\n *     data['http://person.example/#me'].friends.firstName\n * it will create a path with `http://person.example/#me` as subject\n * and then resolve `friends` and `firstName` against the JSON-LD context.\n *\n * In case a source object is given as input, data will be pulled from there.\n */\nexport default class SubjectPathResolver {\n  constructor(pathFactory, source) {\n    this._paths = pathFactory;\n    this._source = source;\n  }\n\n  /** Resolve all string properties (not Symbols) */\n  supports(property) {\n    return typeof property === 'string';\n  }\n\n  resolve(property, { settings }) {\n    return this._createSubjectPath(namedNode(property), settings);\n  }\n\n  _createSubjectPath(subject, { createQueryEngine }) {\n    const source = this._source || Promise.resolve(subject).catch(() => null);\n    const queryEngine = createQueryEngine(source);\n    return this._paths.create({ queryEngine }, { subject });\n  }\n}\n","import { PathFactory, defaultHandlers } from 'ldflex';\nimport SubjectPathResolver from '../resolvers/SubjectPathResolver';\n\nexport default class SourcePathHandler {\n  constructor(pathFactory) {\n    this._paths = pathFactory;\n  }\n\n  handle({ settings }) {\n    return source => new PathFactory({\n      handlers: { ...defaultHandlers },\n      resolvers: [new SubjectPathResolver(this._paths, source)],\n    }).create(settings, {});\n  }\n}\n","import SubjectPathResolver from '../resolvers/SubjectPathResolver';\nimport auth from 'solid-auth-client';\nimport { namedNode } from '@rdfjs/data-model';\n\n/**\n * Creates a path with the current user as a subject.\n */\nexport default class UserPathHandler extends SubjectPathResolver {\n  handle({ settings }) {\n    const subject = this.getWebId().then(namedNode);\n    return this._createSubjectPath(subject, settings);\n  }\n\n  /** Gets the WebID of the logged in user */\n  async getWebId() {\n    const session = await auth.currentSession();\n    if (!session)\n      throw new Error('Cannot resolve user path: no user logged in');\n    return session.webId;\n  }\n}\n","import { PathFactory, defaultHandlers } from 'ldflex';\nimport context from '@solid/context';\nimport PutHandler from './handlers/PutHandler';\nimport SolidDeleteFunctionHandler from './handlers/SolidDeleteFunctionHandler';\nimport FindActivityHandler from './handlers/FindActivityHandler';\nimport CreateActivityHandler from './handlers/CreateActivityHandler';\nimport DeleteActivityHandler from './handlers/DeleteActivityHandler';\nimport SourcePathHandler from './handlers/SourcePathHandler';\nimport UserPathHandler from './handlers/UserPathHandler';\nimport ContextResolver from './resolvers/ContextResolver';\nimport SubjectPathResolver from './resolvers/SubjectPathResolver';\n\nconst { as } = context['@context'];\nconst contextResolver = new ContextResolver(context);\n\n// Handlers for subject paths\nconst subjectHandlers = {\n  ...defaultHandlers,\n\n  // HTTP PUT handler\n  put: new PutHandler(),\n\n  // Custom delete handler to match node-solid-server behavior\n  delete: new SolidDeleteFunctionHandler(),\n\n  // Find activities\n  findActivity: new FindActivityHandler(),\n  likes: (_, path) => path.findActivity(`${as}Like`),\n  dislikes: (_, path) => path.findActivity(`${as}Dislike`),\n  follows: (_, path) => path.findActivity(`${as}Follow`),\n\n  // Create activities\n  createActivity: new CreateActivityHandler(),\n  like: (_, path) => () => path.createActivity(`${as}Like`),\n  dislike: (_, path) => () => path.createActivity(`${as}Dislike`),\n  follow: (_, path) => () => path.createActivity(`${as}Follow`),\n\n  // Delete activities\n  deleteActivity: new DeleteActivityHandler(),\n  unlike: (_, path) => () => path.deleteActivity(`${as}Like`),\n  undislike: (_, path) => () => path.deleteActivity(`${as}Dislike`),\n  unfollow: (_, path) => () => path.deleteActivity(`${as}Follow`),\n};\n\n// Creates an LDflex for Solid root path with the given settings\nexport default function createRootPath(defaultSettings) {\n  let rootPath = null;\n\n  // Factory for data paths that start from a given subject\n  const subjectPathFactory = new PathFactory({\n    handlers: { ...subjectHandlers, root: () => rootPath },\n    resolvers: [contextResolver],\n  });\n\n  // Root path that resolves the first property access\n  rootPath = new PathFactory({\n    // Handlers of specific named properties\n    handlers: {\n      ...defaultHandlers,\n\n      // The `from` function takes a source as input\n      from: new SourcePathHandler(subjectPathFactory),\n      // The `user` property starts a path with the current user as subject\n      user: new UserPathHandler(subjectPathFactory),\n\n      // Clears the cache for the given document (or everything, if undefined)\n      clearCache: ({ settings }) => doc =>\n        settings.createQueryEngine().clearCache(doc),\n\n      // Expose the JSON-LD context\n      context: contextResolver,\n    },\n    // Resolvers for all remaining properties\n    resolvers: [\n      // `data[url]` starts a path with the property as subject\n      new SubjectPathResolver(subjectPathFactory),\n    ],\n    ...defaultSettings,\n  }).create();\n  return rootPath;\n}\n","import { JSONLDResolver } from 'ldflex';\n\n/**\n * A ContextResolver is a combined resolver/handler that:\n * - resolves a JSON-LD context\n * - handles by returning an object that\n *   - is the initial context passed to the constructor\n *   - allows extending that context by calling `.extend`\n *   - when `await`ed, resolves to the expanded context\n */\nexport default class ContextResolver extends JSONLDResolver {\n  constructor(context) {\n    super(context);\n\n    // Create an exposed version of the initial context, with additional functionality\n    const exposedContext = this._exposedContext = Object.create(context['@context']);\n    // Allow extending the context\n    Object.defineProperty(exposedContext, 'extend', {\n      value: (...contexts) => this.extendContext(...contexts),\n    });\n    // Resolve to the expanded context\n    Object.defineProperty(exposedContext, 'then', {\n      value: (resolve, reject) => this._context\n        .then(ctx => ctx.contextRaw).then(resolve, reject),\n    });\n  }\n\n  handle() {\n    return this._exposedContext;\n  }\n}\n","import { toIterablePromise } from 'ldflex';\nimport auth from 'solid-auth-client';\n\n/**\n * Creates a document for every result with the given contents.\n * Requires:\n * - the `root[...]` resolver\n */\nexport default class PutHandler {\n  handle(pathData, path) {\n    const { root } = path;\n\n    // Return an iterator over the created documents\n    return (body = '', contentType = 'text/turtle') =>\n      toIterablePromise(async function* () {\n        // Collect all unique URLs from the path\n        const urls = new Set();\n        for await (const result of path) {\n          const match = /^https?:\\/\\/[^#]+/.exec(result ? result.value : '');\n          if (match)\n            urls.add(match[0]);\n        }\n\n        // Create and execute HTTP requests for every URL\n        const requests = [...urls].map(url => auth.fetch(url, {\n          method: 'PUT',\n          headers: { 'Content-Type': contentType },\n          body,\n        }));\n        await Promise.all(requests);\n\n        // Return paths to the created documents\n        for (const url of urls)\n          yield root[url];\n      });\n  }\n}\n","import { DeleteFunctionHandler } from 'ldflex';\n\n/**\n * node-solid-server deviates from the SPARQL UPDATE spec:\n * whereas the spec asks for DELETE on non-existing triples to silently succeed,\n * node-solid-server will only DELETE if exactly one triple matches.\n *\n * This delete handler works around that limitation\n * by first requesting all existing values for a path,\n * and then only issuing DELETE statements for those that exist.\n */\nexport default class SolidDeleteFunctionHandler extends DeleteFunctionHandler {\n  async extractObjects(pathData, path, args) {\n    // Obtain all values whose deletion was requested\n    const objects = await super.extractObjects(pathData, path, args);\n\n    // Obtain all values that currently exist\n    const existing = [];\n    for await (const term of path) {\n      if (term.termType !== 'BlankNode')\n        existing.push(term);\n    }\n\n    // Perform deletions only for values that exist\n    return !objects ? existing : existing.filter(e => objects.some(o => o.equals(e)));\n  }\n}\n","import ActivityHandler from './ActivityHandler';\nimport queryTemplate from './activity.sparql';\nimport { replaceVariables } from '../util';\n\n/**\n * Handler that finds an activity in the user's data pod\n * Requires:\n * - the `root.user` handler\n * - the `root[...]` resolver\n * - a queryEngine property in the path settings\n */\nexport default class FindActivityHandler extends ActivityHandler {\n  requireUser = false;\n\n  // Finds all activities in the document matching the given pattern\n  async* createResults(activity, document, queryEngine) {\n    const query = replaceVariables(queryTemplate, activity);\n    for await (const binding of queryEngine.execute(query, document))\n      yield binding.values().next().value;\n  }\n}\n","import auth from 'solid-auth-client';\nimport { asList } from './util';\n\n/**\n * A wrapper around a query engine\n * that uses Solid authenticated requests for updates.\n */\nexport default class SolidUpdateEngine {\n  /**\n   * Creates a wrapper around the given query engine.\n   */\n  constructor(sources, baseEngine) {\n    // Preload source but silence errors; they will be thrown during execution\n    this._source = this.getUpdateSource(sources);\n    this._source.catch(() => null);\n    this._engine = baseEngine;\n  }\n\n  /**\n   * Creates an asynchronous iterable of results for the given SPARQL query.\n   */\n  async* execute(sparql, sources) {\n    yield* /^\\s*(?:INSERT|DELETE)/i.test(sparql) ?\n      this.executeUpdate(sparql, sources) :\n      this._engine.execute(sparql, sources);\n  }\n\n  /**\n   * Creates an asynchronous iterable with the results of the SPARQL UPDATE query.\n   */\n  executeUpdate(sparql, sources) {\n    let done = false;\n    const next = async () => {\n      if (done)\n        return { done };\n      done = true;\n\n      // Send authenticated PATCH request to the document\n      const source = await (sources ? this.getUpdateSource(sources) : this._source);\n      const { ok, status, statusText } = await auth.fetch(source, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/sparql-update',\n        },\n        body: sparql,\n      });\n      if (!ok)\n        throw new Error(`Update query failed (${status}): ${statusText}`);\n\n      // Clear stale cached versions of the document\n      await this.clearCache(source);\n\n      // Return success\n      return { value: asList({ ok }) };\n    };\n    return {\n      next,\n      return: noop, throw: noop, // required by the interface\n      [Symbol.asyncIterator]() { return this; },\n    };\n  }\n\n  /**\n   * Parses the source(s) into the source to update.\n   */\n  async getUpdateSource(sources) {\n    let source = await sources;\n\n    // Transform URLs or terms into strings\n    if (source instanceof URL)\n      source = source.href;\n    else if (source && typeof source.value === 'string')\n      source = source.value;\n\n    // Parse a string URL source\n    if (typeof source === 'string') {\n      if (!/^https?:\\/\\//.test(source))\n        throw new Error('Can only update an HTTP(S) document.');\n      return source.replace(/#.*/, '');\n    }\n\n    // Flatten recursive calls to this function\n    if (Array.isArray(source)) {\n      source = await Promise.all(source.map(s => this.getUpdateSource(s)));\n      source = [].concat(...source).filter(s => !!s);\n      if (source.length !== 1)\n        throw new Error('Can only update a single source.');\n      return source[0];\n    }\n\n    // Error on unsupported sources\n    throw new Error(`Unsupported source: ${source}`);\n  }\n\n  /**\n   * Removes the given document (or all, if not specified) from the cache,\n   * such that fresh results are obtained next time.\n   */\n  clearCache(document) {\n    return this._engine.clearCache(document);\n  }\n}\n\nfunction noop() { /* empty */ }\n","import RdflibQueryEngine from './RdflibQueryEngine';\nexport default RdflibQueryEngine;\n","import {\n  graph,\n  Fetcher,\n  SPARQLToQuery as sparqlToQuery,\n} from 'rdflib';\n\n/**\n * Asynchronous iterator wrapper for the rdflib.js SPARQL query engine.\n */\nexport default class RdflibQueryEngine {\n  /**\n   * Creates a query engine with the given sources as default.\n   */\n  constructor(defaultSources) {\n    // Preload sources but silence errors; they will be thrown during execution\n    this._defaultStore = this.readSources(defaultSources);\n    this._defaultStore.catch(() => null);\n  }\n\n  /**\n   * Creates an asynchronous iterable of results for the given SPARQL query.\n   */\n  async* execute(sparql, sources) {\n    if ((/^\\s*(?:INSERT|DELETE)/i).test(sparql))\n      yield* this.executeUpdate(sparql, sources);\n\n    // Parse the SPARQL query\n    const query = sparqlToQuery(sparql, true, graph());\n    // Load the sources if passed, the default sources otherwise\n    const store = await (sources ? this.readSources(sources) : this._defaultStore);\n    // Disable link traversal for now (slow, and unreliable error handling)\n    store.fetcher = null;\n\n    // Execute the query and store the results in an array\n    const results = [];\n    await new Promise((resolve, reject) => {\n      store.query(query, result => results.push(result), null,\n        error => error ? reject(error) : resolve(results));\n    });\n\n    // Convert every result to a map\n    const vars = new Set(query.vars.map(v => `?${v.value}`));\n    for (const result of results) {\n      // Only return explicitly requested variables\n      // (workaround for https://github.com/linkeddata/rdflib.js/issues/393)\n      const bindings = Object.entries(result).filter(([v]) => vars.has(v));\n      yield new Map(bindings);\n    }\n  }\n\n  /**\n   * Creates an asynchronous iterable with the results of the SPARQL UPDATE query.\n   */\n  async* executeUpdate(sparql, sources) {\n    throw new Error(`SPARQL UPDATE queries are unsupported, received: ${sparql}`);\n  }\n\n  /**\n   * Reads the specified stores into a store.\n   */\n  async readSources(sourceList, store = graph()) {\n    let source = await sourceList;\n    if (source) {\n      // Transform URLs or terms into strings\n      if (source instanceof URL)\n        source = source.href;\n      else if (source.termType === 'NamedNode')\n        source = source.value;\n\n      // Read a document from a URL\n      if (typeof source === 'string') {\n        const document = source.replace(/#.*/, '');\n        const fetcher = new Fetcher(store);\n        await fetcher.load(document);\n      }\n      // Read an array of sources\n      else if (Array.isArray(source)) {\n        await Promise.all(source.map(s => this.readSources(s, store)));\n      }\n      // Read an RDF/JS source\n      else if (typeof source.match === 'function') {\n        const results = source.match(null, null, null, null);\n        await new Promise((resolve, reject) => {\n          results.on('data', addQuad);\n          results.on('end', finish);\n          results.on('error', finish);\n          // Adds a quad to the store\n          function addQuad(quad) {\n            try {\n              store.add(quad.subject, quad.predicate, quad.object, quad.graph);\n            }\n            catch (error) {\n              finish(error);\n            }\n          }\n          // Finishes reading the source\n          function finish(error) {\n            results.removeListener('data', addQuad);\n            results.removeListener('end', finish);\n            results.removeListener('error', finish);\n            return error ? reject(error) : resolve(null);\n          }\n        });\n      }\n      // Error on unsupported sources\n      else {\n        throw new Error(`Unsupported source: ${source}`);\n      }\n    }\n    return store;\n  }\n\n  /**\n   * Removes the given document (or all, if not specified) from the cache,\n   * such that fresh results are obtained next time.\n   */\n  async clearCache(document) {\n    // No action required, since we need a new fetcher for every store\n  }\n}\n","import RootPath from '../RootPath';\nimport SolidUpdateEngine from '../SolidUpdateEngine';\nimport RdflibQueryEngine from '@ldflex/rdflib';\n\n// Export the root path with rdflib.js as query engine\nexport default new RootPath({\n  createQueryEngine: sources =>\n    new SolidUpdateEngine(sources, new RdflibQueryEngine(sources)),\n});\n"],"sourceRoot":""}